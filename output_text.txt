

--- Page 1 ---

INTERNATIONAL SERIES IN PURE
AND APPLIED MATHEMATICS

William Ted Martin, E. H. Spanier, G. Springer and
P. J. Davis. Consulting Editors

AHLForRS: Complex Analysis

Buck: Advanced Calculus

BUSACKER AND SAATY: Finite Graphs and Networks

CHENEY: Introduction to Approximation Theory

CHESTER: Techniques in Partial Differential Equations

CODDINGTON AND LEVINSON: Theory of Ordinary Differential Equations

CONTE AND DE Boor: Elementary Numerical Analysis: An Algorithmic Approach

DENNEMEYER: Introduction to Partial Differential Equations and Boundary Value
Problems

DETTMAN: Mathematical Methods in Physics and Engineering

GOLOMB AND SHANKS: Elements of Ordinary Differential Equations

GREENSPAN: Introduction to Partial Differential Equations

HAMMING: Numerical Methods for Scientists and Engineers

HILDEBRAND: Introduction to Numerical Analysis

HOUSEHOLDER: The Numerical Treatment of a Single Nonlinear Equation

KALMAN, FALB, AND ARBIB: Topics in Mathematical Systems Theory

Lass: Vector and Tensor Analysis

McCarty: Topology: An Introduction with Applications to Topological Groups

Monk: Introduction to Set Theory

Moore: Elements of Linear Algebra and Matrix Theory

Mostow AND SAMPSON: Linear Algebra

MOouRSUND AND Duris: Elementary Theory and Application of Numerical Analysis

PEARL: Matrix Theory and Finite Mathematics

PIPES AND HaRVILL: Applied Mathematics for Engineers and Physicists

RALston: A First Course in Numerical Analysis

RITGER AND Ross: Differential Equations with Applications

Rutt: Fourier Series

Rubin: Principles of Mathematical Analysis

SHAPIRO: Introduction to Abstract Algebra

Simmons: Differential Equations with Applications and Historical Notes

Simmons: Introduction to Topology and Modern Analysis

SNEDDON: Elements of Partial Differential Equations

StRUBLE: Nonlinear Differential Equations


--- Page 2 ---

McGraw-Hill, Inc.

New York St. Louis San Francisco Auckland Bogota
Caracas Lisbon London Madrid Mexico City Milan
Montreal New Delhi San Juan Singapore

Sydney Tokyo Toronto

WALTER RUDIN

Professor of Mathematics
University of Wisconsin— Madison

Principles of
Mathematical
Analysis

THIRD EDITION


--- Page 3 ---

This book was set in Times New Roman.

The editors were A. Anthony Arthur and Shelly Levine Langman;
the production supervisor was Leroy A, Young.

R. R. Donnelley & Sons Company was printer and binder.

This book is printed on acid-free paper.

Library of Congress Cataloging in Publication Data

Rudin, Walter, date
Principles of mathematical analysis.

(International series in pure and applied mathematics)
Bibliography: p.

Includes index.
1. Mathematical analysis. I. Title.
QA300.R8 1976 515 75-17903

ISBN 0-07-054235-X

PRINCIPLES OF MATHEMATICAL ANALYSIS

Copyright © 1964, 1976 by McGraw-Hill, Inc. All rights reserved.
Copyright 1953 by McGraw-Hill, Inc. All rights reserved.

Printed in the United States of America. No part of this publication

may be reproduced, stored in a retrieval system, or transmitted, in any
form or by any means, electronic, mechanical, photocopying, recording, or
otherwise, without the prior written permission of the publisher.

28 29 30 DOC/D0C 09876543210


--- Page 4 ---

Chapter 1

Chapter 2

Preface

The Real and Complex Number Systems

Introduction

Ordered Sets

Fields

The Real Field

The Extended Real Number System
The Complex Field

Euclidean Spaces

Appendix

Exercises

Basic Topology

Finite, Countable, and Uncountable Sets
Metric Spaces

Compact Sets

Perfect Sets

CONTENTS


--- Page 5 ---

vi CONTENTS

Chapter 3

Chapter 4

Chapter 5

Connected Sets
Exercises

Numerical Sequences and Series

Convergent Sequences
Subsequences

Cauchy Sequences

Upper and Lower Limits
Some Special Sequences
Series

Series of Nonnegative Terms
The Number e

The Root and Ratio Tests
Power Series

Summation by Parts
Absolute Convergence
Addition and Multiplication of Series
Rearrangements

Exercises

Continuity

Limits of Functions

Continuous Functions

Continuity and Compactness
Continuity and Connectedness
Discontinuities

Monotonic Functions

Infinite Limits and Limits at Infinity
Exercises

Differentiation

The Derivative of a Real Function
Mean Value Theorems

The Continuity of Derivatives
L’Hospital’s Rule

Derivatives of Higher Order
Taylor’s Theorem

Differentiation of Vector-valued Functions

Exercises

103

103
107
108
109
110
110
111
114


--- Page 6 ---

Chapter 6

Chapter 7

Chapter 8

Chapter 9

Chapter 10

The Riemann-Stieltjes Integral

Definition and Existence of the Integral
Properties of the Integral

Integration and Differentiation
Integration of Vector-valued Functions
Rectifiable Curves

Exercises

Sequences and Series of Functions.

Discussion of Main Problem

Uniform Convergence

Uniform Convergence and Continuity
Uniform Convergence and Integration
Uniform Convergence and Differentiation
Equicontinuous Families of Functions
The Stone-Weierstrass Theorem

Exercises

Some Special Functions

Power Series

The Exponential and Logarithmic Functions

The Trigonometric Functions

The Algebraic Completeness of the Complex Field
Fourier Series

The Gamma Function

Exercises

Functions of Several Variables

Linear Transformations
Differentiation

The Contraction Principle

The Inverse Function Theorem
The Implicit Function Theorem
The Rank Theorem
Determinants

Derivatives of Higher Order
Differentiation of Integrals
Exercises

Integration of Differential Forms

Integration

CONTENTS vii

120

120
128
133
135
136
138

143

143
147
149
151
152
154
159
165

172

172
178
182
184
185
192
196

204

204
211
220
221
223
228
231
235
236
239

245
245


--- Page 7 ---

viii CONTENTS

Primitive Mappings 248
Partitions of Unity 251
Change of Variables 252
Differential Forms 253
Simplexes and Chains 266
Stokes’ Theorem 273
Closed Forms and Exact Forms 275
Vector Analysis 280
Exercises 288
Chapter 11 The Lebesgue Theory 300
Set Functions 300
Construction of the Lebesgue Measure 302
Measure Spaces 310
Measurable Functions 310
Simple Functions 313
Integration 314
Comparison with the Riemann Integral 322
Integration of Complex Functions 325
Functions of Class £? 325
Exercises 332
Bibliography 335
List of Special Symbols 337

Index 339


--- Page 8 ---

PREFACE

This book is intended to serve as a text for the course in analysis that is usually
taken by advanced undergraduates or by first-year students who study mathe-
matics.

The present edition covers essentially the same topics as the second one,
with some additions, a few minor omissions, and considerable rearrangement. I
hope that these changes will make the material more accessible amd more attrac-
tive to the students who take such a course.

Experience has convinced me that it is pedagogically unsound (though
logically correct) to start off with the construction of the real numbers from the
rational ones. At the beginning, most students simply fail to appreciate the need
for doing this. Accordingly, the real number system is introduced as an ordered
field with the least-upper-bound property, and a few interesting applications of
this property are quickly made. However, Dedekind’s construction is not omit-
ted. It is now in an Appendix to Chapter 1, where it may be studied and enjoyed
whenever the time seems ripe.

The material on functions of several variables is almost completely re-
written, with many details filled in, and with more examples and more motiva-
tion. The proof of the inverse function theorem—the key item in Chapter 9—is


--- Page 9 ---

X PREFACE

simplified by means of the fixed point theorem about contraction mappings.
Differential forms are discussed in much greater detail. Several applications of
Stokes’ theorem are included.

As regards other changes, the chapter on the Riemann-Stieltjes integral
has been trimmed a bit, a short do-it-yourself section on the gamma function
has been added to Chapter 8, and there is a large number of new exercises, most
of them with fairly detailed hints.

I have also included several references to articles appearing in the American
Mathematical Monthly and in Mathematics Magazine, in the hope that students
will develop the habit of looking into the journal literature. Most of these
references were kindly supplied by R. B. Burckel.

Over the years, many people, students as well as teachers, have sent me
corrections, criticisms, and other comments concerning the previous editions
of this book. I have appreciated these, and I take this opportunity to express
my sincere thanks to all who have written me.

WALTER RUDIN


--- Page 10 ---

|

THE REAL AND COMPLEX NUMBER SYSTEMS

INTRODUCTION

A satisfactory discussion of the main concepts of analysis (such as convergence,
continuity, differentiation, and integration) must be based on an accurately
defined number concept. We shall not, however, enter into any discussion of
the axioms that govern the arithmetic of the integers, but assume familiarity
with the rational numbers (i.e., the numbers of the form m/n, where m and n
are integers and n # 0).

The rational number system is inadequate for many purposes, both as a
field and as an ordered set. (These terms will be defined in Secs. 1.6 and 1.12.)
For instance, there is no rational p such that p? =2. (We shall prove this
presently.) This leads to the introduction of so-called “‘irrational numbers”
which are often written as infinite decimal expansions and are considered to be
“approximated’’ by the corresponding finite decimals. Thus the sequence

1, 1.4, 1.41, 1.414, 1.4142,..,

“tends to / 2,” But unless the irrational number J 2 has been clearly defined,
the question must arise: Just what is it that this sequence ‘‘tends to”?


--- Page 11 ---

2 PRINCIPLES OF MATHEMATICAL ANALYSIS

This sort of question can be answered as soon as the so-called “real
number system” is constructed.

1.1. Example We now show that the equation
(1) p’=2

is not satisfied by any rational p. If there were such a p, we could write p = m/n
where m and n are integers that are not both even. Let us assume this is done.
Then (1) implies

(2) m? = 2n?,

This shows that m? is even. Hence m is even (if m were odd, m? would be odd),
and so mm? is divisible by 4. It follows that the right side of (2) is divisible by 4,
so that n? is even, which implies that n is even.

The assumption that (1) holds thus leads to the conclusion that both m
and n are eyen, contrary to our choice of m and n. Hence (1) is impossible for
rational p.

We now examine this situation a little more closely. Let A be the set of
all positive rationals p such that p? < 2 and let B consist of all positive rationals
p such that p? > 2. We shall show that A contains no largest number and B con-
tains no smallest.

More explicitly, for every p in A we can find a rational g in A such that
p <q, and for every p in B we can find a rational g in B such that q < p.

To do this, we associate with each rational p > 0 the number

p?-2 2p+2
3 —7 _— =
G) q=P p+2 p+2
Then
2(p? — 2)
4 27_%=
(4) q (pa

If p is in A then p? — 2 <0, (3) shows that g >, and (4) shows that
g? <2. Thus q is in A.

If p is in B then p? — 2 > 0, (3) shows that 0 <g <p, and (4) shows that
q? > 2. Thus q is in B.

1.2 Remark The purpose of the above discussion has been to show that the
rational number system has certain gaps, in spite of the fact that between any
two rationals there is another: If r <s then r <(r + s)/2 <s. The real number
system fills these gaps. This is the principal reason for the fundamental role
which it plays in analysis.


--- Page 12 ---

THE REAL AND COMPLEX NUMBER SYSTEMS 3

In order to elucidate its structure, as well as that of the complex numbers,
we start with a brief discussion of the general concepts of ordered set and field.

Here is some of the standard set-theoretic terminology that will be used
throughout this book.

1.3 Definitions If A is any set (whose elements may be numbers or any other
objects), we write x € A to indicate that x is a member (or an element) of A.

If x is not a member of A, we write: x ¢ A.

The set which contains no element will be called the empty set. If a set has
at least one element, it is called nonempty.

If A and B are sets, and if every element of A is an element of B, we say
that A is a subset of B, and write 4 < B, or B> A. If, in addition, there is an
element of B which is not in A, then A is said to be a proper subset of B. Note
that A < A for every set A.

If Ac Band Bc A, we write A = B. Otherwise A # B.

1.4 Definition Throughout Chap. 1, the set of all rational numbers will be
denoted by Q.

ORDERED SETS

1.5 Definition Let S bea set. An order on Sis a relation, denoted by <, with
the following two properties:

(i) If xe Sand ye S then one and only one of the statements

x<y, x=y, yeux
is true.

(ii) Ifx, y, ze S, if x <y and y < z, then. x <z.

The statement ‘‘x < y’”’ may be read as “‘x is less than y”’ or ‘‘x is smaller
than y” or ‘‘x precedes y’’.

It is often convenient to write y > x in place of x < y.

The notation x < y indicates that x < y or x = y, without specifying which
of these two is to hold. In other words, x < y is the negation of x > y.

1.6 Definition An ordered set is a set S in which an order is defined.
For example, Q is an ordered set if r < s is defined to mean that s — risa
positive rational number.

1.7 Definition Suppose S is an ordered set, and Ec S. If there exists a
Be S such that x < B for every x € E, we say that E is bounded above, and call
B an upper bound of E.

Lower bounds are defined in the same way (with > in place of <).


--- Page 13 ---

4 PRINCIPLES OF MATHEMATICAL ANALYSIS

1.8 Definition Suppose S is an ordered set, E < S, and E is bounded above.
Suppose there exists an « € S with the following properties:

(i) ais an upper bound of E.
(ii) If y <a then y is not an upper bound of £.

Then a is called the least upper bound of E [that there is at most one such
a is clear from (ii)] or the supremum of E, and we write

a = sup E.

The greatest lower bound, or infimum, of a set E which is bounded below
is defined in the same manner: The statement

a=inf E

means that « is a lower bound of £ and that no B with B > a is a lower bound
of E.

1.9 Examples

(a) Consider the sets A and B of Example 1.1 as subsets of the ordered
set Q. The set A is bounded above. In fact, the upper bounds of A are
exactly the members of B. Since B contains no smallest member, A has
no least upper bound in Q.

Similarly, B is bounded below: The set of all lower bounds of B
consists of A and of all re Q with r < 0. Since A has no lasgest member,
B has no greatest lower bound in Q.

(b) If «= sup E exists, then « may or may not be a member of E. For
instance, let E, be the set of all re Q with r <0. Let E, be the set of all
reQ withr<0. Then

sup £, = sup FE, = 0,

and0¢£,,0eE,.
(c) Let E consist of all numbers 1/n, where n=1, 2, 3,.... Then
sup E = 1, which is in E, and inf E = 0, which is not in E£.

1.10 Definition An ordered set S is said to have the least-upper-bound property
if the following is true:
If Ec S, Eis not empty, and E is bounded above, then sup E exists in S.
Example 1.9(a) shows that Q does not have the least-upper-bound property.
We shall now show that there is a close relation between greatest lower
bounds and least upper bounds, and that every ordered set with the least-upper-
bound property also has the greatest-lower-bound property.


--- Page 14 ---

THE REAL AND COMPLEX NUMBER SYSTEMS 5

1.11 Theorem Suppose S is an ordered set with the least-upper-bound property,
BcS, B is not empty, and B is bounded below, Let L be the set of all lower
bounds of B. Then

a=supL

exists in S, and « = inf B.

In particular, inf B exists in S.

Proof Since B is bounded below, L is not empty. Since L consists of
exactly those ye S which satisfy the inequality y < x for every x e B, we
see that every x € B is an upper bound of L. Thus L is bounded above.
Our hypothesis about S implies therefore that L has a supremum in S;
call it a.

If y <a then (see Definition 1.8) » is not an upper bound of L,
hence y ¢ B. It follows that « < x for every xe B. Thus aeL.

If a < B then B ¢ L, since « is an upper bound of L.

We have shown that «eZ but B¢L if B >a. In other words, «
is a lower bound of B, but f is not if 8 > a. This means that « = inf B.

FIELDS

1.12 Definition A fie/d is a set F with two operations, called addition and
multiplication, which satisfy the following so-called ‘‘field axioms’? (A), (M),
and (D):

(A)

(M)

Axioms for addition

(Al) IfxeF and ye F, then their sum x + y is in F.

(A2) Addition is commutative: x + y = y+ x for all x, ye F.

(A3) Addition is associative: (x + y)+z=x+(y + 2) forall x, y,zeF.
(A4) F contains an element 0 such that 0 + x = x for every xe F.

(A5) To every xe F corresponds an element —xeF such that

x +(-—x) =0.

Axioms for multiplication

(M1) IfxeFand ye F, then their product xy is in F.

(M2) Multiplication is commutative: xy = yx for all x, ye F.

(M3) Multiplication is associative: (xy)z = x(yz) for all x, y, ze F.
(M4) F contains an element 1 4 0 such that Ix = x for every x € F.
(M5) If xe F and x #0 then there exists an element 1/x ¢ F such that

x (I/x) =1,


--- Page 15 ---

6 PRINCIPLES OF MATHEMATICAL ANALYSIS

(D) The distributive law

x(y +z) = xy + xz

holds for all x, y, ze F.

1.13

1.14

Remarks
(a) One usually writes (in any field)

K-Wi ety te xyz, x7, x3, 2x, 3x,...
in place of
1
x+(-y)0°() G49) +2 Gola en meee etm.

(6) The field axioms clearly hold in Q, the set of all rational numbers, if
addition and multiplication have their customary meaning. Thus @Q is a
field.

(c) Although it is not our purpose to study fields (or any other algebraic
structures) in detail, it is worthwhile to prove that some familiar properties
of Q are consequences of the field axioms; once we do this, we will not
need to do it again for the real numbers and for the complex numbers.

Proposition The axioms for addition imply the following statements.

(a) Ifx+y=x4+2ztheny =z.
(6) Ifx+y=x theny=0.
(c) Ifx+y=0 theny = —x.
(4) -—(-x)=x.

Statement (a) is a cancellation law. Note that (5) asserts the uniqueness

of the element whose existence is assumed in (A4), and that (c) does the same
for (AS).

Proof If x+y=x +z, the axioms (A) give

y=O+y=(—x4+x) + y= —xt+(x+y)
=se_xt¢(xt+z)=(-x+x)+72=04+72=2.

This proves (a). Take z =0 in (a) to obtain (6). Take z = —x in (a) to
obtain (c).
Since —x + x = 0, (c) (with —x in place of x) gives (@).


--- Page 16 ---

1.15

THE REAL AND COMPLEX NUMBER SYSTEMS 7

Proposition The axioms for multiplication imply the following statements.

(a) Ifx #0 and xy = xz then y =z.
(6) Ifx #0 and xy =x theny=1.

(c) Ifx #0 and xy =1 then y =1/x.
(d) If x #0 then 1/(1/x) =x.

The proof is so similar to that of Proposition 1.14 that we omit it.

1.16 Proposition The field axioms imply the following statements, for any x, y,

zeF,

(a) Ox =0.
(6b) Ifx #0 and y £0 then xy £0.
(c) (—x)y = —(xy) = x(-y).
(4d) (-—x)(—y) = xy.
Proof Ox + 0x = (0 +0)x =0x. Hence 1.14(4) implies that 0x = 0, and
(a) holds.
Next, assume x #0, y #0, but xy =0. Then (a) gives

1
'=()G)7=G)G)o-*
yi \x YI \Xx,
a contradiction. Thus (}) holds.
The first equality in (c) comes from
(—x)y + xy = (—x + x)y = Oy = 0,

combined with 1.14(c); the other half of (c) is proved in the same way.
Finally,
(—x(-y) = —[x(-y)] = -[-@y)] = xy

by (c) and 1.14(d).

1.17. Definition An ordered field is a field F which is also an ordered set, such

that

Gi) x+y<x+4+zifx,y,zeFandy <z,
(ii) xy>Oifxe F, ye F,x>0,andy>0.

If x > 0, we call x positive; if x <0, x is negative.

field:

For example, Q is an ordered field.
All the familiar rules for working with inequalities apply in every ordered
Multiplication by positive [negative] quantities preserves [reverses] in-

equalities, no square is negative, etc. The following proposition lists some of

these.


--- Page 17 ---

8 PRINCIPLES OF MATHEMATICAL ANALYSIS

1.18 Proposition The following statements are true in every ordered field.

(a) Ifx>0 then —x <0, and vice versa.

(6) Ifx>0O andy <z then xy <xz.

(c) Ifx<Oandy <2z then xy> xz.

(d) If x #0 then x? >0. In particular, 1 > 0.
(e) fO0<x<y then0 <1/y < 1/x.

Proof
(2) Ifx>Othen0 = —-x+x>—x+0, so that —x <0. If x <0 then
O=—-x+x< —x+0, so that —x >0. This proves (a).
(b) Since z>y, we have z~y>y—y=0, hence x(z — y)>0, and
therefore

xZ=x(z-—y)txy>O+xy=xy.
(c) By (a), (8), and Proposition 1.16(c),

—[x(z — y)] = (—x)@ — y) > 0,

so that x(z — y) <0, hence xz < xy.
(d) If x >0, part (ii) of Definition 1.17 gives x? >0. If x <0, then
—x>0, hence (—x)?>0. But x? =(—x)*, by Proposition 1.16(d).
Since 1 = 17,1 >0.
(e) Ify>Oandv <0, then yv <0. Buty: (1/y)=1>0. Hence 1/y > 0.

Likewise, 1/x > 0. If we multiply both sides of the inequality x < y by
the positive quantity (1/x)(1/y), we obtain 1/y < 1/x.

THE REAL FIELD

We now state the existence theorem which is the core of this chapter.

1.19 Theorem There exists an ordered field R which has the least-upper-bound

property.
Moreover, R contains Q as a subfield.

The second statement means that Qc R and that the operations of
addition and multiplication in R, when applied to members of Q, coincide with
the usual operations on rational numbers; also, the positive rational numbers
are positive elements of R.

The members of R are called real numbers.

The proof of Theorem 1.19 is rather long and a bit tedious and is therefore
presented in an Appendix to Chap. 1. The proof actually constructs R from Q.


--- Page 18 ---

THE REAL AND COMPLEX NUMBER SYSTEMS 9

The next theorem could be extracted from this construction with very
little extra effort. However, we prefer to derive it from Theorem 1.19 since this
provides a good illustration of what one can do with the least-upper-bound

property.

1.20 Theorem

(a) IfxeR, yeR, and x >0, then there is a positive integer n such that
nx > y.
(6) IfxeR, ye R,andx < y, then there existsape Qsuchthatx<p<y.

Part (a) is usually referred to as the archimedean property of R. Part (6)
may be stated by saying that Q is dense in R: Between any two real numbers
there is a rational one.

Proof
(a) Let A be the set of all nx, where n runs through the positive integers.
If (a) were false, then y would be an upper bound of A. But then A has a
least upper bound in R. Put a=sup A. Since x >0, «—-x<a, and
a — x is not an upper bound of A. Hence « — x < mx for some positive
integer m. But then % <(m + 1)x € A, which is impossible, since « is an
upper bound of A.
(6) Since x < y, we have y — x > 0, and (a) furnishes a positive integer
n such that
ny —x)>1.

Apply (a) again, to obtain positive integers m, and m, such that m, > nx,
m,> —nx. Then

—Ms <nx< mM.

Hence there is an integer m (with —m, < m < m,) such that
m~-l<snx<m.
If we combine these inequalities, we obtain
nx<m<l+nx<ny.

Since n > 0, it follows that
x<n<
n>

This proves (5), with p = m/n.


--- Page 19 ---

10 PRINCIPLES OF MATHEMATICAL ANALYSIS

We shall now prove the existence of nth roots of positive reals. This
proof will show how the difficulty pointed out in the Introduction (irration-

ality of ./2) can be handled in R.

1.21. Theorem For every real x >0O and every integer n>O there is one
and only one positive real y such that y" = x.

This number y is written 2/x or x'/",

Proof That there is at most one such y is clear, since 0 < y, < y, implies
Yi<y}.

Let E be the set consisting of all positive real numbers ¢ such that
"<x,

If t= x/(1 +x) thenO0<¢<1. Hence t"<t<x. Thus te £, and
E is not empty.

If*>1+-x then t*2=¢> x, so that r¢ £. Thus 1 +x is an upper
bound of £.

Hence Theorem 1.19 implies the existence of

y = sup E.

To prove that y" = x we will show that each of the inequalities y" <x
and y" > x leads to a contradiction.

The identity 6” — a" =(b —a)(b""' + b"-2a +--+ +a") yields
the inequality

b" — a" < (6 —a)nb""!

when 0 <a<b,

Assume y" < x. Choose #4 so that 0 <A <1 and
x-y'
< —__—__..
h ny + 1)""?

Puta=y,b=y+h. Then
(y + hy —y" <hnly + hy! <hn(y + It <x-y.

Thus (y+4)"<x, and y+heE. Since y+hA> y, this contradicts the
fact that y is an upper bound of E.
Assume y" > x. Put

y=,
ny"~}
ThenO0<k<y. If t>y—k, we conclude that
y—hsy—(y—ky! <kny'=y"—x.
Thus ¢"> x, and t¢ £. It follows that y—& is an upper bound of E.

k=


--- Page 20 ---

THE REAL AND COMPLEX NUMBER SYSTEMS I1

But y — k <y, which contradicts the fact that y is the least upper bound
of E.
Hence y” = x, and the proof is complete.
Corollary If a and 6 are positive real numbers and n is a positive integer, then

(ab)'” _ qiinptin.
Proof Put «=a'", B=)", Then
ab = a"B" = (af)",

since multiplication is commutative. [Axiom (M2) in Definition 1.12.]
The uniqueness assertion of Theorem 1.21 shows therefore that

(ab) = ap = qilnpiin

1.22 Decimals We conclude this section by pointing out the relation between
real numbers and decimals.

Let x > 0 be real. Let my be the largest integer such that 7) < x. (Note that
the existence of n) depends on the archimedean property of R.) Having chosen

Nos My,..+ M4, let n, be the largest integer such that
Mo tatters +ah sx
°" 10 106"

Let E be the set of these numbers
ny _
io *

Then x = sup E. The decimal expansion of x is

(5) No + +k (k =0,1,2,...).

(6) Mg" NyN2N3°*”. .
Conversely, for any infinite decimal (6) the set E of numbers (5) is bounded
above, and (6) is the decimal expansion of sup £.

Since we shall never use decimals, we do not enter into a detailed
discussion.

THE EXTENDED REAL NUMBER SYSTEM

1.23. Definition The extended real number system consists of the real field R
and two symbols, +00 and —oo. We preserve the original order in R, and
define

—-O<x¥< +0
for every xeE R.


--- Page 21 ---

12 PRINCIPLES OF MATHEMATICAL ANALYSIS

It is then clear that + 0o is an upper bound of every subset of the extended
real number system, and that every nonempty subset has a Jeast upper bound.
If, for example, E is a nonempty set of real numbers which is not bounded
above in R, then sup E = +00 in the extended real number system.

Exactly the same remarks apply to lower bounds.

The extended real number system does not form a field, but it is customary
to make the following conventions:

(a) If x is real then

x x
x+0=+0, x-—O=—O, —— =—— = 0.
+0 -@
(6) Ifx>O0 then x: (+0) = +0, x: (—o) = -o.
(c) If x <0 then x: (+00) = —00, x-(—o)= +00.

When it is desired to make the distinction between real numbers on the
one hand and the symbols +00 and — oo on the other quite explicit, the former
are called finite.

THE COMPLEX FIELD

1.24 Definition A complex number is an ordered pair (a, b) of real numbers.
““Ordered’’ means that (a, b) and (b, a) are regarded as distinct if a # b.

Let x = (a, b), y = (c, d) be two complex numbers. We write x = y if and
only if a=c and b=d. (Note that this definition is not entirely superfluous;
think of equality of rational numbers, represented as quotients of integers.) We
define

x+y=(at+ce,b+4),

xy = (ac — bd, ad + bc).

1.25 Theorem These definitions of addition and multiplication turn the set of
all complex numbers into a field, with (0, 0) and (1, 0) in the role of 0 and 1.

Proof We simply verify the field axioms, as listed in Definition 1.12.
(Of course, we use the field structure of R.)

Let x = (a, b), y= (c,d), z= (e,/).
(Al) is clear.
(A2) x+y=(at+e¢e,b4+d=(c+a,d+b)=yt™x.


--- Page 22 ---

1.26

THE REAL AND COMPLEX NUMBER SYSTEMS 13

(A3) @+y4+z=(4+6,b4+0D+6,S)
=(a+ct+e,b+d+f)
=(a,b)+(c+ed+fy=x+(y +2).
(A4) x+0= (a, b)+ (0, 0) =, db) =x.
(A5) Put —x =(-a, —b). Then x + (—x) = (0, 0) =0.,
(M1) _ is clear.
(M2) xy = (ac — bd, ad + bc) = (ca — db, da + cb) = yx.
(M3) (xy)z = (ac — bd, ad + be)(e, f)
== (ace — bde — adf — bef, acf — bdf + ade + bce)
= (a, b)(ce — df, of + de) = x(yz).
(M4) Ix =(1, 0)(a, 6) = (Ga, 6) = x.
(M5) If x #0 then (a, b) 4 (0,0), which means that at least one of the
real numbers a, b is different from 0. Hence a* + b* > 0, by Proposition
1.18(@), and we can define

x \ae+b?? a+b?
Then
(D) x(v+z)=(,b(c+e,d+f)
= (ac + ae — bd — bf, ad + af + be + be)
= (ac — bd, ad + bc) + (ae — bf, af + be)

= xy + xz.

)=G.0=1.

Theorem For any real numbers a and b we have
(a, 0) + (b, 0) =(a+ 6,0), (a, 0)(b, 0) = (ab, 0).

The proof is trivial.

Theorem 1.26 shows that the complex numbers of the form (a, 0) have the

same arithmetic properties as the corresponding real numbers a. We can there-
fore identify (a, 0) with a. This identification gives us the real field as a subfield
of the complex field.

The reader may have noticed that we have defined the complex numbers

without any reference to the mysterious square root of —1. We now show that
the notation (a, b) is equivalent to the more customary a + bi.

1.27

Definition i = (0, 1).


--- Page 23 ---

14 PRINCIPLES OF MATHEMATICAL ANALYSIS

1.28 Theorem i? = —1.

1.29 Theorem Jf a and b are real, then (a, b) =a + bi.

Proof
a+ bi =(a, 0) + ©, 0), 1)
= (a, 0) + (0, b) =G, bd).

1.30 Definition If a, b are real and z=a+ bi, then the complex number
z% =a — bi is called the conjugate of z. The numbers a and b are the real part
and the imaginary part of z, respectively.

We shall occasionally write

a= Re(z), b = Im(z).

1.31 Theorem Jf z and w are complex, then

(b) zw=Z-w,

(c) z+2%=2 Re(z), z—2Z = 2iIm(2),

(d) 2z is real and positive (except when z = 0).

Proof (a), (6), and (c) are quite trivial. To prove (d), write z = a + bi,
and note that zz = a? + b?.

1.32. Definition If z is a complex number, its absolute value |z| is the non-
negative square root of zz; that is, |z| = (zz)'/*.

The existence (and uniqueness) of |z| follows from Theorem 1.21 and
part (d) of Theorem 1.31.

Note that when x is real, then ¥ =x, hence |x| =,/x?. Thus |x| =x
if x >0, |x| = -xifx <0.

1.33 Theorem Let z and w be complex numbers. Then

(a) |z| >O unless z=0, |0| =0,

(6) |2| = |z},
(c) |zw| = |z||wI,
(@) |Rez|<|z|,

(ec) |z+w| s|2| + [wl].


--- Page 24 ---

THE REAL AND COMPLEX NUMBER SYSTEMS 15

Proof (a) and (6) are trivial. Put z=a+ bi, w=c + di, with a, b,c, d
real. Then

|zw|? = (ac — bd)* + (ad + bc)? = (a? + b*)\(c? + d?) = |z|?|w|?
or |zw|? =(|z||w]|)?. Now (c) follows from the uniqueness assertion of

Theorem 1.21.
To prove (d), note that a? < a? + b?, hence

lal = fax Jara Be,
To prove (e), note that Zw is the conjugate of zw, so that zw + Zw =
2 Re (zw). Hence
|z+w|? =(z+w(Z+ W) = 27 + zw + Zw + Wh
= |z|? +2 Re (zi) + |w|?
< |z|? + 2|z| + |w|?
= |2|? + 2|z||w| + |wl? =(|z| + | wl).

Now (e) follows by taking square roots.

1.34 Notation If x,,..., x, are complex numbers, we write
n
Xp tXy tr +%y= Lx.
je

We conclude this section with an important inequality, usually known as
the Schwarz inequality.

1.35 Theorem If a,,..., a, and b,,..., 6, are complex numbers, then
n 2 a 2 a 2

yajbj} < ¥ lal? > [5l?.

j=l f=1 jel

Proof Put 4 = Z|a;|*, B= Z|b,|7, C = a,b, (in all sums in this proof,
j runs over the values 1, ..., 7”). If B= 0, then b, = --- = 5, =0, and the
conclusion is trivial. Assume therefore that B > 0. By Theorem 1.31 we
have

> | Ba, — Cb,|? = ¥ (Ba; — Cb,(Ba,; — Cb,)
= B’Y' |a;|* - BC a,b, — BC) a,b, + |C|? > |,|?
= B?A — B\C|?
= B(AB — |C|?).



--- Page 25 ---

16 PRINCIPLES OF MATHEMATICAL ANALYSIS

Since each term in the first sum is nonnegative, we see that
B(AB — |C|?) = 9.
Since B > 0, it follows that AB — |C|* > 0. This is the desired inequality.

EUCLIDEAN SPACES

1.36 Definitions For each positive integer k, let R* be the set of all ordered
k-tuples
X = (X1, X2, sony Xe)

where x;,..., x; are real numbers, called the coordinates of x. The elements of
R* are called points, or vectors, especially when k > 1. We shall denote vectors
by boldfaced letters. If y = (4, ..., y,) and if « is a real number, put

KAY = (Xp + Vp 0-1 Xe + Mes
ax = (0X1, ..., &X,)

so that x + ye R* and axe R*. This defines addition of vectors, as well as
multiplication of a vector by a real number (a scalar), These two operations
satisfy the commutative, associative, and distributive laws (the proof is trivial,
in view of the analogous laws for the real numbers) and make R* into a vector
space over the real field. The zero element of R* (sometimes called the origin or
the null vector) is the point 0, all of whose coordinates are 0.

We also define the so-called “inner product”’ (or scalar product) of x and

y by

Mr

XY = 2%ii

1
and the norm of x by

k 1/2
|x| = x)" =(¥ 2) .
1

The structure now defined (the vector space R* with the above inner
product and norm) is called euclidean k-space.

1.37. Theorem Suppose x, y, z € R*, and « is real. Then

(a) |x| =0;
(b) |x| =0 ifand only if x = 0;
(c) |ox| = |a||x|;

(7) |x-y| <|xilyl;
(e) |x+y| <|x| + lyls
(f) |x-2z| < |x-y| + ly—z|.


--- Page 26 ---

THE REAL AND COMPLEX NUMBER SYSTEMS 17

Proof (a), (6), and (c) are obvious, and (@) is an immediate consequence
of the Schwarz inequality. By (d) we have

Ix+y|?=(+y)'(+y)
=x'x+2x-y+y'y
< |x|? + 2|x| ly] + ly]?
= (|x| + ly|)?,

so that (e) is proved. Finally, (f) follows from (e) if we replace x by
x -~yandy by y—z.

1.38 Remarks Theorem 1.37 (a), (5), and (/) will allow us (see Chap. 2) to
regard R* as a metric space.

R' (the set of all real numbers) is usually called the line, or the real line.
Likewise, R? is called the plane, or the complex plane (compare Definitions 1.24
and 1.36). In these two cases the norm is just the absolute value of the corre-
sponding real or complex number.

APPENDIX

Theorem 1.19 will be proved in this appendix by constructing R from Q. We
shall divide the construction into several steps.

Step 1 The members of R will be certain subsets of Q, called cuts. A cut is,
by definition, any set « < Q with the following three properties.

(I) ais not empty, and a ¥ Q.
dd Ifpea, qe Q, and q <p, then gea.
(iD If pea, then p <r for some re a.

The letters p, q, r,... will always denote rational numbers, and a, B, y, ...
will denote cuts.

Note that (III) simply says that « has no largest member; (II) implies two
facts which will be used freely:

If pea and g ¢a then p <q.
Ifr¢éaandr<sthens¢a.

Step 2 Define “‘a < B” to mean: « is a proper subset of f.

Let us check that this meets the requirements of Definition 1.5.

Ifa < B and f < it is clear that « < y. (A proper subset of a proper sub-
set is a proper subset.) It is also clear that at most one of the three relations

a<Bp, a=B, B<ao


--- Page 27 ---

18 PRINCIPLES OF MATHEMATICAL ANALYSIS

can hold for any pair a, 8. To show that at least one holds, assume that the
first two fail. Then « is not a subset of 8. Hence there is a pea with p¢ f.
If gé 8B, it follows that q <p (since p¢ f), hence g ea, by (II). Thus B ca.
Since B # a, we conclude: B < a.

Thus R is now an ordered set.

Step 3 The ordered set R has the least-upper-bound property.

To prove this, let 4 be a nonempty subset of R, and assume that Be R
is an upper bound of A. Define y to be the union of alla ¢ A. In other words,
péy if and only if pea for some «e€ A. We shall prove that ye R and that
y =sup A.

Since A is not empty, there exists an a) € A. This a is not empty. Since
% < y, yis not empty. Next, y < B (since « < f for every « € A), and therefore
y #Q. Thus y satisfies property (1). To prove (II) and (III), pick p € y. Then
pea, for some a,e A. If g <p, then geu,, hence ge; this proves (II). If
réa, is so chosen that r > p, we see that rey (since «, ¢ y), and therefore y
satisfies (III).

Thus ye R.

It is clear that « < y for every ae A.

Suppose 6 < y. Then there is an sey and that s¢6. Since sey, sea
for some ae A. Hence 6 < a, and 6 is not an upper bound of A.

This gives the desired result: y = sup A.

Step 4 Ifwe Rand fe R we define « + £ to be the set of all sums r + s, where
reaandse fp.
We define 0* to be the set of all negative rational numbers. It is clear that
0* is a cut. We verify that the axioms for addition (see Definition 1.12) hold in
R, with 0* playing the role of 0.
(Al) We have to show that « + B is a cut. It is clear that a + B is a
nonempty subset of Q. Take r’éa, s'¢ 8. Then r’'+s'>r+s for all
choices of rea, se f. Thus r’+s’¢a+ 8. It follows that «+ has
property (I).

Pick pea+f. Then p=r+s, with rea, se. If g<p, then
q—-s<r, so gq—sea, and g=(¢—s)+sea+f. Thus (II) holds.
Choose tea so that¢>r. Thenp<t+sand¢t+sea+p. Thus (IID)
holds.

(A2) « + Bis the set of allr + 5, withrea,sef. By the same definition,
B +« is the set of alls +r. Since r+s=s+,r for allreQ, se Q, we
havea + BP=f +4.

(A3) As above, this follows from the associative law in Q.

(A4) Ifreaandse0*, thenr+s<r,hencer+sea. Thusa+0* ca.
To obtain the opposite inclusion, pick p ea, and pick réa,r>p. Then


--- Page 28 ---

THE REAL AND COMPLEX NUMBER SYSTEMS 19

p—re0*, and p=r+(p—rj)eat+O0*. Thusaca+0*, We conclude
that « + 0* =a.
(AS) Fix ae R. Let B be the set of all p with the following property:

There exists r > 0 such that —-p—ré«.

In other words, some rational number smaller than —p fails to
be in a.

We show that B € R and that a + B =0*.

ifs ¢éa and p= —s—1, then -p—1 ¢a, hence pe f. So B is not
empty. Ifgea, then —¢¢f. SoB #Q. Hence B satisfies (I).

Pick pe f, and pick r>0, so that -p—réoa. If q<p, then
—g—-r>-—p-—r, hence -g—réa. Thus gef, and (II) holds. Put
t=p+(r/2). Then ¢>p, and —/-—(r/2)= —p—ré¢a, so that te 8p.

Hence £ satisfies (111).

We have proved that Be R.

If reaand se B, then --s ¢éa, hence r< —s, r+s<0. Thus
a+BcoO0*,

To prove the opposite inclusion, pick v €0*, put w= —v/2. Then

w > 0, and there is an integer n such that nw ea but (n + Iwéa. (Note
that this depends on the fact that Q has the archimedean property!) Put
= —(n +2)w. Then pe f, since —p —wéa, and

venw+peatfB.
Thus 0* c « + B.
We conclude that « + B = 0*.
This B will of course be denoted by —a.

Step 5 Having proved that the addition defined in Step 4 satisfies Axioms (A)
of Definition 1.12, it follows that Proposition 1.14 is valid in R, and we can
prove one of the requirements of Definition 1.17:

Ifa, B, ye Rand B<y, thna+B<at+y.

Indeed, it is obvious from the definition of + in Rthata+Bca+y; if
we had «+ B=a+ , the cancellation law (Proposition 1.14) would imply
Bay.

It also follows that a > 0* if and only if —« <0*.

Step 6 Multiplication is a little more bothersome than addition in the present
context, since products of negative rationals are positive. For this reason we
confine ourselves first to R*, the set of all we R with « > 0*.

Ifae R* and fe R*, we define a to be the set of all p such that p < rs
for some choice of rea, sé B, r>0,5>0.

We define 1* to be the set of all ¢ < 1,


--- Page 29 ---

20 PRINCIPLES OF MATHEMATICAL ANALYSIS

Then the axioms (M) and (D) of Definition 1.12 hold, with R* in place of F,
and with 1* in the role of 1.
The proofs are so similar to the ones given in detail in Step 4 that we omit

them.
Note, in particular, that the second requirement of Definition 1.17 holds:

If « > 0* and B > 0* then af > 0*.

Step 7 We complete the definition of multiplication by setting «0* = 0*a = 0*,
and by setting
(-a)(-B)  ifa<0*, B <0*,
aB=(—[(—a)p] ifa<0*, B>0*,
—[«-(-B)] ifa>0*, B<0*.
The products on the right were defined in Step 6.
Having proved (in Step 6) that the axioms (M) hold in R*, it is now
perfectly simple to prove them in R, by repeated application of the identity

y = —(—)) which is part of Proposition 1.14. (See Step 5.)
The proof of the distributive law

a(B + y) = a8 + ay
breaks into cases. For instance, suppose a >0*, B <0*, B+y>0*. Then
y =(6 + y) + (—8B), and (since we already know that the distributive law holds
in R*)

ay = a(B + y) +a-(—f).

But a: (—f8) = —(a@f). Thus

aB + ay =a(f + 7).
The other cases are handled in the same way.

We have now completed the proof that R is an ordered field with the least-

upper-bound property.

Step 8 We associate with each re Q the set r* which consists of all pe Q
such that p <r. It is clear that each r* is a cut; that is, r* e R. These cuts satisfy

the following relations:

(a) r*+s*=(r+s)*,

(0) ist = (r3)*,

(c) r* <s* if and only ifr<s.

To prove (a), choose per* +s*. Then p=u+ov, where u<r, v<s.
Hence p <r +s, which says that pe (r+ 5)*.


--- Page 30 ---

THE REAL AND COMPLEX NUMBER SYSTEMS 21

Conversely, suppose pe(r+s)*. Then p<r+s. Choose ¢ so that

2t=r+s—p, put
r=r—ts'=s—t.

Then r’ er*, s’' es*, and p =r’ +5’, so that per* + s*.

This proves (a). The proof of (5) is similar.

Ifr<sthenres*, butr¢r*; hence r* < s*,

If r* <5*, then there is a pes* such that p¢r*. Hence rs p<s, so
thatr<-s.

This proves (c).

Step 9 We saw in Step 8 that the replacement of the rational numbers r by the
corresponding “‘rational cuts” r* e R preserves sums, products, and order. This
fact may be expressed by saying that the ordered field Q is isomorphic to the
ordered field Q* whose elements are the rational cuts. Of course, r* is by no
means the same as r, but the properties we are concerned with (arithmetic and
order) are the same in the two fields.

It is this identification of Q with Q* which allows us to regard Q as a
subfield of R.

The second part of Theorem 1.19 is to be understood in terms of this
identification. Note that the same phenomenon occurs when the real numbers
are regarded as a subfield of the complex field, and it also occurs at a much
more elementary level, when the integers are identified with a certain subset of Q.

It is a fact, which we will not prove here, that any two ordered fields with
the least-upper-bound property are isomorphic. The first part of Theorem 1.19
therefore characterizes the real field R completely.

The books by Landau and Thurston cited in the Bibliography are entirely
devoted to number systems. Chapter 1 of Knopp’s book contains a more
leisurely description of how R can be obtained from Q. Another construction,
in which each real number is defined to be an equivalence class of Cauchy
sequences of rational numbers (see Chap. 3), is carried out in Sec. 5 of the book
by Hewitt and Stromberg.

The cuts in Q which we used here were invented by Dedekind. The
construction of R from Q by means of Cauchy sequences is due to Cantor.
Both Cantor and Dedekind published their constructions in 1872.

EXERCISES

Unless the contrary is explicitly stated, all numbers that are mentioned in these exer-
cises are understood to be real.

1. If r is rational (r 4 0) and x is irrational, prove that r + x and rx are irrational.


--- Page 31 ---

22 PRINCIPLES OF MATHEMATICAL ANALYSIS

. Prove that there is no rational number whose square is 12.

. Prove Proposition 1.15.

. Let E be a nonempty subset of an ordered set; suppose « is a lower bound of E
and f is an upper bound of E. Prove that « <8.

5. Let A be a nonempty set of real numbers which is bounded below. Let —A be

the set of all numbers —x, where x € A. Prove that

inf A = —sup(— A).

hw NN

6. Fix b> 1.
(a) If m, n, p, q are integers, x > 0, g >0, and r= m/n = p/q, prove that

(b™)1" = (b?)1/¢,
Hence it makes sense to define b’ = (b™)!/",
(6) Prove that b'*+* = b'b' if r and s are rational.
(c) If x is real, define B(x) to be the set of all numbers 5', where ¢ is rational and
t<-x. Prove that

b' =sup B(r)
when r is rational. Hence it makes sense to define
b* = sup B(x)

for every real x.
(d) Prove that b**+” = 6*b for all real x and y.

7. Fix b>1, y>0, and prove that there is a unique real x such that b* = y, by
completing the following outline. (This x is called the logarithm of y to the base b.)
(a) For any positive integer 7, b"— 1 >n(b— 1).

(6) Hence 6 — 1 > n(b'”" — 1).

(c) If t>1 andn>(6— 1)/¢— D, then b'” <1.

(a) If w is such that b” < y, then b”*“™ < y for sufficiently large n; to see this,
apply part (c) with t=y- 57”.

(e) If b” > y, then b”-“'™ > y for sufficiently large n.

(f) Let A be the set of all w such that b” < y, and show that x =sup A satisfies
be =y.

(g) Prove that this x is unique.

8. Prove that no order can be defined in the complex field that turns it into an ordered
field. Hint: —1 is a square.

9. Suppose z=a+ bi, w=c+4+di. Define z<w if a<c, and also if a=c but
b<d. Prove that this turns the set of all complex numbers into an ordered set.
(This type of order relation is called a dictionary order, or lexicographic order, for
obvious reasons.) Does this ordered set have the least-upper-bound property?

10. Suppose z=a-+ bi, w=u- iv, and

_(lwlte\ 4 _(lwl=a\"?
o- (ei ’ b= 3 .


--- Page 32 ---

11.

12.

13,

14.

15.
16.

17.

18

19.

20.

THE REAL AND COMPLEX NUMBER SYSTEMS 23

Prove that z? = w if v >0 and that (Z)? = w if v <0. Conclude that every complex
number (with one exception!) has two complex square roots.

If z is a complex number, prove that there exists an r >0 and a complex number
w with |w| =1 such that z=rw. Are w and r always uniquely determined by z?
If z,;,..., Zn are complex, prove that

[zu tzatere + Zn] < [zi] + [ze] + +++ + [zal

If x, y are complex, prove that

lx] — Il] <|x—y].
If z is a complex number such that |z| =1, that is, such that z7 = 1, compute

[1 +z]?+ [1-—z|?.

Under what conditions does equality hold in the Schwarz inequality?
Suppose k > 3, x, ye R*, |x—y| =d>0, andr>0. Prove:
(a) If 2r > d, there are infinitely many z € R* such that

[z—x| =|z—y| =r.
(b) If 2r = d, there is exactly one such z.
(c) If 2r <d, there is no such z.
How must these statements be modified if k is 2 or 1?
Prove that

Ix+y|? +|x—y|? =2|x|? + 2ly|?

if xe R* and ye R*. Interpret this geometrically, as a statement about parallel-
ograms,
If k>2 and xe R*, prove that there exists y < R* such that y #0 but x-y = 0.
Is this also true if k =1?
Suppose a é R*,b & R*. Find ce R* and r >0 such that

{x—a| =2|x—b|
if and only if |x —e| =r.
(Solution: 3c = 4b — a, 3r = 2|b — al.)
With reference to the Appendix, suppose that property (III) were omitted from the
definition of a cut. Keep the same definitions of order and addition. Show that

the resulting ordered set has the least-upper-bound property, that addition satisfies
axioms (A1) to (A4) (with a slightly different zero-element!) but that (A5) fails.


--- Page 33 ---

2

BASIC TOPOLOGY

FINITE, COUNTABLE, AND UNCOUNTABLE SETS

We begin this section with a definition of the function concept.

2.1 Definition Consider two sets A and B, whose elements may be any objects
whatsoever, and suppose that with each element x of A there is associated, in
some manner, an element of B, which we denote by f(x). Then / is said to be a
function from A to B (or a mapping of A into B). The set A is called the domain
of f (we also say fis defined on A), and the elements f(x) are called the values
of f. The set of all values of fis called the range of f.

2.2 Definition Let A and B be two sets and let f be a mapping of A into B.
If Ec A, f(£) is defined to be the set of all elements f(x), for xe E. We call
J(E) the image of E under f. In this notation, f(A) is the range of f. It is clear
that f(A) < B. If f(A) = B, we say that fmaps A onto B. (Note that, according
to this usage, onto is more specific than into.)

If Ec B, f~'(E) denotes the set of all x € A such that f(x)e E. We call
S71 (B) the inverse image of E under f. If ye B, f~1(y) is the set of all xe A


--- Page 34 ---

BASIC TOPOLOGY 25

such that f(x) =y. If, for each ye B, f~'(y) consists of at most one element
of A, then f is said to be a 1-1 (one-to-one) mapping of A into B. This may
also be expressed as follows: fis a 1-1 mapping of A into B provided that
F(x1) 4 (xz) whenever x, # x2, xX, € A, Xz EA.

(The notation x, # x, means that x, and x, are distinct elements; other-
wise we write x, = x2.)

2.3 Definition If there exists a 1-1 mapping of A onto B, we say that A and B
can be put in 1-1 correspondence, or that A and B have the same cardinal number,
or, briefly, that A and B are equivalent, and we write A ~ B. This relation
clearly has the following properties:

It is reflexive: A ~ A.
It is symmetric: If A ~ B, then B ~ A.
It is transitive: If A~ Band B~C, then A~C.

Any relation with these three properties is called an equivalence relation.

2.4 Definition For any positive integer n, let J, be the set whose elements are
the integers 1, 2, ..., 2; let J be the set consisting of all positive integers. For any
set A, we say:

(a) A is finite if A ~ J, for some n (the empty set is also considered to be
finite).

(6) A is infinite if A is not finite.

(c) Ais countable if A~ J.

(d) A is uncountable if A is neither finite nor countable.

(e) A is at most countable if A is finite or countable.

Countable sets are sometimes called enumerable, or denumerable.

For two finite sets A and B, we evidently have 4 ~ B if and only if A and
B contain the same number of elements. For infinite sets, however, the idea of
“having the same number of elements’ becomes quite vague, whereas the notion
of 1-1 correspondence retains its clarity.

2.5 Example Let 4 be the set of all integers. Then 4 is countable. For,
consider the following arrangement of the sets A and J:

A: 0,1, —1,2, —2, 3, —3,..,
1, 2, 3, 4, 5, 6, 7,...


--- Page 35 ---

26 PRINCIPLES OF MATHEMATICAL ANALYSIS

We can, in this example, even give an explicit formula for a function f
from J to A which sets up a 1-1 correspondence:

n
{ 3 (n even),
f@ =

n-1
|- 5 (” odd).

2.6 Remark A finite set cannot be equivalent to one of its proper subsets.
That this is, however, possible for infinite sets, is shown by Example 2.5, in
which J is a proper subset of A.

In fact, we could replace Definition 2.4(b) by the statement: A is infinite if
A is equivalent to one of its proper subsets.

2.7 Definition By a sequence, we mean a function f defined on the set J of all
positive integers. If f(n) = x,, for ne J, it is customary to denote the sequence
J by the symbol {x,}, or sometimes by x,, x.,x3,.... The values of /, that is,
the elements x, are called the terms of the sequence. If A is a set and if x, € A
for all n eJ/, then {x,} is said to be a sequence in A, or a sequence of elements of A.

Note that the terms x,, x,,x3,... of a sequence need not be distinct.

Since every countable set is the range of a 1-1 function defined on J, we
may regard every countable set as the range of a sequence of distinct terms.
Speaking more loosely, we may say that the elements of any countable set can
be ‘“‘arranged in a sequence.”

Sometimes it is convenient to replace J in this definition by the set of all
nonnegative integers, i.e., to start with 0 rather than with 1.

2.8 Theorem Every infinite subset of a countable set A is countable.

Proof Suppose £ c A, and E is infinite. Arrange the elements x of A in
a sequence {x,} of distinct elements. Construct a sequence {n,} as follows:

Let n, be the smallest positive integer such that x,,¢€ £. Having
chosen 1,,...,%,-1 (kK = 2, 3, 4, ...), let m, be the smallest integer greater
than n,_, such that x,, € E.

Putting f(k) = x,, (k = 1, 2, 3, ...), we obtain a 1-1 correspondence
between E and J.

The theorem shows that, roughly speaking, countable sets represent
the ‘‘smallest’’ infinity: No uncountable set can be a subset of a countable
set.

2.9 Definition Let A and Q be sets, and suppose that with each element a of
A there is associated a subset of Q which we denote by £,.


--- Page 36 ---

BASIC TOPOLOGY 27

The set whose elements are the sets E, will be denoted by {£,}. Instead
of speaking of sets of sets, we shall sometimes speak of a collection of sets, or
a family of sets.

The union of the sets E, is defined to be the set S such that x e S if and only
if x e E, for at least one « € A. We use the notation

(1) S= UE.

aca

If A consists of the integers 1, 2,..., n, one usually writes

n
(2) S=) En
m= i
or
(3) S=EF,VE,U':'V&,.
If A is the set of all positive integers, the usual notation is
foo)
(4) S= U Em:

The symbol oo in (4) merely indicates that the union of a countable col-
lection of sets is taken, and should not be confused with the symbols +00, — 0,
introduced in Definition 1.23.

The intersection of the sets E, is defined to be the set P such that xe P if
and only if xe E, for every «eA. We use the notation

(5) P=()\E,,
aed
or
n

(6) P=(\)E,=E, NE, a" £,,

m=1
or
(7) P= () Em:

as for unions. If A m Bis not empty, we say that A and B intersect; otherwise
they are disjoint.
2.10 Examples

(a) Suppose E, consists of 1,2,3 and E, consists of 2,3,4. Then
E, vu E, consists of 1, 2, 3, 4, whereas E, 7 E, consists of 2, 3.


--- Page 37 ---

28 PRINCIPLES OF MATHEMATICAL ANALYSIS

(b) Let A be the set of real numbers x such that 0<x< 1. For every
x eA, let E, be the set of real numbers y such that 0 <y <x. Then

(i) E, < E, if and only ifO<x<z<1;
xeA

(iii) () E, is empty;
xeA

(i) and (ii) are clear. To prove (iii), we note that for every y > 0, y ¢ E,
ifx<y. Hence y€¢(), 4 2,-

2.11 Remarks Many properties of unions and intersections are quite similar
to those of sums and products; in fact, the words sum and product were some-
times used in this connection, and the symbols 2 and II were written in place

of () and ().

The commutative and associative laws are trivial:

(8) AUB=BUA; ANB=BNA.
9) (AVBUC=AU(BUC); (AN BNC=AN(BNC).

Thus the omission of parentheses in (3) and (6) is justified.
The distributive law also holds:

(10) AN(BUC) =(ANB)U(ANC).

To prove this, let the left and right members of (10) be denoted by E and F,
respectively.

Suppose xe E. Then xe A and xe BUC, that is, x e B or x Ee C (pos-
sibly both), Hence xe An Bor xe ANC, so thatxe F. Thus Ec F.

Next, suppose xe F. Then xe An Bor xe ANC. That is, xe A, and
xeEBucC. HencexeAn(BuC), so that Fc E.

It follows that E = F.

We list a few more relations which are easily verified:

(11) AcAUB,

(12) ANBcCA.,

If 0 denotes the empty set, then

(13) AV0=A4, AnO0=0.
If A < B, then

(14) AUB=B, ANB=A.


--- Page 38 ---

BASIC TOPOLOGY 29

2.12 Theorem Let {E,},n =1, 2,3,..., be a sequence of countable sets, and put

(15) S=UE,.
n=1
Then S is countable.

Proof Let every set E, be arranged in a sequence {x,,}, k = 1, 2, 3,...,
and consider the infinite array

(16)

in which the elements of Z, form the nth row. The array contains all
elements of S. As indicated by the arrows, these elements can be
arranged in a sequence

(17) X15 Kate M125 X315 X22> %135 Lar» %325%235 %14;---

If any two of the sets E, have elements in common, these will appear more
than once in (17). Hence there is a subset T of the set of all positive
integers such that S~T7, which shows that S is at most countable
(Theorem 2.8). Since £, < S, and £, is infinite, S is infinite, and thus
countable.

Corollary Suppose A is at most countable, and, for every «€ A, B, is at most

countable. Put
T= U B,.
aed
Then T is at most countable.

For T is equivalent to a subset of (15).

2.13 Theorem Let A be a countable set, and let B, be the set of all n-tuples
(a,,..., 4,), where a,€ A (kK =1,...,"), and the elements a,,..., a, need not be
distinct. Then B,, is countable.

Proof That B, is countable is evident, since B, = A. Suppose B,_, is
countable (n = 2, 3, 4,...). The elements of B, are of the form

(18) (b, a) (be B,-,, a€ A).

For every fixed b, the set of pairs (b, a) is equivalent to A, and hence
countable. Thus B, is the union of a countable set of countable sets. By
Theorem 2.12, B, is countable.

The theorem follows by induction.


--- Page 39 ---

30 PRINCIPLES OF MATHEMATICAL ANALYSIS

Corollary The set of all rational numbers is countable.

Proof We apply Theorem 2.13, with n = 2, noting that every rational r
is of the form b/a, where a and b are integers. The set of pairs (a, 6), and
therefore the set of fractions b/a, is countable.

In fact, even the set of all algebraic numbers is countable (see Exer-
cise 2).

That not all infinite sets are, however, countable, is shown by the next
theorem.

2.14 Theorem Let A be the set of all sequences whose elements are the digits 0
and 1. This set A is uncountable.
The elements of A are sequences like 1, 0,0, 1,0, 1,1, 1,....

Proof Let £ be a countable subset of A, and let E consist of the se-
quences 51, 52, 53,.... We construct a sequence s as follows. If the nth
digit in s, is 1, we let the nth digit of s be 0, and vice versa. Then the
sequence s differs from every member of E in at least one place; hence
S¢£. But clearly se A, so that E is a proper subset of A.

We have shown that every countable subset of A is a proper subset
of A. It follows that A is uncountable (for otherwise A would be a proper
subset of A, which is absurd).

The idea of the above proof was first used by Cantor, and is called Cantor’s
diagonal process; for, if the sequences s,, 5), 53,... are placed in an array like
(16), it is the elements on the diagonal which are involved in the construction of
the new sequence.

Readers who are familiar with the binary representation of the real
numbers (base 2 instead of 10) will notice that Theorem 2.14 implies that the
set of all real numbers is uncountable. We shall give a second proof of this
fact in Theorem 2.43.

METRIC SPACES

2.15 Definition A set X, whose elements we shall call points, is said to be a
metric space if with any two points p and q of X there is associated a real
number d(p, q), called the distance from p to q, such that

(a) d(p,q)>0if p #4; dp, p) =9;

(6) dp.q) = dq, p);

(c) dp,q) < dp,r) + d(r,q), for any re X.

Any function with these three properties is called a distance function, or
a metric.


--- Page 40 ---

BASIC TOPOLOGY 31

2.16 Examples The most important examples of metric spaces, from our
standpoint, are the euclidean spaces R*, especially R! (the real line) and R? (the
complex plane); the distance in R* is defined by

(19) d(x,y)=|x—-y| (x, ye R¥).

By Theorem 1,37, the conditions of Definition 2.15 are satisfied by (19).

It is important to observe that every subset Y of a metric space X is a metric
space in its own right, with the same distance function. For it is clear that if
conditions (a) to (c) of Definition 2.15 hold for p, g, re X, they also hold if we
restrict p,q, r to lie in Y.

Thus every subset of a euclidean space is a metric space. Other examples
are the spaces @(K) and ¥7(u), which are discussed in Chaps. 7 and 11, respec-
tively.

2.17 Definition By the segment (a, b) we mean the set of all real numbers x
such thata<x <b.

By the interval [a,b] we mean the set of all real numbers x such that
a<x<b.

Occasionally we shall also encounter “‘half-open intervals’ [a, b) and (a, 5);
the first consists of all x such that a< x <b, the second of all x such that
a<x<b.

Ifa; < b; fori =1,..., k, the set of all points x = (x,,..., x,) in R* whose
coordinates satisfy the inequalities a,;< x; < b;(1 <i<k) is called a k-cell.
Thus a I-cell is an interval, a 2-cell is a rectangle, etc.

If x e R* and r > 0, the open (or closed) ball B with center at x and radius r
is defined to be the set of all y e R* such that |y —x|<r(or |y—x| <7).

We call a set Ec R* convex if

Ax+(l~—AjyeE

whenever xe E,ye FE, andO<A<1.
For example, balls are convex. For if |y-—x| <r, |z—x| <r, and
0<1< 1, we have

|Ay + (1 — Az — x] = [Ay -x) + (1 - Az —-x)|
<Aly-x|+(l-JA|z—x] <Aar+(1-Ar

=r

The same proof applies to closed balls. It is also easy to see that k-cells are
convex.


--- Page 41 ---

32 PRINCIPLES OF MATHEMATICAL ANALYSIS

2.18 Definition Let X be a metric space. All points and sets mentioned below
are understood to be elements and subsets of X.

(2)
(5)
()

(d)
(e)

(f/)
(9)

(A)

A neighborhood of p is a set N,(p) consisting of all g such that
d(p, q) <r, for some r > 0, The number r is called the radius of N,(p).
A point p is a limit point of the set E if every neighborhood of p
contains a point q # p such that ge E£.

If pe E and p is not a limit point of E, then p is called an isolated
point of E.

E is closed if every limit point of E is a point of E.

A point p is an interior point of EF if there is a neighborhood N of p
such that N c E.

E is open if every point of E is an interior point of E.

The complement of E (denoted by E°) is the set of all points pe X
such that p¢ E.

E is perfect if E is closed and if every point of E is a limit point
of E.

(i) Eis bounded if there is a real number M and a point g € X such that

GV)

d(p, q) < M for all pe E.
E is dense in X if every point of X is a limit point of E, or a point of
E (or both).

Let us note that in R' neighborhoods are segments, whereas in R? neigh-
borhoods are interiors of circles.

2.19 Theorem Every neighborhood is an open set.

Proof Consider a neighborhood E =N,(p), and let g be any point of E.
Then there is a positive real number / such that

d(p,q)=r—h.

For all points s such that d(g, s) <4, we have then

d(p,s) < d(p,q)+dq,s)<r—-ht+h=r,

so that se E. Thus g is an interior point of FE.

2.20 Theorem If p is a limit point of a set E, then every neighborhood of p
contains infinitely many points of E.

Proof Suppose there is a neighborhood N of p which contains only a
finite number of points of E. Let g,,...,q, be those points of Nn E,
which are distinct from p, and put

r= min d(p, dn)

ismsn


--- Page 42 ---

BASIC TOPOLOGY 33

[we use this notation to denote the smallest of the numbers d(p, q;), ...,
d(p, q,)]. The minimum of a finite set of positive numbers is clearly posi-
tive, so that r > 0.

The neighborhood N,(p) contains no point g of E such that gq # p,
so that p is not a limit point of E. This contradiction establishes the
theorem.

Corollary A finite point set has no limit points.

2.21 Examples Let us consider the following subsets of R?:

(a) The set of all complex z such that |z| <1.

(6) The set of all complex z such that |z| < 1.

(c) A nonempty finite set.

(d) The set of all integers.

(e) The set consisting of the numbers 1/n (n = 1, 2, 3,...). Let us note
that this set E has a limit point (namely, z = 0) but that no point of E is
a limit point of E; we wish to stress the difference between having a limit
point and containing one.

(f) The set of all complex numbers (that is, R?).

(g) The segment (a, 5).

Let us note that (@), (e), (g) can be regarded also as subsets of R'.
Some properties of these sets are tabulated below:

Closed Open Perfect Bounded

(a) No Yes No Yes
(6) Yes No Yes Yes
(c) Yes No No Yes
(@) Yes No No No
(e) No No No Yes
(f) Yes Yes Yes No
(9) No No Yes

In (g), we left the second entry blank. The reason is that the segment
(a, b) is not open if we regard it as a subset of R?, but it is an open subset of R'.
2.22 Theorem Let {E,} be a (finite or infinite) collection of sets Ey. Then
(20) (U E.)° = () (E>).

Proof Let A and B be the left and right members of (20). If x € A, then

x¢U,. £,, hence x ¢ E, for any a, hence x e Ef for every a, so that x e() E<.
Thus A c B.


--- Page 43 ---

34 PRINCIPLES OF MATHEMATICAL ANALYSIS

Conversely, if x e B, then x € Ej for every «, hence x ¢ E, for any a,
hence x ¢U, E,, so that xe ((, E,)°. Thus Bc A.
It follows that A = B.

2.23 Theorem A set E is open if and only if its complement is closed.

Proof First, suppose E‘ is closed. Choose xe E. Then x ¢ E°, and x is
not a limit point of E°. Hence there exists a neighborhood N of x such
that E° N is empty, that is, N c E. Thus x is an interior point of E,
and E is open.

Next, suppose E is open. Let x be a limit point of E*. Then every
neighborhood of x contains a point of E*, so that x is not an interior point
of £. Since E is open, this means that x € E°. It follows that E° is closed.

Corollary A set F is closed if and only if its complement is open.

2.24 Theorem

(21)

(a) For any collection {G,} of open sets, J, G, is open.

(b) For any collection {F,} of closed sets, (\_ F, is closed.

(c) For any finite collection G,, ..., G,, of open sets, (Via, G, is open.
(d) For any finite collection F,,..., F, of closed sets, J?., F, is closed.

Proof Put G=l),G,. If xeG, then x eG, for some a. Since x is an
interior point of G,, x is also an interior point of G, and G is open. This
proves (a).

By Theorem 2.22,

(ry yer.

and F; is open, by Theorem 2.23. Hence (a) implies that (21) is open so
that (), F, is closed.
Next, put H = (\f., G,. For any xe H, there exist neighborhoods
N, of x, with radii r,, such that N,;c G,;(i=1,...,”). Put
r=min (ry, ..-5 Tn)s

and let N be the neighborhood of x of radius r. Then N <G;, fori =1,
...,”, 80 that N c H, and H is open.
By taking complements, (d) follows from (c):

(U F) ~ Qe.


--- Page 44 ---

BASIC TOPOLOGY 35

2.25 Examples In parts (c) and (d) of the preceding theorem, the finiteness of
11
the collections is essential. For let G,, be the segment (- a ‘) (n = 1, 2,3,...).

Then G, is an open subset of R!. Put G = (\°_, G,. Then G consists of a single
point (namely, x = 0) and is therefore not an open subset of R’.

Thus the intersection of an infinite collection of open sets need not be open.
Similarly, the union of an infinite collection of closed sets need not be closed.

2.26 Definition If X is a metric space, if E < X, and if E’ denotes the set of
all limit points of E in X, then the closure of E is the set E = Eu E’.

2.27 Theorem If X is a metric space and E < X, then

(a) E is closed,
(b) E=E if and only if E is closed,
(c) EF for every closed set F < X such that E c F.

By (a) and (c), E ts the smallest closed subset of X that contains E.

Proof

(a) Ifpe Xand p¢ E then p is neither a point of E nor a limit point of E.
Hence p has a neighborhood which does not intersect E. The complement
of E is therefore open. Hence E is closed.

(b) If E=E, (a) implies that E is closed. If E is closed, then E’ < E
[by Definitions 2.18(d) and 2.26], hence E = E.

(c) If Fis closed and F> E, then F> F’, hence F> E’. Thus F> E.

2.28 Theorem Let E be a nonempty set of real numbers which is bounded above.
Let y =sup E. Thenye E. Hence ye E if E is closed.

Compare this with the examples in Sec. 1.9.

Proof If ye E then ye E. Assume y¢ E. For every 4 > 0 there exists
then a point x e€ E such that y —A <x <_y, for otherwise y — A would be
an upper bound of E. Thus » is a limit point of E. Hence ye E.

2.29 Remark Suppose Ec Y < X, where X is a metric space. To say that E
is an open subset of X means that to each point pe E there is associated a
positive number r such that the conditions d(p,q) < r,q¢X imply that ge E.
But we have already observed (Sec. 2.16) that Y is also a metric space, so that
our definitions may equally well be made within Y. To be quite explicit, let us
say that E is open relative to Y if to each pe E there is associated an r > 0 such
that ge E whenever d(p,q) <r and qe Y. Example 2.21(g) showed that a set


--- Page 45 ---

36 PRINCIPLES OF MATHEMATICAL ANALYSIS

may be open relative to Y without being an open subset of X. However, there
is a simple relation between these concepts, which we now state.

2.30 Theorem Suppose Yc X. A subset E of Y is open relative to Y if and
only if E = Y q G for some open subset G of X.

Proof Suppose E£ is open relative to Y. To each pe E there is a positive
number r, such that the conditions d(p,q)<r,,q¢ Y imply that ge E.
Let V, be the set of all g ¢ XY such that d(p, 7) <r,, and define
G=\V,.
peE

Then G is an open subset of X, by Theorems 2.19 and 2.24.

Since p € V, for all pe E, it is clear that Ec Gn Y.

By our choice of V,, we have V, 7 Yc E for every pe E, so that
GoYcE. Thus E=Gno Y, and one half of the theorem is proved.

Conversely, if G is open in Y¥ and E=Gno Y, every pe E has a
neighborhood V, < G. Then V, mn Yc E, so that E is open relative to Y.

COMPACT SETS

2.31 Definition By an open cover of a set E in a metric space X we mean a
collection {G,} of open subsets of X such that Ec U, G,.

2.32 Definition A subset K of a metric space X is said to be compact if every
open cover of K contains a finite subcover.

More explicitly, the requirement is that if {G,} is an open cover of K, then
there are finitely many indices «,,..., a, such that

KceG, ui uG,.

The notion of compactness is of great importance in analysis, especially
in connection with continuity (Chap. 4).

It is clear that every finite set is compact. The existence of a large class of
infinite compact sets in R* will follow from Theorem 2.41.

We observed earlier (in Sec. 2.29) that if Ec Yc X, then E may be open
relative to Y without being open relative to Y. The property of being open thus
depends on the space in which E is embedded. The same is true of the property
of being closed.

Compactness, however, behaves better, as we shall now see. To formu-
late the next theorem, let us say, temporarily, that K is compact relative to X if
the requirements of Definition 2.32 are met.


--- Page 46 ---

2.33

BASIC TOPOLOGY 37

Theorem Suppose K < Yc X. Then K is compact relative to X if and

only if K is compact relative to Y.

By virtue of this theorem we are able, in many situations, to regard com-

pact sets as metric spaces in their own right, without paying any attention to
any embedding space. In particular, although it makes little sense to talk of
open spaces, or of closed spaces (every metric space X is an open subset of itself,
and is aclosed subset of itself), it does make sense to talk of compact metric
spaces.

(22)

(23)

2.34

2.35

Proof Suppose K is compact relative to X, and let {V,} be a collection
of sets, open relative to Y, such that Kc U), V,. By theorem 2.30, there
are sets G,, open relative to X, such that V, = Y 1 G,, for all «; and since
K is compact relative to X, we have

KcG,, U'''U Gy,

for some choice of finitely many indices a,,...,%,. Since Kc Y, (22)
implies
KcV,, UU,

This proves that K is compact relative to Y.

Conversely, suppose K is compact relative to Y, let {G,} be a col-
lection of open subsets of X which covers K, and put V, = YnG,. Then
(23) will hold for some choice of o,,...,%,; and since V,c G,, (23)
implies (22).

This completes the proof.

Theorem Compact subsets of metric spaces are closed.

Proof Let K be a compact subset of a metric space X. We shall prove
that the complement of K is an open subset of X.

Suppose pe X, p¢ K. If qe K, let V, and W, be neighborhoods of p
and gq, respectively, of radius less than 4d(p, q) [see Definition 2.18(a)].
Since K is compact, there are finitely many points q,,..., 9, in K such that

KW, UUW, = W.

IfV=aV,, n°: V,,, then V is a neighborhood of p which does not
intersect W. Hence V c K°, so that p is an interior point of K°. The
theorem follows.

Theorem Closed subsets of compact sets are compact.

Proof Suppose Fc K < X, Fis closed (relative to X), and K is compact.
Let {V,} be an open cover of F. If F° is adjoined to {V,}, we obtain an


--- Page 47 ---

38 PRINCIPLES OF MATHEMATICAL ANALYSIS

open cover 2 of K. Since K is compact, there is a finite subcollection ®
of QO which covers K, and hence F. If F° is a member of ®, we may remove
it from ® and still retain an open cover of F. We have thus shown that a
finite subcollection of {V,} covers F.

Corollary If F is closed and K is compact, then F 7 K is compact.

Proof Theorems 2.24(b) and 2.34 show that Fo K is closed; since
Fo KCK, Theorem 2.35 shows that F n K is compact.

2.36 Theorem If{K,} is a collection of compact subsets of a metric space X such
that the intersection of every finite subcollection of {K,} is nonempty, then (\ K,
is nonempty.

Proof Fix a member K, of {K,} and put G, = K£. Assume that no point
of K, belongs to every K,. Then the sets G, form an open cover of K;;
and since K, is compact, there are finitely many indices «,,..., 0, such
that K, ¢ G,, U-*: U G,,. But this means that

Ky 0 Ky, °° 0 Ka,

is empty, in contradiction to our hypothesis.

Corollary If {K,} is a sequence of nonempty compact sets such that K, > Ky+1
(n =1, 2, 3,...), then(\? K,, is not empty.

2.37 Theorem [If E is an infinite subset of a compact set K, then E has a limit
point in K.

Proof If no point of K were a limit point of E, then each ge K would
have a neighborhood V, which contains at most one point of E (namely,
q, if ge £). It is clear that no finite subcollection of {V,} can cover E;
and the same is true of K, since E < K. This contradicts the compactness
of K.

2.38 Theorem If {J,} is a sequence of intervals in R', such that 1, > 1,41
(n =1, 2, 3,...), then (\f I, is not empty.

Proof If J, = {a,, 5,], let E be the set of all a,. Then E is nonempty and
bounded above (by 5,). Let x be the sup of FE. If m and n are positive
integers, then

a, s an+n s Dn+n <b,»

so that x < b,, for each m. Since it is obvious that a,, <x, we see that
x él, form =1, 2,3,....


--- Page 48 ---

2.39

BASIC TOPOLOGY 39

Theorem Let k be a positive integer. If {I,} is a sequence of k-cells such

that I, > I,4,(n = 1, 2, 3, ...), then (\P I, is not empty.

2.40

Proof Let J, consist of all points x = (x,,..., x,) such that
Gj SX; Sd,; (<j<sk;n=1, 2, 3,...),

and put /,; =[a,,;,5,,;]. For each j, the sequence {/, ;} satisfies the
hypotheses of Theorem 2.38. Hence there are real numbers x7(1 <j < k)
such that

a,;Sx7 <b,, (lsjsk;n=1,2,3,...).

Setting x* =(x7,..., xf), we see that x*eJ, for n =1,2,3,.... The
theorem follows.

Theorem Every k-cell is compact.

Proof Let J be a k-cell, consisting of all points x =(x,, ..., x,) such
that a, <x; <b; (1<j<k). Put

Then |x—y| <6, ifxeLyel

Suppose, to get a contradiction, that there exists an open cover {G,}
of I which contains no finite subcover of J. Put c; =(a;+,)/2. The
intervals [a,, c;] and [c,, b,] then determine 2" k-cells Q; whose union is J.
At least one of these sets Q,, call it 7,, cannot be covered by any finite
subcollection of {G,} (otherwise J could be so covered). We next subdivide
I, and continue the process. We obtain a sequence {J,} with the following
properties:

(2) 1>151,2>1;5°°°;
(6) 1, is not covered by any finite subcollection of {G,};
(c) ifxe/,andyel,, then |x—y| <27"6.

By (a) and Theorem 2.39, there is a point x* which lies in every J,.
For some a,x*eG,. Since G, is open, there exists r>0O such that
ly —x*| <r implies that yeG,. If 7 is so large that 27"6 <r (there is
such an n, for otherwise 2” < 6/r for all positive integers n, which is
absurd since R is archimedean), then (c) implies that J, < G,, which con-
tradicts (6).

This completes the proof.

The equivalence of (a) and (6) in the next theorem is known as the Heine-

Borel theorem.


--- Page 49 ---

40 PRINCIPLES OF MATHEMATICAL ANALYSIS

2.41 Theorem [fa set E in R* has one of the following three properties, then it
has the other two.

(a) Eis closed and bounded.
(6) Eis compact.
(c) Every infinite subset of E has a limit point in E.

Proof If (a) holds, then E < J for some k-cell J, and (6) follows from
Theorems 2.40 and 2.35. Theorem 2.37 shows that (6) implies (c). It
remains to be shown that (c) implies (a).

If E is not bounded, then E contains points x, with

|x,,; >” (n=1,2,3,...).

The set S consisting of these points x, is infinite and clearly has no limit
point in R*, hence has none in E. Thus (c) implies that E is bounded.

If E is not closed, then there is a point x) € R* which is a limit point
of E but not a point of E. For n =1, 2,3,..., there are points x,¢E
such that |x, — X9| <1/n. Let S be the set of these points x,. Then S is
infinite (otherwise |x, — Xx )| would have a constant positive value, for
infinitely many 7), S has xo as a limit point, and S has no other limit
point in R*, For if ye R*,y # xp, then

IX, -¥| = [Xo —y| — |x, — Xo]
> [xo -y| —22 2 |x —y|
2 |Xo—Yy n=! *o y

for all but finitely many 1; this shows that y is not a limit point of 5
(Theorem 2.20).
Thus S has no limit point in E; hence E must be closed if (c) holds.

We should remark, at this point, that (b) and (c) are equivalent in any
metric space (Exercise 26) but that (a) does not, in general, imply (6) and (c).
Examples are furnished by Exercise 16 and by the space 7, which is dis-
cussed in Chap. 11.

2.42 Theorem (Weierstrass) Every bounded infinite subset of R* has a limit
point in R*.

Proof Being bounded, the set E in question is a subset of a k-cell Jc R*.
By Theorem 2.40, J is compact, and so E has a limit point in J, by
Theorem 2.37.


--- Page 50 ---

BASIC TOPOLOGY 41

PERFECT SETS

2.43 Theorem Let P be a nonempty perfect set in R*. Then P is uncountable.

Proof Since P has limit points, P must be infinite. Suppose P is count-
able, and denote the points of P by x,, X,, X3,.... We shall construct a
sequence {V,} of neighborhoods, as follows.

Let V, be any neighborhood of x,. If V, consists of all y ¢ R* such
that |y — x,| <r, the closure V, of V, is the set of all ye R* such that
ly —x,| Sr.

Suppose V,, has been constructed, so that V, ~ P is not empty. Since
every point of P is a limit point of P, there is a neighborhood V,,, such
that (i) Vis, cV,, (ii) x, & Vas, (iii) Via, A P is not empty. By (iii),
V,41 satisfies our induction hypothesis, and the construction can proceed.

Put K, = V,o P. Since V, is closed and bounded, V, is compact.
Since x, ¢ K,4,, no point of P lies in (\P K,. Since K, ¢ P, this implies
that (\ K, is empty. But each K, is nonempty, by (iii), and K, > K,+1,
by (i); this contradicts the Corollary to Theorem 2.36.

Corollary Every interval [a, b] (a <b) is uncountable. In particular, the set of
all real numbers is uncountable.

2.44 The Cantor set The set which we are now going to construct shows
that there exist perfect sets in R' which contain no segment.

Let Ey be the interval [0, 1]. Remove the segment (4, 4), and let E, be
the union of the intervals

(0, 4] [4 1].
Remove the middie thirds of these intervals, and let E, be the union of the
intervals
(0, $1, [. 31 [S, 3] (5, 1.

Continuing in this way, we obtain a sequence of compact sets E,, such that

(a) E, 2 E,>2£,>°°';
(b) E,, is the union of 2" intervals, each of length 3~".

The set

is called the Cantor set. P is clearly compact, and Theorem 2.36 shows that P
is not empty.


--- Page 51 ---

42. PRINCIPLES OF MATHEMATICAL ANALYSIS

No segment of the form
(= +1 3k+ *)

3m 7 3m

where k and m are positive integers, has a point in common with P. Since every
segment (a, 8) contains a segment of the form (24), if

p-«
6

(24)

37" < ’
P contains no segment.

To show that P is perfect, it is enough to show that P contains no isolated
point. Let x e P, and let S be any segment containing x. Let J, be that interval
of E, which contains x. Choose n large enough, so that J, << S. Let x, be an
endpoint of J,, such that x, # x.

It follows from the construction of P that x,¢P. Hence x is a limit point
of P, and P is perfect.

One of the most interesting properties of the Cantor set is that it provides
us with an example of an uncountable set of measure zero (the concept of
measure will be discussed in Chap. 11).

CONNECTED SETS

2.45 Definition Two subsets A and B of a metric space X are said to be
separated if both An B and Ar B are empty, i.e., if no point of A lies in the
closure of B and no point of B lies in the closure of A.

A set Ec X is said to be connected if E is not a union of two nonempty
separated sets.

2.46 Remark Separated sets are of course disjoint, but disjoint sets need not
be separated. For example, the interval [0,1] and the segment (1, 2) are not
separated, since 1 is a limit point of (1, 2). However, the segments (0, 1) and
(1, 2) are separated.

The connected subsets of the line have a particularly simple structure:

2.47 Theorem A subset E of the real line R' is connected if and only if it has the
following property: Ifxe E, ye E, andx <z<y, then Zé E.

Proof If there exist x e E, ye E, and some Zé (x, y) such that z ¢ Z, then
E=A,v B, where

A, = EO (-©, 2), BL =Ea (2, 0).


--- Page 52 ---

BASIC TOPOLOGY 43

Since x € A, and ye B,, A and Bare nonempty. Since A, < (— 0, z) and
B, < (z, 00), they are separated. Hence E is not connected.

To prove the converse, suppose E is not connected. Then there are
nonempty separated sets A and Bsuch that AU B=E. Pick xe A, ye B,
and assume (without loss of generality) that x < y. Define

z=sup (An [x, y)).

By Theorem 2.28, ze A; hence z¢ B. In particular, x <z<y.

If z ¢ A, it follows thatx<z<yandz¢E.

If ze A, then z¢ B, hence there exists z, such that z<z, <y and
z,¢B. Thenx<z, <yandz, €E£.

EXERCISES
1. Prove that the empty set is a subset of every set.
2. A complex number z is said to be algebraic if there are integers ao, ..., dn, not all
zero, such that
AozZ™ + az tte stan yzta,=0.
Prove that the set of all algebraic numbers is countable. Hint: For every positive
integer N there are only finitely many equations with
n+ |aol + la) +--+ lal =N.
3. Prove that there exist real numbers which are not algebraic.
4. Is the set of all irrational real numbers countable?
5. Construct a bounded set of real numbers with exactly three limit points.

Let E’ be the set of alf limit points of a set FE. Prove that E’ is closed. Prove that
E and EF have the same limit points. (Recall that E = EU E’.) Do Eand E’ always
have the same limit points?

. Let Ai, A2, A3,... be subsets of a metric space.

(a) If By = (fa: Ai, prove that B, = ()?., A:, for n= 1, 2, 3,....
(6) If B= 1 Ai, prove that B> U1 4).
Show, by an example, that this inclusion can be proper.

. Is every point of every open set E< R? a limit point of E? Answer the same

question for closed sets in R?.

Let E° denote the set of all interior points of a set E. [See Definition 2.18(e);
E® is called the interior of E.)

(a) Prove that E° is always open.

(b) Prove that E is open if and only if E° = E.

(c) If G < Zand G is open, prove that G < E°.

(d) Prove that the complement of E° is the closure of the complement of E.

(e) Do Eand E always have the same interiors ?

(f) Do E and E° always have the same closures?


--- Page 53 ---

44

10.

11.

12.

13.
14.

15.

16.

17.

18.
19.

20.

21.

PRINCIPLES OF MATHEMATICAL ANALYSIS

Let X be an infinite set. For p ¢ X and g ¢ X, define

1 (ifp#q)
0 (if p =@q).
Prove that this is a metric. Which subsets of the resulting metric space are open?
Which are closed? Which are compact?
For x é R' and yé R’, define
d,(x, y) = (x— y)?,
d(x, y) = V|x— yl,
d3(x, y) =|x? — y?|,
d,(x, y) =|x — 2y|,
|x—y|
1+|{x—y]°

ds(x, y) =

Determine, for each of these, whether it is a metric or not.

Let K < R' consist of 0 and the numbers 1/n, for n =1, 2,3,.... Prove that Kis
compact directly from the definition (without using the Heine-Borel theorem).
Construct a compact set of real numbers whose limit points form a countable set.
Give an example of an open cover of the segment (0, 1) which has no finite sub-
cover.

Show that Theorem 2.36 and its Corollary become false (in R', for example) if the
word “compact” is replaced by “‘closed” or by “bounded.”

Regard Q, the set of all rational numbers, as a metric space, with d(p, g) =|p — q|.
Let E be the set of all pe Q such that 2<p? <3. Show that E is closed and
bounded in Q, but that F is not compact. Is E open in Q?

Let E be the set of all x € [0, 1] whose decimal expansion contains only the digits
4 and 7. Is E countable? Is E dense in [0,1]? Is Ecompact? Is E perfect?

Is there a nonempty perfect set in R'! which contains no rational number?

(a) If A and B are disjoint closed sets in some metric space X, prove that they
are separated.

(b) Prove the same for disjoint open sets.

(c) Fix p € X, 8 > 0, define A to be the set of all ¢ ¢ X for which d(p, q) < 5, define
B similarly, with > in place of <. Prove that A and B are separated.

(d) Prove that every connected metric space with at least two points is uncount-
able. Hint: Use (c).

Are closures and interiors of connected sets always connected? (Look at subsets
of R?.)

Let A and B be separated subsets of some R*, suppose a € A, b & B, and define

p(t) = (1 — Nat tb
for te R', Put Ao = p-'(A), Bo =p 1(B). [Thus fe Ao if and only if p(t) A.]


--- Page 54 ---

23

24,

25

26

27,

28.

29,

BASIC TOPOLOGY 45

(a) Prove that Ao and Bo are separated subsets of R’.
(6) Prove that there exists fo € (0, 1) such that p(to) ¢ 4 U B.
(c) Prove that every convex subset of R* is connected.

. A metric space is called separable if it contains a countable dense subset. Show

that R* is separable. Hint: Consider the set of points which have only rational
coordinates.

A collection {V,} of open subsets of Y is said to be a base for X if the following
is true: For every x¢ X and every open set Go X such that x¢G, we have
xéV,<G for some «. In other words, every open set in X is the union of a
subcollection of {V,}.

Prove that every separable metric space has a countable base. Hint: Take

all neighborhoods with rational radius and center in some countable dense subset
of X.
Let X be a metric space in which every infinite subset has a limit point. Prove that
X is separable. Hint: Fix 6 >0, and pick x; ¢ X. Having chosen x1,..., x, eX,
choose x;., € X, if possible, so that d(x;, X41) > 6 for i=1,...,/. Show that
this process must stop after a finite number of steps, and that X can therefore be
covered by finitely many neighborhoods of radius §. Take § = 1/n (a = 1, 2, 3,...),
and consider the centers of the corresponding neighborhoods.

Prove that every compact metric space K has a countable base, and that K is
therefore separable. Hint: For every positive integer ~, there are finitely many
neighborhoods of radius 1/n whose union covers K.

Let X be a metric space in which every infinite subset has a limit point. Prove
that X is compact. Aint: By Exercises 23 and 24, X has a countable base. It
follows that every open cover of X has a countable subcover {G,}, n = 1, 2, 3,....
If no finite subcollection of {G,} covers X, then the complement F, of G, U ++: U Gr
is nonempty for each nv, but () F, is empty. If E is a set which contains a point
from each F,, consider a limit point of E, and obtain a contradiction.

Define a point p in a metric space X to be a condensation point of a set E< X if
every neighborhood of p contains uncountably many points of E.

Suppose E ¢ R*, E is uncountable, and let P be the set of all condensation
points of E. Prove that P is perfect and that at most countably many points of E
are not in P. In other words, show that P° 7 E is at most countable. Hint: Let
{V3} be a countable base of R*, let W be the union of those V,, for which E 7-1 V,
is at most countable, and show that P = W°.

Prove that every closed set in a separable metric space is the union of a (possibly
empty) perfect set and a set which is at most countable. (Corollary: Every count-
able closed set in R* has isolated points.) Hint: Use Exercise 27.

Prove that every open set in R' is the union of an at most countable collection of
disjoint segments. Hint: Use Exercise 22.


--- Page 55 ---

46 PRINCIPLES OF MATHEMATICAL ANALYSIS

30. Imitate the proof of Theorem 2.43 to obtain the following result:

If R* = ()?F,, where each F, is a closed subset of R*, then at least one F,
has a nonempty interior.

Equivalent statement: If G, is a dense open subset of R*, for n = 1, 2, 3,...,
then ()?G, is not empty (in fact, it is dense in R*).

(This is a special case of Baire’s theorem; see Exercise 22, Chap. 3, for the general
case.)


--- Page 56 ---

3

NUMERICAL SEQUENCES AND SERIES

As the title indicates, this chapter will deal primarily with sequences and series
of complex numbers. The basic facts about convergence, however, are just as
easily explained in a more general setting. The first three sections will therefore
be concerned with sequences in euclidean spaces, or even in metric spaces.

CONVERGENT SEQUENCES

3.1 Definition A sequence {p,} in a metric space X is said to converge if there
is a point p € X with the following property: For every e > 0 there is an integer
N such that n = N implies that d(p,, p) <. (Here d denotes the distance in XY.)

In this case we also say that {p,} converges to p, or that p is the limit of
{p,} [see Theorem 3.2(b)], and we write p, > p, or

lim p, = p.

noo

If {p,} does not converge, it is said to diverge.


--- Page 57 ---

48 PRINCIPLES OF MATHEMATICAL ANALYSIS

It might be well to point out that our definition of ‘‘convergent sequence”’
depends not only on {p,} but also on X; for instance, the sequence {1/n} con-
verges in R’ (to 0), but fails to converge in the set of all positive real numbers
[with d(x, y)=|x—y]]. In cases of possible ambiguity, we can be more
precise and specify ‘“‘convergent in X”’ rather than ‘‘convergent.”’

We recall that the set of all points p, (7 = 1, 2, 3, ...) is the range of {p,}.
The range of a sequence may be a finite set, or it may be infinite. The sequence
{p,} is said to be bounded if its range is bounded.

As examples, consider the following sequences of complex numbers
(that is, X = R?):

(a)
0)
(c)
(d)
(e)

Ifs, = 1/n, then lim,.,. 5, = 0; the range is infinite, and the sequence
is bounded.

If s, =n, the sequence {s,} is unbounded, is divergent, and has
infinite range.

If s, = 1 + ((— 1)"/n], the sequence {s,} converges to 1, is bounded,
and has infinite range.

If s, =i", the sequence {s,} is divergent, is bounded, and has finite
range.

If s, = 1(1 = 1, 2, 3,...), then {s,} converges to 1, is bounded, and
has finite range.

We now summarize some important properties of convergent sequences
in metric spaces.

3.2 Theorem Let {p,} be a sequence in a metric space X.

(a)

(6)
(c)
(2)

{p,} converges to p © X if and only if every neighborhood of p contains
DP, for all but finitely many n.

If p eX, p' € X, and if {p,} converges to p and to p’, then p' =p.

If {p,} converges, then {p,} is bounded.

IfE X and if p is a limit point of E, then there is a sequence {p,} in E
such that p = lim p,.

noo

Proof (a) Suppose p,—p and let V be a neighborhood of p. For
some e>0, the conditions d(q, p)<«,qgeX imply ge V. Correspond-
ing to this ¢, there exists N such that n => N implies d(p,, p)<«. Thus
n= N implies p, € V.

Conversely, suppose every neighborhood of p contains all but

finitely many of the p,. Fix ¢ > 0, and let V be the set of all ¢ e X such
that d(p,q) <.«. By assumption, there exists N (corresponding to this V)
such that p,¢«V if n2>N. Thus d(p,,p)<e if n2=>N; hence p,—p.


--- Page 58 ---

NUMERICAL SEQUENCES AND SERIES 49

(b) Let ¢ >0 be given, There exist integers N, N’ such that

n>N_ implies d(p,,p)< >

n>N' implies d(p,,p’)< :
Hence if n > max (N, N’), we have

Ap, p’) < d(p, py) + A(py, p') <8.

Since ¢ was arbitrary, we conclude that d(p, p’) = 0.
(c) Suppose p,—p. There is an integer N such that n>WN
implies d(p,, p) <1. Put

r= max {1, dp, P)s tees (py , P)}.

Then d(p,, p) <r forn = 1, 2,3,...,.

(d) For each positive integer n, there is a point p, ¢ E such that
d(p,,p)<i1/n. Given e>0, choose N so that Ne>1. If n>WN, it
follows that d(p,, p)<«. Hence p, > p.

This completes the proof.

For sequences in R* we can study the relation between convergence, on
the one hand, and the algebraic operations on the other. We first consider
sequences of complex numbers.

3.3 Theorem Suppose {s,}, {t,} are complex sequences, and lim,... 5, = 5,
lim, ot, = t. Then
(a) lim(s, + ¢,)=s +65
nao
(6) lim cs, = cs, lim (c + s,) =¢ +5, for any number c;
n~? 00 noo

(c) lims,t, = st;

no

1 1
(d) lim 5 7 Provided s, #0 (n = 1,2, 3,...), and s 40.

n> O Yn
Proof

(a) Given ¢ > 0, there exist integers N,, N2 such that

: . €
n>N, implies Is, —s] <5;

n>N implies |t, —¢] <5"


--- Page 59 ---

50 PRINCIPLES OF MATHEMATICAL ANALYSIS

If N = max (N,, N2), then n > N implies
(Sn +t) —(s+4)| S |5,-s| + |,-t| <2
This proves (a), The proof of (5) is trivial.
(c) We use the identity
(1) Syl, — St = (5, — St, — 1) + s(t, — 2) + t(s, — 5).
Given e > 0, there are integers N,, N2 such that
n>=WN, implies |s,-—s| < Je,
n>N, implies |1t,—-¢t| < /e.
If we take N = max (N,, N2), n = N implies
\(S, — Sit, — 2)| <8,
so that
lim (s, — s)(t, — t) = 0.

We now apply (a) and (8) to (1), and conclude that

lim (s,¢, — st) = 0.

noo

(d) Choosing m such that |s, —s| <4]s| if 72m, we see that

Is] >2]s| Gam).

Given e¢ > 0, there is an integer N > m such that n > N implies
|s, — s| <4|s|7e.

Hence, for n > N,

1 1

5, Ss

a IP 2 \s,-—s| <é
|s|?0" ,

5,5

3.4 Theorem
(a) Suppose x, € R* (n =1, 2, 3,...) and
Xn = (G1 yo ees Chun)
Then {x,} converges to X = (ay, ..., &) if and only if

(2) lim 4), = dad <j<h).

n> 0o


--- Page 60 ---

NUMERICAL SEQUENCES AND SERIES 51

(b) Suppose {x,}, {y,} are sequences in R*, {B,} is a sequence of real numbers,
and Xx, >X,Y, > Y, B, +B. Then

lim (x, + y,) =xt+y, lim x,y, =X°y, lim B,x, = Bx.
nwrew n=O

nw
Proof
(a) Ifx,—x, the inequalities

[jn --4,| < |x, — xl,

which follow immediately from the definition of the norm in R*, show that
(2) holds.

Conversely, if (2) holds, then to each ¢ > 0 there corresponds an
integer N such that n > N implies

é

Jk

[aj, -—o%| < (i<j<k).

Hence n > N implies
k 3 1/2
x1 = [3 baie al?) <e

so that x, -x. This proves (a).
Part (b) follows from (a) and Theorem 3.3.

SUBSEQUENCES

3.5 Definition Given a sequence {p,}, consider a sequence {n,} of positive

integers, such that 1, <n, <n3<-:+:. Then the sequence {p,,} is called a
subsequence of {p,}. If {p,,} converges, its limit is called a subsequential limit
of {p,}-

It is clear that {p,} converges to p if and only if every subsequence of

{p,} converges to p. We leave the details of the proof to the reader.

3.6 Theorem

(a) If {p,} is a sequence in a compact metric space X, then some sub-
sequence of {p,} converges to a point of X.
(b) Every bounded sequence in R* contains a convergent subsequence.


--- Page 61 ---

52 PRINCIPLES OF MATHEMATICAL ANALYSIS

Proof

(a) Let E be the range of {p,}. If £ is finite then there is a p € E and a
sequence {n,} with n, <n, <n; <°:*, such that

Pay = Pa, = °°* =P.
The subsequence {p,,} so obtained converges evidently to p.

If £ is infinite, Theorem 2.37 shows that E has a limit point p € X.
Choose n, so that d(p, p,,) <1. Having chosen ny,..., 1,;-1, we see from
Theorem 2.20 that there is an integer ,>,_, such that d(p, p,,) < 1/i.
Then {p,,} converges to p.

(6) This follows from (a), since Theorem 2.41 implies that every bounded
subset of R* lies in a compact subset of R*.

3.7 Theorem The subsequential limits of a sequence {p,} in a metric space X
form a closed subset of X.

Proof Let E* be the set of all subsequential limits of {p,} and let g be a
limit point of E*. We have to show that q « E*.

Choose n, so that p,,#q. (If no such n, exists, then E* has only
one point, and there is nothing to prove.) Put 6 = d(q, p,,). Suppose
Ny, ...,M,-1 are chosen. Since q is a limit point of E*, there is an x e E*
with d(x,q)<27'5. Since xeE*, there is an n,>1,-, such that
d(x, P,,) < 27'S. Thus

(4, Pp.) S 2°~'5
fori=1,2,3,.... This says that {p,,} converges to g. Hence q € E*.

CAUCHY SEQUENCES

3.8 Definition A sequence {p,} in a metric space X is said to be a Cauchy
sequence if for every e > 0 there is an integer N such that d(p,, p,,) <eifn>=N
and m>N.

In our discussion of Cauchy sequences, as well as in other situations
which will arise later, the following geometric concept will be useful.

3.9 Definition Let £ be a nonempty subset of a metric space X, and let S be
the set of all real numbers of the form d(p,q), with pe E andge£. The sup
of Sis called the diameter of E.


--- Page 62 ---

NUMERICAL SEQUENCES AND SERIES 53

If{p,}is a sequence in X and if Ey consists of the points py, Py+1;PN+25-++>

it is clear from the two preceding definitions that {p,} is a Cauchy sequence
if and only if

3.10

3.11

lim diam Ey = 0.

N- 00
Theorem
(a) If E is the closure of a set E in a metric space X, then
diam E = diam E.
(b) If K, is a sequence of compact sets in X such that K,> Ky+1
(n = 1, 2,3,...) and if

lim diam K, = 0,

n>0
then (\?K, consists of exactly one point.
Proof
(a) Since Ec E, it is clear that
diam E < diam E.
Fix ¢ > 0, and choose p € E,q € E. By the definition of FE, there are
points p’, q’, in E such that d(p, p’) < «, d(q,q') < «. Hence

a(p,q) < Ap, p’) + d(p' q') + dq’, 4)
<2e+d(p',q') <2¢+4 diam E.

It follows that
diam E < 2¢ + diam E£,

and since ¢ was arbitrary, (a) is proved.

(b) Put K=(\?X,. By Theorem 2.36, K is not empty. If K contains
more than one point, then diam K >0. But for each n, K, > K, so that
diam K, > diam K. This contradicts the assumption that diam K, — 0.

Theorem

(a) Inany metric space X, every convergent sequence is a Cauchy sequence.

(b) If X is a compact metric space and if {p,} is a Cauchy sequence in X,
then {p,} converges to some point of X.

(c) In R*, every Cauchy sequence converges.

Note: The difference between the definition of convergence and
the definition of a Cauchy sequence is that the limit is explicitly involved
in the former, but not in the latter. Thus Theorem 3.11(6) may enable us


--- Page 63 ---

54 PRINCIPLES OF MATHEMATICAL ANALYSIS

(3)

to decide whether or not a given sequence converges without knowledge
of the limit to which it may converge.

The fact (contained in Theorem 3.11) that a sequence converges in
R* if and only if it is a Cauchy sequence is usually called the Cauchy
criterion for convergence.

Proof

(a) If p,—p and if ¢>0, there is an integer N such that d(p, p,) < €
for alln => N. Hence

A(Pns Pm) S 4(Pus P) + UP, Pm) < 28

as soon asn >Nandm>N. Thus {p,} is a Cauchy sequence.

(b) Let {p,} be a Cauchy sequence in the compact space X. For
N =1, 2,3, ..., let Ey be the set consisting of py, Py+t, Pyt2>-++>
Then

lim diam Ey = 0,

No
by Definition 3.9 and Theorem 3.10(a). Being a closed subset of the
compact space X, each Ey is compact (Theorem 2.35). Also Ey > Ey4y,
so that Ey > Eys4.

Theorem 3.10(5) shows now that there is a unique p € X which lies
in every Ey.

Let e>0 be given. By (3) there is an integer No such that
diam Ey <e if N>No. Since pe Ey, it follows that d(p,q)<e for
every qe Ey, hence for every gé Ey. In other words, d(p, p,) <e if
n> No. This says precisely that p, — p.

(c) Let {x,} be a Cauchy sequence in R*. Define Ey as in (b), with x,
in place of p;. For some N, diam Ey <1. The range of {x,} is the union
of Ey and the finite set {x,,...,Xy-1}. Hence {x,} is bounded. Since
every bounded subset of R* has compact closure in R* (Theorem 2.41),
(c) follows from (8).

3.12 Definition A metric space in which every Cauchy sequence converges is
said to be complete.

Thus Theorem 3.11 says that all compact metric spaces and all Euclidean

spaces are complete. Theorem 3.11 implies also that every closed subset E of a
complete metric space X is complete. (Every Cauchy sequence in E is a Cauchy
sequence in X, hence it converges to some p € X, and actually p € E since E is
closed.) An example of a metric space which is not complete is the space of all
rational numbers, with d(x, y) = |x — y|.


--- Page 64 ---

NUMERICAL SEQUENCES AND SERIES 55

Theorem 3.2(c) and example (d) of Definition 3.1 show that convergent
sequences are bounded, but that bounded sequences in R* need not converge.
However, there is one important case in which convergence is equivalent to
boundedness; this happens for monotonic sequences in R'.

3.13 Definition A sequence {s,} of real numbers is said to be

(a) monotonically increasing if s, < 5,4, (n = 1, 2, 3, ...)3
(b) monotonically decreasing if 5, > S,+,(n = 1, 2, 3, ...).

The class of monotonic sequences consists of the increasing and the
decreasing sequences,

3.14 Theorem Suppose {s,} is monotonic. Then {s,} converges if and only if it
is bounded.

Proof Suppose s, < 5,,, (the proof is analogous in the other case).
Let E be the range of {s,}. If {s,} is bounded, let s be the least upper
bound of E. Then

Sn ss (n = 1, 2, 3,...).
For every ¢ > 0, there is an integer N such that
S—é<Sy<S,

for otherwise s — e would be an upper bound of E. Since {s,} increases,
n> N therefore implies

S—E<5S,<S5,

which shows that {s,} converges (to s).
The converse follows from Theorem 3.2(c).

UPPER AND LOWER LIMITS

3.15 Definition Let {s,} be a sequence of real numbers with the following
property: For every real M there is an integer N such that n > N implies
5, 2 M. We then write

Sy +0.
Similarly, if for every real M there is an integer N such that n> WN implies
S, < M, we write

S_> —@.


--- Page 65 ---

56 PRINCIPLES OF MATHEMATICAL ANALYSIS

It should be noted that we now use the symbol — (introduced in Defini-
tion 3.1) for certain types of divergent sequences, as well as for convergent
sequences, but that the definitions of convergence and of limit, given in Defini-
tion 3.1, are in no way changed.

3.16 Definition Let {s,} be a sequence of real numbers. Let E be the set of
numbers x (in the extended real number system) such that s,, +x for some
subsequence {5,,}. This set E contains all subsequential limits as defined in
Definition 3.5, plus possibly the numbers +00, — oo.

We now recall Definitions 1.8 and 1.23 and put

s* = sup E,
5, = inf E.

The numbers s*, s, are called the upper and lower limits of {s,}; we use the
notation
lim sup s, = s*, lim inf s, = Sy.
nwo n-> oO
3.17 Theorem Let {s,} be a sequence of real numbers. Let E and s* have the
same meaning as in Definition 3.16. Then s* has the following two properties:

(a) s*eEk.
(b) Ifx>s*, there is an integer N such that n= N implies s, < x.

Moreover, s* is the only number with the properties (a) and (b).

Of course, an analogous result is true for s,.
Proof

(a) Ifs* = +00, then Eis not bounded above; hence {s,} is not bounded
above, and there is a subsequence {s,,} such that s,, + +0.

If s* is real, then E is bounded above, and at least one subsequential
limit exists, so that (a) follows from Theorems 3.7 and 2.28.

If s* = —0oo, then EF contains only one element, namely —0oo, and
there is no subsequential limit. Hence, for any real M, s, > M for at
most a finite number of values of , so that 5, -- — 0.

This establishes (a) in all cases.

(6) Suppose there is a number x >s* such that s, > x for infinitely
many values of n. In that case, there is a number ye £ such that
y =x >s*, contradicting the definition of s*.

Thus s* satisfies (a) and (0).

To show the uniqueness, suppose there are two numbers, p and 4,
which satisfy (a) and (5), and suppose p <q. Choose x such that p < x <4¢.
Since p satisfies (b), we haves, <x forn > N. But theng cannot satisfy (a).


--- Page 66 ---

NUMERICAL SEQUENCES AND SERIES 57

3.18 ‘Examples

(a) Let {s,} be a sequence containing all rationals. Then every real
number is a subsequential limit, and

lim sup s, = +00, lim inf s, = — 00.
noo noo
(b) Let s, =(—1")/[1 + (1/n)]. Then
lim sup s, = 1, lim inf s, = —1.

(c) Fora real-valued sequence {s,}, lim s, = s if and only if
nwo

lim sup s, = lim inf s, = s.

noo no

We close this section with a theorem which is useful, and whose proof is
quite trivial:

3.19 Theorem /fs, <1, forn = N, where N is fixed, then

lim inf s, < lim inf t,,

nw 0 na

lim sup s, < lim sup f,.

n=? 0 n7>o

SOME SPECIAL SEQUENCES

We shall now compute the limits of some sequences which occur frequently.
The proofs will all be based on the following remark: If 0 < x, <5, forn > N,
where N is some fixed number, and if s, +0, then x, +0.
3.20 Theorem
1
(a) If p> 0, then lim oP =0.
(b) If p>0, then lim 2/p =1.

(c) lim 2/n=1,

n> oO
n*
d) Ifp>O0 and « is real, then lim ——— = 0.
(Z) Ifp>0 and « is rea hm a+ py"

(e) If |x| <1, then lim x" = 0.


--- Page 67 ---

58 PRINCIPLES OF MATHEMATICAL ANALYSIS

Proof

(a) Take n> (1/e)'/?. (Note that the archimedean property of the real
number system is used here.)
(6) If p>1, put x,=2/p—1. Then x,>0, and, by the binomial
theorem,

1+ nx, <(1+-~x,)" =p,
so that

-1
O0<x,<?—.
n

Hence x, +0. If p = 1, (0) is trivial, and if 0 < p < 1, the result is obtained
by taking reciprocals.
(c) Put x, = a/ n—1. Then x, > 0, and, by the binomial theorem,

-—1
n=(14+x,)"> mea.
Hence

0<ms,/2 (n > 2).
n—-1

(d) Let & be an integer such that k > «,k >0. For n> 2k,

nome Mn — 1) —k +1), nipk
(l+p)">@p* = EP

Hence

n* 2*k!
0<——_ < —— n""* n > 2k).
Since « — k <0, n*~* +0, by (a).
(e) Take a = 0 in (a).

SERIES

In the remainder of this chapter, all sequences and series under consideration
will be complex-valued, unless the contrary is explicitly stated. Extensions of
some of the theorems which follow, to series with terms in R*, are mentioned
in Exercise 15.


--- Page 68 ---

NUMERICAL SEQUENCES AND SERIES 59

3.21 Definition Given a sequence {a,}, we use the notation

q
ua (ps9)
n=p
to denote the sum a,+ 4,4, +°'''+4,. With {a,} we associate a sequence

{s,}, where
n

Sn = Yi.
k=1

For {s,} we also use the symbolic expression

a, +a, +43 ++"

or, more concisely,
fo 9]

(4) Lan

n=1
The symbol (4) we call an infinite series, or just a series. The numbers
s, are called the partial sums of the series. If {s,} converges to s, we say that
the series converges, and write

Mes

a, = S.
1

The number s is called the sum of the series; but it should be clearly under-
stood that s is the limit of a sequence of sums, and is not obtained simply by
addition.

If {s,} diverges, the series is said to diverge.

Sometimes, for convenience of notation, we shall consider series of the
form

(5)

And frequently, when there is no possible ambiguity, or when the distinction
is immaterial, we shall simply write La, in place of (4) or (5).

It is clear that every theorem about sequences can be stated in terms of
series (putting a, = s,, and a, =5s, —5,-, for a> 1), and vice versa, But it is
nevertheless useful to consider both concepts.

The Cauchy criterion (Theorem 3.11) can be restated in the following
form:

Ms

On.

n=0

3.22 Theorem a, converges if and only if for every & > 0 there is an integer
N such that

(6)
ifmoan2>N.

ya

k=n

<6



--- Page 69 ---

60 PRINCIPLES OF MATHEMATICAL ANALYSIS

In particular, by taking m =n, (6) becomes
la,)<@ (n2N).
In other words:

3.23 Theorem Jf 2a, converges, then lim,... 4, = 0.

The condition a, +0 is not, however, sufficient to ensure convergence
of Xa,. For instance, the series

n=1N
diverges; for the proof we refer to Theorem 3.28.

Theorem 3.14, concerning monotonic sequences, also has an immediate
counterpart for series.

3.24 Theorem A series of nonnegative’ terms converges if and only if its
partial sums form a bounded sequence.

We now turn to a convergence test of a different nature, the so-called
‘“‘comparison test.”
3.25 Theorem

(a) If |a,| <c, forn >No, where No is some fixed integer, and if Xc,
converges, then La, converges.
(6) Ifa,>d,>0 forn > No, and if Xd, diverges, then La, diverges.

Note that (6) applies only to series of nonnegative terms a, .
Proof Given ¢ > 0, there exists N > No such that m >n > N implies

m
> Ch SE,

k=n

by the Cauchy criterion. Hence

m
y%
k

m m
<YVlals dase,
k=n Ken

and (a) follows.
Next, (b) follows from (a), for if Za, converges, so must Xd, [note
that (4) also follows from Theorem 3.24].

1 The expression ‘‘ nonnegative’’ always refers to real numbers,


--- Page 70 ---

NUMERICAL SEQUENCES AND SERIES 61

The comparison test is a very useful one; to use it efficiently, we have to
become familiar with a number of series of nonnegative terms whose conver-
gence or divergence is known.

SERIES OF NONNEGATIVE TERMS

The simplest of all is perhaps the geometric series.

3.26 Theorem Jf0<x <1, then

—_

Ms
x
=
il
an

3
tt
f=]

If x > 1, the series diverges.

Proof If x #1,
n 1— xntt
Ss, = xk =
" py 1-x
The result follows if we let n + 0c. For x = 1, we get
L+14+14-:-,

which evidently diverges.

In many cases which occur in applications, the terms of the series decrease
monotonically. The following theorem of Cauchy is therefore of particular
interest. The striking feature of the theorem is that a rather “‘thin’’ subsequence
of {a,} determines the convergence or divergence of Za,.

3.27. Theorem Suppose a, >a, >a3>°': 20. Then the series )7., a, con-
verges if and only if the series

(7) Y 2Magn = a, + 2a, + 4a, + 8ag +°°°
k=0

converges.

Proof By Theorem 3.24, it suffices to consider boundedness of the
partial sums. Let

Sy
ty

ay +a,+°°'+4,,
Q, + 2a, + +++ + Dann.


--- Page 71 ---

62 PRINCIPLES OF MATHEMATICAL ANALYSIS

(8)

(9)

3.28

3.29

(10)

For n < 2*,
Sy Say + (Gz + 3) +055 + Gye +0 8* + Gyert-1)
Sa, + 2a, +++ + Day
= ts

so that
Sy S ty.

On the other hand, if n > 2*,
Sy 2 Ay + Gz + (G3 + 4) $8 + Gau-144 +57" + Gye)
> 4a, +a, + 2a, t¢°° + 2" 1a,
= 4tt,,
so that
2Sy 2 tye

By (8) and (9), the sequences {s,} and {t,} are either both bounded
ot both unbounded. This completes the proof.

]
Theorem ) — converges if p > 1 and diverges if p <1.
nP

Proof If p<0, divergence follows from Theorem 3.23. If p> 0,
Theorem 3.27 is applicable, and we are led to the series
Qk ms y QU pk

k =
2°? =o

=
il
ims

Now, 2'~? <1 if and only if 1 — p <0, and the result follows by com-
parison with the geometric series (take x = 2'~? in Theorem 3.26).
As a further application of Theorem 3.27, we prove:

Theorem I[fp> 1,
0 1
n=2 (log n)?

converges; if p <1, the series diverges.

Remark ‘‘log n’’ denotes the logarithm of to the base e (compare Exercise 7,
Chap. 1); the number e will be defined in a moment (see Definition 3.30). We
let the series start with n = 2, since log | = 0.


--- Page 72 ---

NUMERICAL SEQUENCES AND SERIES 63

Proof The monotonicity of the logarithmic function (which will be
discussed in more detail in Chap. 8) implies that {log n} increases. Hence
{I/n log n} decreases, and we can apply Theorem 3.27 to (10); this
leads us to the series

% 1 0 1 1 o |
11 ok —_— = —_—_—_—_— _—,
(11) 2, 2*(log 2")? £4 (kK log 2)? (log 2)? Py kp

and Theorem 3.29 follows from Theorem 3.28.

This procedure may evidently be continued. For instance,

cs 1
] ———
(12) n=3 log n log logn

diverges, whereas

0 1
| —
(13) » n log n(log log n)?
converges.

We may now observe that the terms of the series (12) differ very little
from those of (13). Still, one diverges, the other converges. If we continue the
process which led us from Theorem 3.28 to Theorem 3.29, and then to (12) and
(13), we get pairs of convergent and divergent series whose terms differ even
less than those of (12) and (13). One might thus be led to the conjecture that
there is a limiting situation of some sort, a “boundary” with all convergent
series on one side, all divergent series on the other side—at least as far as series
with monotonic coefficients are concerned. This notion of “‘boundary” is of
course quite vague. The point we wish to make is this: No matter how we make
this notion precise, the conjecture is false. Exercises 11(6) and 12(6) may serve
as illustrations.

We do not wish to go any deeper into this aspect of convergence theory,
and refer the reader to Knopp’s ‘“‘Theory and Application of Infinite Series,”
Chap. IX, particularly Sec. 41.

THE NUMBER e

2 1
3.30 Definition e = —

nzon!

Here n!=1:'2-+3°-:nifn>1, and 0! =1.


--- Page 73 ---

64 PRINCIPLES OF MATHEMATICAL ANALYSIS

Since

ee
a= 12° 1-2°3 T-2-—n

1 1 1
<Ltltst set t+ iai<3

the series converges, and the definition makes sense. In fact, the series converges
very rapidly and allows us to compute e with great accuracy.

It is of interest to note that e can also be defined by means of another
limit process; the proof provides a good illustration of operations with limits:

i n
3.31 Theorem lim ( +7) =e.

n> oO

Proof Let

By the binomial theorem,

1 1 1 1 2

Hence ¢, <5,, so that
(14) lim sup ¢, <e,

n7o

by Theorem 3.19. Next, if > m,

1 _
wereteb (rena dh (rt) (1-M)),
2! n m! n n

Let n > 0, keeping m fixed. We get

1 1
lim inft, >l+1l+o+4+°::+—,
ee eT
so that
Sm < lim inf t,.
nz oo
Letting m — 00, we finally get
(15) e < lim inf ¢,.
noo

The theorem follows from (14) and (15).


--- Page 74 ---

NUMERICAL SEQUENCES AND SERIES 65

1 .
The rapidity with which the series ) i converges can be estimated as

follows: If s, has the same meaning as above, we have
1 1 1

<— {1+ _— +d=
(n+1)! n+l (n+1) nin
so that
1
(16) O<e-5, <7.

Thus 5,9, for instance, approximates e with an error less than 10°’. The
inequality (16) is of theoretical interest as well, since it enables us to prove the
irrationality of e very easily.

3.32 Theorem e is irrational.

Proof Suppose e is rational. Then e = p/q, where p and q are positive
integers. By (16),

1
(17) 0<qile~s,) <7
By our assumption, g!e is an integer. Since

1 1
diy=ai(l+1 +54 +5)

is an integer, we see that q!(e — s,) is an integer.
Since g = I, (17) implies the existence of an integer between 0 and 1.
We have thus reached a contradiction.

Actually, e is not even an algebraic number. For a simple proof of this,
see page 25 of Niven’s book, or page 176 of Herstein’s, cited in the Bibliography.

THE ROOT AND RATIO TESTS
3.33. Theorem (Root Test) Given La,, put « = lim sup a/ la, |.
Then a

(a) ifa<1, La, converges;
(b) ifa>1, La, diverges;
(c) ifa=1, the test gives no information.


--- Page 75 ---

66 PRINCIPLES OF MATHEMATICAL ANALYSIS

3.34

Proof If «<1, we can choose B so that « < B <1, and an integer NV

such that
v |an| < B

for n = N [by Theorem 3.17(6)]. That is, n > N implies
|a,| <p".

Since 0 < 8 < 1, Ef" converges. Convergence of La, follows now from
the comparison test.

If « > 1, then, again by Theorem 3.17, there is a sequence {n,} such
that

™/\aq,| >a.

Hence |a,| > 1 for infinitely many values of 7, so that the condition
a, +0, necessary for convergence of Za,, does not hold (Theorem 3.23).
To prove (c), we consider the series

1 1
Di? Lae
For each of these series « = 1, but the first diverges, the second converges.

Theorem (Ratio Test) The series Xa,

a,
atl <1,

(a) converges if lim sup
no a

Gynt
ay,

(b) diverges if

21 for all n >No, where no is some fixed integer.

Proof If condition (a) holds, we can find f <1, and an integer N, such
that

Qn+1

a,

<B

for n = N. In particular,

lay+i| <Blay|,
|ay+2| < Blay+1| <B? lanl,

lav+pl < B?layl.


--- Page 76 ---

NUMERICAL SEQUENCES AND SERIES 67
That is,

|a,| < |ay|B~* + B"
for n > N, and (a) follows from the comparison test, since 2B" converges

If |a,41| = |a,| for = no, it is easily seen that the condition a, +0
does not hold, and (8) follows.

Note: The knowledge that lima,,,/a,=1 implies nothing about the
convergence of Za,. The series X1/n and £1/n? demonstrate this.

3.35 Examples
(a) Consider the series
11 1 +2 421 ~=21~21~21

s+atmtptptyptat pet

for which

2 n
lim inf “24! = Jim (3) =0,
n>o Gy, na \3

. . 1 1
lim inf ¥/a, = lim” /— =—,
no 3 nse \ 3" J3

y 1
lim sup </a, = lim nf =—:

n /2
: Qer1 4, 1 5)
J = lim -{- = oO.
poaar amet 3(5 *

The root test indicates convergence; the ratio test does not apply.
(b) The same is true for the series

Vi yatyl rhete tate.
2 374132" 167 oe *

where
. 1p 1
lim inf 2! = -,
noo a, 8
. a
lim sup 2** =2,
n- 00 a,
but

lim 2/a, = 4.


--- Page 77 ---

68 PRINCIPLES OF MATHEMATICAL ANALYSIS

3.36 Remarks The ratio test is frequently easier to apply than the root test,
since it is usually easier to compute ratios than nth roots. However, the root
test has wider scope. More precisely: Whenever the ratio test shows conver-
gence, the root test does too; whenever the root test is inconclusive, the ratio
test is too. This is a consequence of Theorem 3.37, and is illustrated by the
above examples.

Neither of the two tests is subtle with regard to divergence. Both deduce

divergence from the fact that a, does not tend to zero as n > 00.

3.37 Theorem For any sequence {c,} of positive numbers,

(18)

: : Cn+1 . .
lim inf < lim inf wy F

n> Cn no
. aloo Ca+1
lim sup 2/¢c, < lim sup -
n7>o n>o Ch

Proof We shall prove the second inequality; the proof of the first is
quite similar. Put

Cn+1

a=limsu
n> 0 P Ch
If « = +00, there is nothing to prove. If « is finite, choose B > a. There
is an integer N such that

forn > N. In particular, for any p > 0,
Cy+nsi S Bey, (kK =0,1,...,p —1).
Multiplying these inequalities, we obtain

Cy+p S Bey,

or
Cy, SCyB% +B" = (n> NN).
Hence
[en Safty BB,
so that

lim sup Ye, <p,

n-* 00


--- Page 78 ---

NUMERICAL SEQUENCES AND SERIES 69

by Theorem 3.20(d). Since (18) is true for every B > «, we have
lim sup 7/¢, <a.

n> ao

POWER SERIES

3.38 Definition Given a sequence {c,} of complex numbers, the series

(19) ¥ cq2"
n=0

is called a power series. The numbers c, are called the coefficients of the series;
zis a complex number.

In general, the series will converge or diverge, depending on the choice
of z. More specifically, with every power series there is associated a circle, the
circle of convergence, such that (19) converges if z is in the interior of the circle
and diverges if z is in the exterior (to cover all cases, we have to consider the
plane as the interior of a circle of infinite radius, and a point as a circle of radius
zero). The behavior on the circle of convergence is much more varied and can-
not be described so simply.

3.39 Theorem Given the power series Lc, z", put

__ 1
a = lim sup ¥/|¢4|, R="
(ifa=0, R= +0; ifa= +0, R=0.) Then Xc,z" converges if |z| <R, and
diverges if \z| > R.

Proof Put a, = c,2", and apply the root test:

———_ — Zz
lim sup ./|a,| = |z| lim sup ./|c, | ~ Hl.
nzo n7o

Note: Ris called the radius of convergence of Zc, 2”.

3.40 Examples
(a) The series n"z" has R=0.,
(b) The series oS has R = +00. (In this case the ratio test is easier to
n!

apply than the root test.)


--- Page 79 ---

70 PRINCIPLES OF MATHEMATICAL ANALYSIS

(c) The series Xz" has R=1. If |z| =1, the series diverges, since {z"}
does not tend to 0 asn 00,

(da) The series ye has R=1. It diverges if z= 1. It converges for all
other z with |z| = 1. (The last assertion will be proved in Theorem 3.44.)
(e) The series Da has R=1. It converges for all z with {z| =1, by

the comparison test, since |z"/n?| = 1/n?.

SUMMATION BY PARTS

3.41 Theorem Given two sequences {a,}, {b,}, put

ifn = 0; put A., =0. Then, if0 <p <q, we have

q q-1
(20) Ya, bp = Y Ag(By — Ong) + Aghy — Ap-1dp-
= n= p

n=p

Proof

Ms

qa q-1
(A, - An~1)b, = »y A,b, - x An Onset,
n=p n=p-—1

a,b, =

P

and the last expression on the right is clearly equal to the right side of
(20).

Formula (20), the so-called “‘partial summation formula,” is useful in the
investigation of series of the form Za,b,, particularly when {b,} is monotonic.
We shall now give applications.

3.42 Theorem Suppose

(a) the partial sums A,, of La, form a bounded sequence;
(c) limd, =0.

noo

Then Xa, b, converges.


--- Page 80 ---

NUMERICAL SEQUENCES AND SERIES 71

Proof Choose M such that |A,| <M for all x. Given e > 0, there is an
integer N such that by < (e/2M). For N <p <q, we have

q qa
» 4nd, = F As(by — Bass) + abe — Apoidy
n=p n=p
q-
<M | ¥ (by, — Dyas) + By +B,
n=p

Convergence now follows from the Cauchy criterion. We note that the
first inequality in the above chain depends of course on the fact that
b, 7 Bn+1 2 0.

3.43 Theorem Suppose

(a) |eq| =le2| = les) 2°";
(d) Com-1 2 0, Com SO (m = 1, 2, 3, «6 )5
(c) lim,., ¢, = 0.

Then Xc,, converges.

Series for which (8) holds are called ‘‘alternating series’’; the theorem was
known to Leibnitz.

Proof Apply Theorem 3.42, with a, = (—1)"*', 5, = |c,|.

3.44 Theorem Suppose the radius of convergence of Xc,z" is 1, and suppose
Co 2 Cy [Cp 2°**, lim... CG, = 9. Then Xc,2z" converges at every point on the
circle |z| = 1, except possibly at z = 1.
Proof Put a, =z", b,=c,. The hypotheses of Theorem 3.42 are then
satisfied, since

2

[1-2]

|: — ntl

1-—z

[Ay] = | 2"

if |z| =1,z#1.

ABSOLUTE CONVERGENCE

The series Za, is said to converge absolutely if the series &|a,| converges.

3.45 Theorem If Xa, converges absolutely, then La, converges.


--- Page 81 ---

72 + PRINCIPLES OF MATHEMATICAL ANALYSIS

Proof The assertion follows from the inequality

m m™
Y % Ss D lal,
k=n k=n

plus the Cauchy criterion.

3.46 Remarks For series of positive terms, absolute convergence is the same
as convergence.

If Za, converges, but Z\a,| diverges, we say that La, converges non-
absolutely. For instance, the series

(-1)"
» n
converges nonabsolutely (Theorem 3.43).

The comparison test, as well as the root and ratio tests, is really a test for
absolute convergence, and therefore cannot give any information about non-
absolutely convergent series. Summation by parts can sometimes be used to
handle the latter. In particular, power series converge absolutely in the interior
of the circle of convergence.

We shall see that we may operate with absolutely convergent series very
much as with finite sums. We may multiply them term by term and we may
change the order in which the additions are carried out, without affecting the
sum of the series. But for nonabsolutely convergent series this is no longer true,
and more care has to be taken when dealing with them.

ADDITION AND MULTIPLICATION OF SERIES

3.47 Theorem /f L%a,=A, and %b,=B, then Ya,+b,)=A+B, and
Lica, = cA, for any fixed c.

Proof Let

Then
A, + B, = Y (a, + b,).
k=0

Since lim,.,. 4, = A and lim,_,,, B, = B, we see that

lim (A, + B,) = 4 +B.

nwo

The proof of the second assertion is even simpler.


--- Page 82 ---

NUMERICAL SEQUENCES AND SERIES 73

Thus two convergent series may be added term by term, and the result-
ing series converges to the sum of the two series. The situation becomes more
complicated when we consider multiplication of two series. To begin with, we
have to define the product. This can be done in several ways; we shall consider
the so-called ‘Cauchy product.”

3.48 Definition Given Za, and 23,, we put

a,b, - x (n =0, 1, 2, a)

CG, =
k

its

and call &c, the product of the two given series.

This definition may be motivated as follows. If we take two power
series La,z” and Lb, 2", multiply them term by term, and collect terms contain-
ing the same power of z, we get
Ya, 2"* ¥ b,2" = (ag + Zz + A227 +++ bo + byz + by27 +°*°)
=0 n=0

= dg bg + (ao.by + aybo)z + (ao by + a,b, + Az b9)27 + °°
HCO + QZ+eg wt,

Setting z = 1, we arrive at the above definition.

3.49 Example If

An=Sia,  Be=Vby, C= Ses
k=0 k=0 k=0

and A, > A, B, > B, then it is not at all clear that {C,} will converge to AB,
since we do not have C, = A,.B,. The dependence of {C,} on {A,} and {B,} is
quite a complicated one (see the proof of Theorem 3.50). We shall now show
that the product of two convergent series may actually diverge.

The series
2 (-1)" 1 1 1
a = 1 — Se H+ ee et
Bon +1 J2 J3 4
converges (Theorem 3.43). We form the product of this series with itself and
obtain

ie)


--- Page 83 ---

74° PRINCIPLES OF MATHEMATICAL ANALYSIS

so that
n 1
= —1y" ———E—
c= "2s Jenks Dea)
Since ;
2 2
(1 k-+ 1+ 1) =F +1) - (5-%) < (5 +1) ;
we have
2 Ant+1)

Jel => ,

so that the condition c, +0, which is necessary for the convergence of Uc, is
not satisfied.

In view of the next theorem, due to Mertens, we note that we have here
considered the product of two nonabsolutely convergent series.

3.50 Theorem Suppose
(a) >a, converges absolutely,
n=0

A,

Ms
?
Il

(2)
(c)

(2) Ch = > ay Dn-5 (n=0, 1, 2,...).
=0
Then

3
tl
So

Ms
=

ll
be

=
ll
o

y Cy = AB.
n=0
That is, the product of two convergent series converges, and to the right
value, if at least one of the two series converges absolutely.
Proof Put
Ay=S ay, By=L bur Co=Yicur By = BB.
Then
C,, = Ag Do + (A by + A4b9) + °°* + (Go by + 21b,-1 + °° + 4,80)
= 4B, + 4, By,-1 +°*' + 4,Bo
= ao(B + B,) + a,(B + By-1) + °° +. 4,(B + Bo)
= A,B + aoB, + a,By-1 ++°* + Bo


--- Page 84 ---

NUMERICAL SEQUENCES AND SERIES 75

Put
Vn = ao Bn + a:B,-1 poet G, Bo -
We wish to show that C,-— AB. Since A, B— AB, it suffices to
show that
(21) lim y, = 0.

n7o
Put

a= >’ |a,|.

n=0

[It is here that we use (a).] Let ¢ >0 be given. By (c), 8B, +0. Hence we
can choose WN such that |8,| <« for n = N, in which case

\Ynl < [Boa +°°* + Byag—w| + [By4i9n—n-1 + °'' + Bn o|
< |Boa, ++++ + Bya,—n| + 60.
Keeping N fixed, and letting n — 00, we get

lim sup |7,,| < ea,
n7>o
since a, +0 as k + oo. Since ¢ is arbitrary, (21) follows.

Another question which may be asked is whether the series Yc,, if con-
vergent, must have the sum AB. Abel showed that the answer is in the affirma-
tive,

3.51 Theorem Jf the series Xa,, 2b,, Uc, converge to A, B, C, and
Cy = 495, +°°* +.4,b9, then C = AB.

Here no assumption is made concerning absolute convergence. We shall
give a simple proof (which depends on the continuity of power series) after
Theorem 8.2.

REARRANGEMENTS

3.52 Definition Let {k,},n =1,2,3,..., be a sequence in which every
positive integer appears once and only once (that is, {k,} is a 1-1 function from
J onto J, in the notation of Definition 2.2). Putting

a, = Ox, (n = 1, 2, 3,...),

we say that Za’ is a rearrangement of La,.


--- Page 85 ---

76 PRINCIPLES OF MATHEMATICAL ANALYSIS

If {s,}, {s,} are the sequences of partial sums of La,, La), it is easily seen
that, in general, these two sequences consist of entirely different numbers.
We are thus led to the problem of determining under what conditions all
rearrangements of a convergent series will converge and whether the sums are
necessarily the same.

3.53 Example Consider the convergent series

and one of its rearrangements
(23) V+d-d444+7-d4+54+ar-ste

in which two positive terms are always followed by one negative. If s is the
sum of (22), then

s<1l—-444=3.
Since

1 1

| it 1)
4k —3* 4k —1 7 3k

for k = 1, we see that 55 <s¢ <sqg <:::, where s, is mth partial sum of (23).
Hence

lim sup s} > 55 = 3,

no

so that (23) certainly does not converge to s [we leave it to the reader to verify
that (23) does, however, converge].
This example illustrates the following theorem, due to Riemann,

3.54 Theorem Let Xa, be a series of real numbers which converges, but not
absolutely. Suppose

-osasPeo.
Then there exists a rearrangement La} with partial sums s, such that

(24) lim inf s; = a, lim sup s, = P.

n7o n-co

Proof Let

|a,| + 4, a, | — 4a,
= —-, =o =1, pre rerariry 1
Pn 5 In 5) (n = 1, 2, 3,...)


--- Page 86 ---

(25)

NUMERICAL SEQUENCES AND SERIES 77

Then Py — Gn = ns Pn +n = [4n|>Pn 29,9, 20. The series Ep,, 2d,
must both diverge.
For if both were convergent, then
XP, + In) = 2] a, |

would converge, contrary to hypothesis. Since
N N N N
xy a, = Dy (Pn — 9n) = > Pn x Qn»

divergence of Zp, and convergence of Xq, (or vice versa) implies diver-
gence of La,, again contrary to hypothesis.

Now let P;, P2, P3,... denote the nonnegative terms of Xa,, in the
order in which they occur, and let Q,, Q,, Q3,... be the absolute values
of the negative terms of La,, also in their original order.

The series P,, 2Q, differ from Zp,, Zq, only by zero terms, and
are therefore divergent.

We shall construct sequences {m,}, {k,}, such that the series

Prete + Pa, — Q1- 7° — Qe, t Pmt $0"
+ Pr, — Qeses — °° Qi ts

which clearly is a rearrangement of Za,,, satisfies (24).
Choose real-valued sequences {x,}, {8,} such that a, >a, 8, — B,

a, < B, ’ By > 0.
Let m,, k, be the smallest integers such that

Pyteet + Pa, > Bi,
Preto +P, — QO, -— 7° — Oy, <3

let m,,k, be the smallest integers such that

Py terre t+ Pm, — O14 — 00° — De, + Ppt tot + Pmz > Bo,

Pyte +P, — Ot — 111 — Dey + Pigs to + Pm — Dies +t
== Oey <a;

and continue in this way. This is possible since 2P, and XQ, diverge.

If x,, ¥, denote the partial sums of (25) whose last terms are P,,, ,
— Q,,, then

|Xn — Bal S Pr, [Yn — %| < Q,,:

Since P, >0 and Q, +0 as n> 00, we see that x, > B, y, +o.
Finally, it is clear that no number less than « or greater than £ can
be a subsequential limit of the partial sums of (25).


--- Page 87 ---

78 PRINCIPLES OF MATHEMATICAL ANALYSIS

3.55 Theorem If La, is a series of complex numbers which converges absolutely,
then every rearrangement of La, converges, and they all converge to the same sum.

Proof Let Za) be a rearrangement, with partial sums s,. Given ¢ > 0,
there exists an integer N such that m =n > N implies

(26) y |a;| <6.

Now choose p such that the integers 1, 2,..., N are all contained in the
set ky, k,,..., k, (we use the notation of Definition 3.52). Then ifn > p,
the numbers @,,...,@y will cancel in the difference s,—s,, so that
|S, — 5,| <e, by (26). Hence {s,} converges to the same sum as {s,}.

EXERCISES

. Prove that convergence of {s,} implies convergence of {{s,|}. Is the converse true?
Calculate lim ( Vn? +n—n).
nao

N

3. If 3 = v2, and
Sui=V24V5, (=1,2,3,...),

prove that {s,} converges, and that s, <2 forn=1, 2,3,....
4. Find the upper and lower limits of the sequence {s,} defined by

Sam-1 1
51 =90; Sam = — a3 Sam+1 = 5 + Sam.

5. For any two real sequences {a,}, {b.}, prove that

lim sup (a, + bx) <lim sup a, + lim sup 5,,

provided the sum on the right is not of the form o — oo,

6. Investigate the behavior (convergence or divergence) of Za, if
(a) Qn =Vna+i- Vn;
(b) Qn = Vati-vn,
n
(c) an = (Vn — 1)"
1
(d) a, = Tee’ for complex values of z.
7. Prove that the convergence of Za, implies the convergence of
Van
aa

if a, > 0.


--- Page 88 ---

NUMERICAL SEQUENCES AND SERIES 79

8. If Xa, converges, and if {6,} is monotonic and bounded, prove that Za,b, con-
verges.
9. Find the radius of convergence of each of the following power series:

Qn
(a) D2, (6) D2

2" n .

(ce) Daz", (4) D3a2".

10. Suppose that the coefficients of the power series }\a, 2" are integers, infinitely many

of which are distinct from zero. Prove that the radius of convergence is at most 1.
11. Suppose a, > 0, s, =a, +°++-+ a@,, and La, diverges.

Qn

1+ a,

(a) Prove that 5° diverges.

(b) Prove that

a, §
N41 open p ONtk >1- N

Snea SNak Su+k

and deduce that >° = diverges.

(c) Prove that

Qn 1 1
Si Sn. Sn

a
and deduce that La converges.
a

(d) What can be said about

an
1+ na,

Qn
1+ na,

?

> and >

12. Suppose a, > 0 and Za, converges. Put

(a) Prove that

if m <n, and deduce that }° an diverges.
rn


--- Page 89 ---

80 PRINCIPLES OF MATHEMATICAL ANALYSIS

(6) Prove that

an

Vin

< UVP, — Vn 41)

Gn
and deduce that > Van converges.
rn

13. Prove that the Cauchy product of two absolutely convergent series converges
absolutely.
14. If {s,} is a complex sequence, define its arithmetic means o, by

Sot sit t+ Sn

On nol (1 =0, 1, 2,...).

(a) If lim s, =s, prove that lim o, = s.

(6) Construct a sequence {s,} which does not converge, although lim a, -= 0.

(c) Canit happen that s, > 0 forall and that lim sup s, = 0, although lim o, = 0?
(d) Put an = S$, — Sn-1, for n > 1. Show that

1

noi¢ kay.

M:

Sn— On =
1

Assume that lim (#a,) =0 and that {o,} converges. Prove that {s,} converges.
[This gives a converse of (a), but under the additional assumption that na,—> 0.]
(e) Derive the last conclusion from a weaker hypothesis: Assume M < 0,
|na,| <M for all n, and lim o, =o. Prove that lim s,=o, by completing the
following outline:

If m <n, then

Sy 0p tS ig, — og) + y (Sn — 81).
n—m N—M t=m+1
For these /,
\s,— 51] <M (n= m—1)M

on one m+2

Fix ¢ > 0 and associate with each n the integer m that satisfies

n—€
<< .
MSTT5 <m+1

Then (m+ 1)/(n — m) < 1/e and |s.—s:| < Me. Hence

lim sup|s, —o| <Me.

Since € was arbitrary, lim s, =o.


--- Page 90 ---

NUMERICAL SEQUENCES AND SERIES 81

15. Definition 3.21 can be extended to the case in which the a, lie in some fixed R*.

16,

17

18

19,

Absolute convergence is defined as convergence of Z|a,|. Show that Theorems
3.22, 3.23, 3.25(a), 3.33, 3.34, 3.42, 3.45, 3.47, and 3.55 are true in this more
general setting. (Only slight modifications are required in any of the proofs.)

Fix a positive number «. Choose x, > Va, and define X2, X%3, Xa, ..., by the

recursion formula
1 a
Xn¢t =o [xX.+—].
2 Xn

(a) Prove that {x,} decreases monotonically and that lim x, = V a.
(b) Put & =x, — Va, and show that

mace <—h
ee xn WV a

so that, setting 8 =2Va,
e,\?"
eas <8 (3) (n=1, 2,3,...).

(c) This is a good algorithm for computing square roots, since the recursion
formula is simple and the convergence is extremely rapid. For example, if « = 3

and x, = 2, show that ¢,/8 < 54, and that therefore

és < 4° 10-6, &6 << 4° 10-32,
Fix « > 1, Take x, > Va, and define

a+ Xn a— xX,
Anti = Ty Xe
1 n

(a) Prove that x, >x3>%5> °°.

(b) Prove that x2 <x4 <x <'''.

(c) Prove that lim x, = Va.

(d) Compare the rapidity of convergence of this process with the one described
in Exercise 16.

Replace the recursion formula of Exercise 16 by

—1

x ~pt+l
Xai = Xn on

where p is a fixed positive integer, and describe the behavior of the resulting
sequences {x,}.
Associate to each sequence a = {«,}, in which «, is 0 or 2, the real number
© On
xa=>y—.
( ) n=1 3"

Prove that the set of all x(a) is precisely the Cantor set described in Sec, 2.44.


--- Page 91 ---

82

20.

21.

22.

PRINCIPLES OF MATHEMATICAL ANALYSIS

Suppose {p,} is a Cauchy sequence in a metric space X, and some subsequence

{pm} Converges to a point p¢ X. Prove that the full sequence {p,} converges to p.

Prove the following analogue of Theorem 3.10(5): If {£,} is a sequence of closed

nonempty and bounded sets in a complete metric space X, if E, > E,+1, and if
lim diam E, = 0,

then () 2£, consists of exactly one point.

Suppose X is a nonempty complete metric space, and {G,} is a sequence of

dense open subsets of X. Prove Baire’s theorem, namely, that (\%G, is not

empty. (In fact, it 1s dense in X.) Hint: Find a shrinking sequence of neighbor-

hoods £, such that E, < G,, and apply Exercise 21.

. Suppose {p,} and {q,} are Cauchy sequences in a metric space X. Show that the

sequence {d(p,,4n)} converges. Hint: For any m, n,
A(Pny Gn) SA(Dn, Pm) + d(Pm, Gm) + d(Gm » Gn);
it follows that
|d(Pn, Gn) ~ d(Pm , am)|
is small if m and n are large.

Let X be a metric space.
(a) Call two Cauchy sequences {p,}, {qn} in X equivalent if

lim d(pn, Qn) = 0.

Prove that this is an equivalence relation.
(b) Let X* be the set of all equivalence classes so obtained. If Pe X*, Qe X*,
{p,} € P, {qn} € Q, define

A(P, Q) = lim d(Pr, dn);

by Exercise 23, this limit exists. Show that the number A(P, Q) is unchanged if
{pr} and {q,} are replaced by equivalent sequences, and hence that A is a distance
function in X*,
(c) Prove that the resulting metric space ¥* is complete.
(d) For each pe X, there is a Cauchy sequence all of whose terms are p; let P,
be the element of X* which contains this sequence. Prove that

A(P>, P,) =d(p, q)
for all p,q ¢ X. In other words, the mapping ¢ defined by y(p) = P, is an isometry
(i.e., a distance-preserving mapping) of X into X*.
(e) Prove that o(X) is dense in X*, and that p(X) = X* if X is complete. By (d),
we may identify X and g(X) and thus regard X as embedded in the complete
metric space X*. We call X* the completion of X.

. Let X be the metric space whose points are the rational! numbers, with the metric

d(x, y) =|x—y|. What is the completion of this space? (Compare Exercise 24.)


--- Page 92 ---

4

CONTINUITY

The function concept and some of the related terminology were introduced in
Definitions 2.1 and 2.2. Although we shall (in later chapters) be mainly interested
in real and complex functions (i.e., in functions whose values are real or complex
numbers) we shall also discuss vector-valued functions (i.e., functions with
values in R*) and functions with values in an arbitrary metric space. The theo-
rems we shall discuss in this general setting would not become any easier if we
restricted ourselves to real functions, for instance, and it actually simplifies and
clarifies the picture to discard unnecessary hypotheses and to state and prove
theorems in an appropriately general context.

The domains of definition of our functions will also be metric spaces,
suitably specialized in various instances.

LIMITS OF FUNCTIONS

4.1 Definition Let Y and Y be metric spaces; suppose E < X, f maps E into
Y, and p is a limit point of E. We write f(x) +g as x > =p, or

(1) lim f(x) =4

x7>p


--- Page 93 ---

84 PRINCIPLES OF MATHEMATICAL ANALYSIS

if there is a point ge Y with the following property: For every ¢>0 there
exists a 6 > 0 such that

(2) ay(f(x), 9) <8
for all points x e EF for which
(3) 0 < dy(x, p) < 6.

The symbols dy and dy refer to the distances in X and Y, respectively.

If X and/or Y are replaced by the real line, the complex plane, or by some
euclidean space R*, the distances dy , dy are of course replaced by absolute values,
or by norms of differences (see Sec. 2.16).

It should be noted that pe X, but that p need not be a point of E
in the above definition. Moreover, even if pe E, we may very well have

S(p) # lim, , f().

We can recast this definition in terms of limits of sequences:
4.2 Theorem Let X, Y, E, f, and p be as in Definition 4.1. Then
(4) lim f(x) =q
xp
if and only if
(5) lim f(P,) =4
nwo
for every sequence {p,} in E such that
(6) Pr#P, lim p, =p.
. n7>o
Proof Suppose (4) holds. Choose {p,} in E satisfying (6). Let e>0
be given. Then there exists 6>0 such that d,(/(x),q)<« if xek
and 0 < d,(x, p)<6. Also, there exists N such that n>N implies
0 <d,(p,,p)<6. Thus, for n>N, we have dy(f(p,), 7) <¢@, which
shows that (5) holds.
Conversely, suppose (4) is false. Then there exists some ¢ > 0 such
that for every 5 > 0 there exists a point x € E (depending on 4), for which

dy( f(x), 7) 2 & but 0 < d(x, p) <5. Taking 6, = 1/n(n =1, 2, 3,...), we
thus find a sequence in E satisfying (6) for which (5) is false.

Corollary Jf f has a limit at p, this limit is unique.

This follows from Theorems 3.2(6) and 4.2.


--- Page 94 ---

CONTINUITY 85

4.3 Definition Suppose we have two complex functions, f and g, both defined
on E. By {+g we mean the function which assigns to each point x of E the
number f(x) + g(x). Similarly we define the difference f—g, the product fg,
and the quotient //g of the two functions, with the understanding that the quo-
tient is defined only at those points x of E at which g(x) #0. If f assigns to each
point x of E the same number c, then f is said to be a constant function, or
simply a constant, and we write f=c. If f and g are real functions, and if
F(x) = g(x) for every x € E, we shall sometimes write f> g, for brevity.
Similarly, if f and g map E into R*, we define f + g and f- g by

(f+ s(x) =f(x) + 8x), (f° 8)(x) = F(x) - B();
and if 2 is a real number, (Af)(x) = Af(x).

4.4 Theorem Suppose E < X, a metric space, p is a limit point of E, f and g
are complex functions on E, and

lim f(x) = A, lim g(x) = B.

xp xp

Then (a) lim (f+ g9)(*)=4A+4+ 8;
(0) lim (fg)(x) = AB;
xp

_ (f A
(c) lim (4) xy=-, if BF.

tim O)=5
Proof In view of Theorem 4.2, these assertions follow immediately from
the analogous properties of sequences (Theorem 3,3).

Remark If f and g map E into R*, then (a) remains true, and (5) becomes
(6') lim (f+ g\(x) =A°B.
xp

(Compare Theorem 3.4.)

CONTINUOUS FUNCTIONS

4.5 Definition Suppose X and Y are metric spaces, E < X, pe E, and f maps
E into Y. Then fis said to be continuous at p if for every ¢ > 0 there exists a
6 > 0 such that

dy(f(x), f(p)) < é

for all points x € E for which d,(x, p) < 6.
If fis continuous at every point of £, then fis said to be continuous on E.
It should be noted that / has to be defined at the point p in order to be
continuous at p. (Compare this with the remark following Definition 4.1.)


--- Page 95 ---

86 PRINCIPLES OF MATHEMATICAL ANALYSIS

If p is an isolated point of E, then our definition implies that every function
J which has E as its domain of definition is continuous at p. For, no matter
which ¢ > 0 we choose, we can pick 6 > 0 so that the only point x ¢ E for which
dy(x, p) < dis x =p; then

dy(f (x), f(p)) =0 < e.

4.6 Theorem In the situation given in Definition 4.5, assume also that p is a
limit point of E. Then f is continuous at p if and only if lim,.., f(x) =f(p).

Proof This is clear if we compare Definitions 4.1 and 4.5.
We now turn to compositions of functions. A brief statement of the

following theorem is that a continuous function of a continuous function is
continuous.

4.7 Theorem Suppose X, Y, Z are metric spaces, E < X, f maps E into Y, g
maps the range of f, {(E), into Z, and h is the mapping of E into Z defined by
A(x) =9(f(x)) (we E).

If f is continuous at a point p € E and if g is continuous at the point f(p), then h is
continuous at p.

This function h is called the composition or the composite of f and g. The
notation

h=gof
is frequently used in this context.

Proof Let ¢>0 be given. Since g is continuous at f(p), there exists
n > 0 such that

af g(y), WF (P))) < € if dy(y, f(p)) <n and ye f(E).
Since fis continuous at p, there exists 6 > 0 such that
dy(f(x), f(p)) <1 if dy(x, p) < 6 and xe E.
It follows that
(h(x), A(p)) = d2(9( F(X), 9S (p)) < €

if dy(x, p) <6 and xe £. Thus A is continuous at p.
4.8 Theorem <A mapping f of a metric space X into a metric space Y is con-
tinuous on X if and only if f~'(V) is open in X for every open set V in Y.

(Inverse images are defined in Definition 2.2.) This is a very useful charac-
terization of continuity.


--- Page 96 ---

CONTINUITY 87

Proof Suppose fis continuous on XY and V is an open setin Y, We have
to show that every point of f~'(V) is an interior point of f~'(V). So,
suppose p € X and f(p)e V. Since V is open, there exists ¢ > 0 such that
yeV if dy(f(p), y) < 8; and since fis continuous at p, there exists 6 > 0
such that dy(/(x), f(p)) < € if dy(x, p) <6. Thus xef~1(V) as soon as
d,(x, p) < 6.

Conversely, suppose f~‘(V) is open in X for every open set Vin Y.
Fix pe X and « > 0, let V be the set of all ye Y such that dy(y, f(p)) < ¢.
Then V is open; hence f~1(V) is open; hence there exists 5 > 0 such that
xef~'(V)as soon as dy(p, x) <6. But if xe f~'(V), then f(x) € V, so
that dy(/(x), f(p)) < e.

This completes the proof.

Corollary A mapping f of a metric space X into a metric space Y is continuous if
and only if f~1(C) is closed in X for every closed set C in Y.

This follows from the theorem, since a set is closed if and only if its com-

plement is open, and since f~'(E°) =[f~‘(E)]° for every Ec Y.

We now turn to complex-valued and vector-valued functions, and to

functions defined on subsets of R*.

4.9 Theorem Let f and g be complex continuous functions on a metric space X.
Then f + g, fg, and f/g are continuous on X.

4.10

(7)

In the last case, we must of course assume that g(x) # 0, for all x eX.

Proof At isolated points of X there is nothing to prove. At limit points,
the statement follows from Theorems 4.4 and 4.6.

Theorem

(a) Let f,, ..., f, be real functions on a metric space X, and let f be the
mapping of X into R* defined by

f(x) = (1), -- A) = we X);

then f is continuous if and only if each of the functions f,, ..., fj, is continuous.
(6) If f and g are continuous mappings of X into R*, then f +g andf+g
are continuous on X.

The functions f,, ..., f, are called the components of f. Note that
f +g is a mapping into R*, whereas f+ g is a real function on X.


--- Page 97 ---

88 PRINCIPLES OF MATHEMATICAL ANALYSIS

Proof Part (a) follows from the inequalities

k
Lid) F091 < If) 1091 =(¥. 14) - £0017]
forj=1,...,%. Part (5) follows from (a) and Theorem 4.9.

+
>

4.11 Examples If x,, ..., x, are the coordinates of the point x e R*, the
functions ¢, defined by
(8) d(x)=x, (xe R’)

are continuous on R*, since the inequality

I(x) — o(y)| < |x—y|

shows that we may take 6 = ¢ in Definition 4.5. The functions ¢, are sometimes
called the coordinate functions.
Repeated application of Theorem 4.9 then shows that every monomial

where n,, ..., ”, are nonnegative integers, is continuous on R*. The same is
true of constant multiples of (9), since constants are evidently continuous. It
follows that every polynomial P, given by

(10) P(X) = eqn, XE (x E RY),

is continuous on R*. Here the coefficients c, ...,, are complex numbers, 1, ..., M%

are nonnegative integers, and the sum in (10) has finitely many terms.
Furthermore, every rational function in x;,..., x,, that is, every quotient

of two polynomials of the form (10), is continuous on R* wherever the denomi-
nator is different from zero.
From the triangle inequality one sees easily that

(11) IIx] -—ly||s|x-y] @yeR%.

Hence the mapping x — |x| is a continuous real function on R*.

If now f is a continuous mapping from a metric space X into R*, and if ¢
is defined on X by setting ¢(p) = |f(p)|, it follows, by Theorem 4.7, that @ is a
continuous real function on X.

4.12 Remark We defined the notion of continuity for functions defined on a
subset E of a metric space X. However, the complement of F in X plays no
role whatever in this definition (note that the situation was somewhat different
for limits of functions). Accordingly, we lose nothing of interest by discarding
the complement of the domain of f. This means that we may just as well talk
only about continuous mappings of one metric space into another, rather than


--- Page 98 ---

CONTINUITY 89

of mappings of subsets. This simplifies statements and proofs of some theorems.
We have already made use of this principle in Theorems 4.8 to 4.10, and will
continue to do so in the following section on compactness.

CONTINUITY AND COMPACTNESS

4.13 Definition A mapping f of a set E into R* is said to be bounded if there is
a real number M such that |f(x)| < M for all xe £.

4.14 Theorem Suppose f is a continuous mapping of a compact metric space
X into a metric space Y. Then f(X) is compact.

Proof Let {V,} be an open cover of f(X). Since fis continuous, Theorem
4.8 shows that each of the sets f~'(V,) is open. Since X is compact,

there are finitely many indices, say a,,..., @,, such that
(12) Xof'V,) ve Uf (Vs,):

Since f(f~‘(£)) < E for every E < Y, (12) implies that
(13) LX) CV, Ut UV,

This completes the proof.

Note: We have used the relation f(f~'(£)) ¢ E, valid for Ec Y. If
Ec X, then f~'(/(E£)) > E; equality need not hold in either case.
We shall now deduce some consequences of Theorem 4.14.

4.15 Theorem If f is a continuous mapping of a compact metric space X into
R*, then {(X) is closed and bounded. Thus, f is bounded.

This follows from Theorem 2.41. The result is particularly important
when fis real:

4.16 Theorem Suppose f is a continuous real function on a compact metric
space X, and
(14) M = sup f(p), m= inf f(2).

pe

pex
Then there exist points p, q € X such that f{(p) = M and f(q) =m.

The notation in (14) means that M is the least upper bound of the set of
all numbers f(p), where p ranges over X, and that m is the greatest lower bound
of this set of numbers.


--- Page 99 ---

90 PRINCIPLES OF MATHEMATICAL ANALYSIS

The conclusion may also be stated as follows: There exist points p and q
in X such that f(q) < f(x) <f(p) for all x € X; that is, f attains its maximum
(at p) and its minimum (at q).

Proof By Theorem 4.15, f(X) is a closed and bounded set of real num-
bers; hence f(X) contains

M =sup f(X) and = m=inff(X),
by Theorem 2.28.

4.17 Theorem Suppose f is a continuous 1-1 mapping of a compact metric
space X onto a metric space Y. Then the inverse mapping f~' defined on Y by

fUG@)=x (eX)
is a continuous mapping of Y onto X.

Proof Applying Theorem 4.8 to f~! in place of f, we see that it suffices
to prove that /(V) is an open set in Y for every open set Vin X. Fix such
a set V.

The complement V° of V is closed in X, hence compact (Theorem
2.35); hence f(V'‘°) is a compact subset of Y (Theorem 4.14) and so is
closed in Y (Theorem 2.34). Since fis one-to-one and onto, f(V) is the
complement of f(V‘). Hence /(V) is open.

4.18 Definition Let /be a mapping of a metric space X into a metric space Y.
We say that fis uniformly continuous on X if for every e > 0 there exists 5 > 0
such that

(15) dy(f(p), f(g) < €

for all p and qg in X for which dy(p, q) < 6.

Let us consider the differences between the concepts of continuity and of
uniform continuity. First, uniform continuity is a property of a function on a
set, whereas continuity can be defined at a single point. To ask whether a given
function is uniformly continuous at a certain point is meaningless. Second, if
J is continuous on X, then it is possible to find, for each e > 0 and for each
point p of X,a number 6 > 0 having the property specified in Definition 4.5. This
6 depends on ¢ and on p. If fis, however, uniformly continuous on_X, then it is
possible, for each ¢ > 0, to find one number 6 > 0 which will do for all points
p of X.

Evidently, every uniformly continuous function is continuous. That the
two concepts are equivalent on compact sets follows from the next theorem.


--- Page 100 ---

CONTINUITY 91

4.19 Theorem Let f be a continuous mapping of a compact metric space X
into a metric space Y. Then f is uniformly continuous on X.

Proof Let ¢>0 be given. Since f is continuous, we can associate to
each point p e X a positive number ¢(p) such that

eer é

(16) qéX,dx(p,4)<(p) implies dy(f(p), (9) <5

Let J(p) be the set of all ge X for which
(17) dx(p, 9) < $4(p).

Since p € J(p), the collection of all sets /(p) is an open cover of X; and

since X is compact, there is a finite set of points p,, ..., p, in X, such that
(18) XcJ(py) usts US (Dy).

We put

(19) 5 =} min [$(p,), ..., b(Pr)]-

Then 6 >0. (This is one point where the finiteness of the covering, in-
herent in the definition of compactness, is essential. The minimum of a
finite set of positive numbers is positive, whereas the inf of an infinite set
of positive numbers may very well be 0.)

Now let g and p be points of X, such that dy(p, q) < 6. By (18), there
is an integer m, 1 <m <n, such that pe J(p,,); hence

and we also have

Finally, (16) shows that therefore

This completes the proof.

An alternative proof is sketched in Exercise 10.
We now proceed to show that compactness is essential in the hypotheses
of Theorems 4.14, 4.15, 4.16, and 4.19.

4.20 Theorem Let E be a noncompact set in R'. Then

(a) there exists a continuous function on E which is not bounded;
(5) there exists a continuous and bounded function on E which has no
maximum.

If, in addition, E is bounded, then


--- Page 101 ---

92 PRINCIPLES OF MATHEMATICAL ANALYSIS

(21)

(22)

(23)

(c) there exists a continuous function on E which is not uniformly
continuous.

Proof Suppose first that £ is bounded, so that there exists a limit point
Xo of E which is not a point of E. Consider

1
X—Xo

f(x) = (xe E).

This is continuous on E (Theorem 4.9), but evidently unbounded. To see
that (21) is not uniformly continuous, let e > 0 and 6 > 0 be arbitrary, and
choose a point x e E such that |x — x)| <6. Taking t close enough to
Xo, we can then make the difference | f(t) — f(x)| greater than e, although
|t —x| <6. Since this is true for every 6 > 0, fis not uniformly continu-
ous on £.

The function g given by

1

it@oxnye 4)

g(x) =
is continuous on £, and is bounded, since 0 < g(x) < 1. It is clear that

sup g(x) = 1,
xeéE
whereas g(x) < 1 for all xe Z. Thus g has no maximum on E.
Having proved the theorem for bounded sets £, let us now suppose
that E is unbounded. Then f(x) = x establishes (a), whereas

x?

establishes (2), since

sup A(x) =1

xeE

and A(x) < 1 for all xe E.

Assertion (c) would be false if boundedness were omitted from the
hypotheses. For, let E be the set of all integers. Then every function
defined on £ is uniformly continuous on £. To see this, we need merely
take 6 < 1 in Definition 4.18.

We conclude this section by showing that compactness is also essential in

Theorem 4.17.


--- Page 102 ---

CONTINUITY 93

4.21 Example Let X be the half-open interval [0, 27) on the real line, and
let f be the mapping of X onto the circle Y consisting of all points whose distance
from the origin is 1, given by

(24) f(t)=(cost,sint) (O<t<2n),

The continuity of the trigonometric functions cosine and sine, as well as their
periodicity properties, will be established in Chap. 8. These results show that
f is a continuous I-1 mapping of X onto Y.

However, the inverse mapping (which exists, since f is one-to-one and
onto) fails to be continuous at the point (1, 0) =f(0). Of course, X is not com-
pact in this example. (It may be of interest to observe that f~! fails to be
continuous in spite of the fact that Y is compact!)

CONTINUITY AND CONNECTEDNESS

4.22 Theorem If f is a continuous mapping of a metric space X into a metric
space Y, and if E is a connected subset of X, then f(E) is connected.

Proof Assume, on the contrary, that {(£) = AU B, where A and B are
nonempty separated subsets of Y. PutG =En f~'(A) H=Enf 7 (B).

Then EF =G vu H, and neither G nor H is empty.

Since A ¢ A (the closure of A), we have G < f~ 1(A); the latter set is
closed, since f is continuous; hence G < f~1(A). It follows that f(G) ¢ A.
Since {(H) = B and An B is empty, we conclude that G 7 H is empty.

The same argument shows that G 7 H is empty. Thus G and H are
separated. This is impossible if E is connected.

4.23 Theorem Let f be a continuous real function on the interval [a, b]. If
S(@) <f(b) and if c is a number such that f(a) << f(b), then there exists a
point x 6 (a, b) such that f(x) =c.

A similar result holds, of course, if f(a) > (6). Roughly speaking, the
theorem says that a continuous real function assumes all intermediate values on
an interval.

Proof By Theorem 2.47, [a, b] is connected; hence Theorem 4.22 shows
that f([a, b]) is a connected subset of R', and the assertion follows if we
appeal once more to Theorem 2.47,

4.24 Remark At first glance, it might seem that Theorem 4.23 has a converse.
That is, one might think that if for any two points x, < x, and for any number c
between f(x,) and f(x.) there is a point x in (x,, x2) such that f(x) =c, then f
must be continuous.

That this is not so may be concluded from Example 4.27(d).


--- Page 103 ---

94 PRINCIPLES OF MATHEMATICAL ANALYSIS

DISCONTINUITIES

If x is a point in the domain of definition of the function f at which fis not
continuous, we say that fis discontinuous at x, or that f has a discontinuity at x.
If f is defined on an interval or on a segment, it is customary to divide discon-
tinuities into two types. Before giving this classification, we have to define the
right-hand and the left-hand limits of f at x, which we denote by f(x +) and f(x—),
respectively.

4.25 Definition Let f be defined on (a, b). Consider any point x such that
asx<b. We write

f(x+) =4

if f(t,) > gq as n> 00, for all sequences {t,} in (x, 5) such that ¢, + x. To obtain
the definition of f(x—), for a < x < b, we restrict ourselves to sequences {t,} in

(a, x).
It is clear that any point x of (a, 5), lim f(t) exists if and only if
t7x

Set) =f(E—) = lim (7).

4.26 Definition Let f be defined on (a, 5). If fis discontinuous at a point x,
and if f(x+) and f(x —) exist, then fis said to have a discontinuity of the first
kind, or a simple discontinuity, at x. Otherwise the discontinuity is said to be of
the second kind.

There are two ways in which a function can have a simple discontinuity:
either f(x-+) * f(x—) [in which case the value f(x) is immaterial], or f(x+) =

f(x—) #f).

4.27 Examples
(a) Define

_ ft (x rational),
SO) = (0 (x irrational).

Then f has a discontinuity of the second kind at every point x, since
neither f(x+) nor f(x—) exists.
(b) Define

x (x rational),
f(x) = K (x irrational).


--- Page 104 ---

CONTINUITY 95

Then fis continuous at x = 0 and has a discontinuity of the second
kind at every other point.

(c) Define
x+2 (-3 <x < —2),
f@M=(-x-2 (-2<x<0),
x+2 (O<x< 1).

Then f has a simple discontinuity at x =0 and is continuous at
every other point of (—3, 1).
(d) Define

0 (x = 0).

Since neither f(0+) nor f(O—) exists, f has a discontinuity of the
second kind at x = 0. We have not yet shown that sin x is a continuous
function. If we assume this result for the moment, Theorem 4.7 implies
that fis continuous at every point x 4 0.

MONOTONIC FUNCTIONS

We shall now study those functions which never decrease (or never increase) on
a given segment.

4.28 Definition Let f be real on (a,b). Then f is said to be monotonically
increasing on (a, b) if a<x<y<b implies f(x) < f(y). If the last inequality
is reversed, we obtain the definition of a monotonically decreasing function. The
class of monotonic functions consists of both the increasing and the decreasing
functions.

4.29 Theorem Let f be monotonically increasing on (a,b). Then f(x+) and
FI (x—) exist at every point of x of (a, b). More precisely,

sup f(t) =f(x—-) <f(@) sf(+) = inf f(*).
a<t<x x<t<b
Furthermore, ifa<x<y <b, then

f(x+) <f(v—).

Analogous results evidently hold for monotonically decreasing functions.


--- Page 105 ---

96 PRINCIPLES OF MATHEMATICAL ANALYSIS

(27)

(28)

(29)

(30)

Proof By hypothesis, the set of numbers f(/), where a < t < x, is bounded
above by the number f(x), and therefore has a least upper bound which
we shall denote by A. Evidently A </f(x). We have to show that
A = f(x—-).

Let ¢ >0 be given. It follows from the definition of A as a least
upper bound that there exists 6 > 0 such that a< x —6 <x and

A-—e<f(x-—d)<A.
Since fis monotonic, we have
fx -A) Sf SA (x -d<t<x).
Combining (27) and (28), we see that
If(t)-Al<e (x-d<t<x).

Hence f(x—) = A.
The second half of (25) is proved in precisely the same way.
Next, ifa <x <y <b, we see from (25) that

f(xt+) = inf f(t) = inf f(t).
x<t<b x<t<y

The last equality is obtained by applying (25) to (a, y) in place of (a, b).
Similarly,

fQ-)= sup f(t) = sup ft).

Comparison of (29) and (30) gives (26).

Corollary Monotonic functions have no discontinuities of the second kind.

This corollary implies that every monotonic function is discontinuous at

a countable set of points at most. Instead of appealing to the general theorem
whose proof is sketched in Exercise 17, we give here a simple proof which is
applicable to monotonic functions.

4.30 Theorem Let f be monotonic on (a,b). Then the set of points of (a, b) at
which f is discontinuous is at most countable.

Proof Suppose, for the sake of definiteness, that f is increasing, and
let E be the set of points at which fis discontinuous.

With every point x of E we associate a rational number r(x) such
that

S(x—) < r(x) <f(x+).


--- Page 106 ---

CONTINUITY 97

Since x, <x, implies f(x,+)</f(x.—), we see that r(x,) #r(x2) if
x, F<Xx 2°

We have thus established a 1-1 correspondence between the set E and
a subset of the set of rational numbers. The latter, as we know, is count-
able.

4.31 Remark It should be noted that the discontinuities of a monotonic
function need not be isolated. In fact, given any countable subset E of (a, 5),
which may even be dense, we can construct a function f, monotonic on (a, 5),
discontinuous at every point of Z, and at no other point of (a, 5).

To show this, let the points of E be arranged in a sequence {x,},

n=1, 2, 3,.... Let {c,} be a sequence of positive numbers such that Zc,
converges. Define
(31) fM=Yaq (@<x<d).

Xn<x

The summation is to be understood as follows: Sum over those indices n
for which x, <x. If there are no points x, to the left of x, the sum is empty;
following the usual convention, we define it to be zero. Since (31) converges
absolutely, the order in which the terms are arranged is immaterial.

We leave the verification of the following properties of f to the reader:

(a) fis monotonically increasing on (a, b);
(b) fis discontinuous at every point of £; in fact,

fn +) —f$n-) = Cn
(c) fis continuous at every other point of (a, b).

Moreover, it is not hard to see that f(x—) = f(x) at all points of (a, 5). If
a function satisfies this condition, we say that f is continuous from the left. If
the summation in (31) were taken over all indices n for which x, < x, we would
have f(x+) =/(x) at every point of (a, b); that is, f would be continuous from
the right.

Functions of this sort can also be defined by another method; for an
example we refer to Theorem 6.16.

INFINITE LIMITS AND LIMITS AT INFINITY

To enable us to operate in the extended real number system, we shall now
enlarge the scope of Definition 4.1, by reformulating it in terms of neighborhoods.

For any real number x, we have already defined a neighborhood of x to
be any segment (x — 6, x + 6).


--- Page 107 ---

98 PRINCIPLES OF MATHEMATICAL ANALYSIS

4.32 Definition For any real c, the set of real numbers x such that x > is
called a neighborhood of + oo and is written (c, + 00), Similarly, the set (— 0, c)
is a neighborhood of —o.

4.33 Definition Let f be a real function defined on E< R. We say that
f(t) 7A as tx,

where A and x are in the extended real number system, if for every neighborhood
U of A there is a neighborhood V of x such that V cq E is not empty, and such
that f(t)e U forall teVnE, t#x.

A moment’s consideration will show that this coincides with Definition
4.1 when A and x are real.

The analogue of Theorem 4.4 is still true, and the proof offers nothing
new. We state it, for the sake of completeness.

4.34 Theorem Let f and g be defined on E < R. Suppose

I(t)-7A, g(t) >B as t~>x.
Then
(a) f(t)~A’ implies A’ =A.
(6+) F+gt)7 A+B,
(ce) (f9)(t) > AB,
(Z) (fig\t) > A/B,
provided the right members of (b), (c), and (d) are defined.
Note that co — 00, 0° 00, 00/00, A/O are not defined (see Definition 1.23).

EXERCISES
1. Suppose fis a real function defined on R! which satisfies

lim [f(x + h) — fe — A) =0

for every x € R!. Does this imply that fis continuous?
2. If fis a continuous mapping of a metric space X into a metric space Y, prove that

S(E) < f(E)

for every set E< X. (E denotes the closure of E.) Show, by an example, that
S(E) can be a proper subset of f(Z).

3. Let fbe a continuous real function on a metric space X. Let Z(/) (the zero set of f)
be the set of all p € X at which f(p) =0. Prove that Z(/) is closed.

4. Let f and g be continuous mappings of a metric space Y into a metric space Y,


--- Page 108 ---

Pad

10.

11,

12,

13.

CONTINUITY 99

and let E be a dense subset of X. Prove that f(E) is dense in f(X). If g(p) =f(p)
for all p< E, prove that g(p) =f(p) for all pe X. (In other words, a continuous
mapping is determined by its values on a dense subset of its domain.)

. If fis a real continuous function defined on a closed set E < R', prove that there

exist continuous real functions g on R! such that g(x) =f(x) for all x ¢ £. (Such
functions g are called continuous extensions of f from E to R'.) Show that the
result becomes false if the word “closed” is omitted. Extend the result to vector-
valued functions. Hint: Let the graph of g be a straight line on each of the seg-
ments which constitute the complement of E (compare Exercise 29, Chap. 2).
The result remains true if R' is replaced by any metric space, but the proof is not
so simple.

. If fis defined on E, the graph of f is the set of points (x, f(x)), for x ¢ E. In partic-

ular, if E is a set of real numbers, and fis real-valued, the graph of fis a subset of
the plane.

Suppose E is compact, and prove that fis continuous on E if and only if
its graph is compact.
If E¢ X and if fis a function defined on _X, the restriction of f to E is the function
g whose domain of definition is E, such that g(p) =f(p) for pe E. Define fand g
on R? by: f(0, 0) =g(0, 0) =0, f(x, ») = xy?/(x? + ¥*), g(x, y) = xy?/(x? + ¥*)
if (x, y) 4(0, 0). Prove that f is bounded on R?, that g is unbounded in every
neighborhood of (0, 0), and that f is not continuous at (0, 0); nevertheless, the
restrictions of both f and g to every straight line in R? are continuous!
Let f be a real uniformly continuous function on the bounded set Ein R'. Prove
that f is bounded on E.

Show that the conclusion is false if boundedness of E is omitted from the
hypothesis.

. Show that the requirement in the definition of uniform continuity can be rephrased

as follows, in terms of diameters of sets: To every ¢ > 0 there exists a 5 > 0 such
that diam f(£) <« for all E< X with diam E < 5.
Complete the details of the following alternative proof of Theorem 4.19: If fis not
uniformly continuous, then for some ¢ > 0 there are sequences {p,}, {g,} in X such
that dx(pn, qn) > 0 but dy(f(p,), f(qn)) > €. Use Theorem 2.37 to obtain a contra-
diction.
Suppose f is a uniformly continuous mapping of a metric space X into a metric
space Y and prove that (/(x,)} is a Cauchy sequence in Y for every Cauchy se-
quence {x,} in X. Use this result to give an alternative proof of the theorem stated
in Exercise 13.
A uniformly continuous function of a uniformly continuous function is uniformly
continuous.

State this more precisely and prove it.
Let E be a dense subset of a metric space X, and let f be a uniformly continuous
real function defined on EZ. Prove that fhas a continuous extension from E to X


--- Page 109 ---

100 PRINCIPLES OF MATHEMATICAL ANALYSIS

14.

15.

16.

17.

18.

19.

(see Exercise 5 for terminology). (Uniqueness follows from Exercise 4.) Hint: For
each pé X and each positive integer n, let V.(p) be the set of all ge EZ with
d(p, q) < 1/n. Use Exercise 9 to show that the intersection of the closures of the
sets {(V.(p)), f(V2(p)), ..., consists of a single point, say g(p), of R'. Prove that
the function g so defined on X is the desired extension of /.

Could the range space R' be replaced by R*? By any compact metric space?
By any complete metric space? By any metric space?
Let I = [0, 1] be the closed unit interval. Suppose fis a continuous mapping of I
into Z, Prove that f(x) = x for at least one x € I.
Call a mapping of X into Y open if f(V) is an open set in Y whenever V is an open
set in X.

Prove that every continuous open mapping of R? into R! is monotonic.
Let [x] denote the largest integer contained in x, that is, [x] is the integer such
that x — 1 < [x] <x; and let (x) = x — [x] denote the fractional part of x. What
discontinuities do the functions [x] and (x) have?
Let f be a real function defined on (a, 6). Prove that the set of points at which f
has a simple discontinuity is at most countable. Hint: Let E be the set on which
S(x—-) <f(«+). With each point x of E, associate a triple (p,q, r) of rational
numbers such that
(a) f(x—) <p <f(x+),
(b) a<q<t<x implies f(t) <p,
(ec) x<t<r<b implies f(2) > p.
The set of all such triples is countable. Show that each triple is associated with at
most one point of £. Deal similarly with the other possible types of simple dis-
continuities.
Every rational x can be written in the form x = m/n, where n > 0, and m and n are
integers without any common divisors. When x = 0, we take n = 1. Consider the
function f defined on R‘' by

0 (x irrational),
f@~= 41 _m
n ny

Prove that fis continuous at every irrational point, and that fhas a simple discon-
tinuity at every rational point.
Suppose f is a real function with domain R! which has the intermediate value
property: If f(a) < c < f(b), then f(x) =c for some x between a and b.

Suppose also, for every rational r, that the set of all x with f(x) = r is closed.

Prove that fis continuous.

Hint: If x, > Xo but f(x,) > r >Sf(xo) for somer and all n, then f(t.) =r
for some ¢, between Xo and x,; thus f, > xo. Find a contradiction. (N. J. Fine,
Amer, Math. Monthly, vol. 73, 1966, p. 782.)


--- Page 110 ---

20.

21.

22.

23.

24.

CONTINUITY 101

If Eis a nonempty subset of a metric space X, define the distance from x € X to E
by
px(x) = inf d(x, z).
zeE

(a) Prove that ps(x) = 0 if and only if x € E.
(6) Prove that pz is a uniformly continuous function on X, by showing that
| pe(x) — pe(y)| <d(x, y)

for all xe X, ye X.

Hint: px(x) <d(x, z) <d(x, y) + dQ, z), so that

px(x) < d(x, y) + pel).

Suppose K and F are disjoint sets in a metric space X, K is compact, F is closed.
Prove that there exists 8 >0 such that d(p,g)>8 if pe K,qeF. Hint: pr isa

continuous positive function on K.
Show that the conclusion may fail for two disjoint closed sets if neither is

compact.
Let A and B be disjoint nonempty closed sets in a metric space X, and define
pa(P)
= e X).
IP) =" m+pup) PS”

Show that fis a continuous function on X whose range lies in [0, 1], that f(p) =0
precisely on A and f(p) = 1 precisely on B. This establishes a converse of Exercise
3: Every closed set A ¢ X is Z(f) for some continuous real fon X. Setting

show that V and W are open and disjoint, and that A < V, Bc W. (Thus pairs of
disjoint closed sets in a metric space can be covered by pairs of disjoint open sets.

This property of metric spaces is called normality.)
A real-valued function f defined in (a, b) is said to be convex if

S(Ax + (1 = Ay) SAF) + (1 — ASO)

whenever a <x<b,a<y<b,0<A<1. Prove that every convex function is
continuous. Prove that every increasing convex function of a convex function is
convex. (For example, if f is convex, so is e*.)

If fis convex in (a, b) and ifa<s<t<u<b, show that

fO-FE) FM -FO) — fW- FO)
t—s u-s u—t

Assume that f is a continuous real function defined in (a, 6) such that

xty\ f@®)+f0)
f (2) <.

for all x, y € (a, b). Prove that fis convex.


--- Page 111 ---

102 PRINCIPLES OF MATHEMATICAL ANALYSIS

25. If Ac R* and BC R*, define A + B to be the set of all sums x + y with xe A,

yes.
(a) If K is compact and C is closed in R*, prove that K + C is closed.

Hint: Take z¢ K+ C, put F=z-— C, the set of all z— y with ye C. Then
K and F are disjoint. Choose 6 as in Exercise 21. Show that the open ball with
center z and radius 8 does not intersect K + C.
(6) Let « be an irrational real number. Let C, be the set of all integers, let C, be
the set of all nx with ne C,. Show that C, and C, are closed subsets of R’ whose
sum C; + C. is not closed, by showing that C, + C2 is a countable dense subset
of R}.

26. Suppose X, Y, Z are metric spaces, and Y is compact. Let f map X into Y, let
g be a continuous one-to-one mapping of Y into Z, and put A(x) =g(/(x)) for
xeEXx,

Prove that f is uniformly continuous if 4 is uniformly continuous.

Hint: g~' has compact domain g(Y), and f(x) = 97 ‘(A(x)).

Prove also that fis continuous if A is continuous.

Show (by modifying Example 4.21, or by finding a different example) that
the compactness of Y cannot be omitted from the hypotheses, even when X and
Z are compact.


--- Page 112 ---

5

DIFFERENTIATION

In this chapter we shall (except in the final section) confine our attention to real
functions defined on intervals or segments. This is not just a matter of con-
venience, since genuine differences appear when we pass from real functions to
vector-valued ones. Differentiation of functions defined on R* will be discussed
in Chap. 9.

THE DERIVATIVE OF A REAL FUNCTION

5.1 Definition Let f be defined (and real-valued) on [a, b]. For any x ¢€ [a, b]

form the quotient

f(t) -f@)
x

_ (a<t<b,t#>x),

(1) $(t) =

and define

(2) F(x) = lim $(¢),


--- Page 113 ---

104 PRINCIPLES OF MATHEMATICAL ANALYSIS

provided this limit exists in accordance with Definition 4.1.
We thus associate with the function f a function f’ whose domain
is the set of points x at which the limit (2) exists; f’ is called the derivative

of f.
If f’ is defined at a point x, we say that f is differentiable at x. If f’ is
defined at every point of a set E < [a, b], we say that fis differentiable on E.
It is possible to consider right-hand and left-hand limits in (2); this leads
to the definition of right-hand and left-hand derivatives. In particular, at the
endpoints a and 3, the derivative, if it exists, is a right-hand or left-hand deriva-
tive, respectively. We shall not, however, discuss one-sided derivatives in any

detail.
If f is defined on a segment (a, b) and if a < x <b, then f’(x) is defined

by (1) and (2), as above. But /’(a) and f(b) are not defined in this case.

5.2 Theorem Let f be defined on [a, b]. If f is differentiable at a point x é [a, b],
then f is continuous at x.

Proof As t—-x, we have, by Theorem 4.4,

ft) -f) =O 6 yap@-0=0.

t-—

The converse of this theorem is not true. It is easy to construct continuous
functions which fail to be differentiable at isolated points. In Chap. 7 we shall
even become acquainted with a function which is continuous on the whole line
without being differentiable at any point!

5.3. Theorem Suppose f and g are defined on [a, b] and are differentiable at a
point x € [a, b]. Then f + 9, fg, and f/g are differentiable at x, and

@ S+NM=fO+ 9;
(6) (f9)' (x) =F'(g(%) + F009'(x);

() (Z ) (x) = IX) a8 CFO).

In (c), we assume of course that g(x) ¥ 0.
Proof (a) is clear, by Theorem 4.4. Leth =/g. Then
A(t) — h(x) =f@)[9@) — 9@)] + GOP — FOI.


--- Page 114 ---

DIFFERENTIATION 105

If we divide this by ¢ — x and note that f(t) > f(x) as t > x (Theorem 5.2),
(6) follows. Next, let h =f/g. Then

ht)—-hx) 1 fi O° a) a- g(x)
t—x  —_g(t)g(x) wate |9° ay IM aera

Letting t + x, and applying Theorems 4.4 and 5.2, we obtain ©

5.4 Examples The derivative of any constant is clearly zero. If f is defined
by f(x) = x, then f’(x) = 1. Repeated application of (0) and (c) then shows that
x" is differentiable, and that its derivative is nx"~1, for any integer n (if 2 <0,
we have to restrict ourselves to x #0). Thus every polynomial is differentiable,
and so is every rational function, except at the points where the denominator is
zero.

The following theorem is known as the “chain rule’’ for differentiation.
It deals with differentiation of composite functions and is probably the most
important theorem about derivatives. We shall meet more general versions of it
in Chap. 9.

5.5 Theorem Suppose f is continuous on [a, b], f’(x) exists at some point
x € [a, b], g is defined on an interval I which contains the range of f, and g is
differentiable at the point f(x). If

At)=9(f()) (astsbd),
then h is differentiable at x, and

(3) h(x) = 9 F@)F'@).

Proof Let y =f(x). By the definition of the derivative, we have
(4) f(t) —f£@) = (¢ — Lf") + ue),
(5) G(s) — gy) = (5 — yg’) + v9],

where te [a, 5), se J, and u(t) +0 as tx, o(s) +0 assy. Lets =f(t).
Using first (5) and then (4), we obtain
A(t) — hx) = g(F(t)) — 9F@)
= [f(t) —£@)]: [9’G) + o)]
= (t— x): [f'(x) + u(t) [9'O) + o(9)],
or, if t # x,

6 ie) — We)

axe TH LI'O) + (9) TFG) + uD).

Letting t > x, we see that sy, by the continuity of f, so that the right
side of (6) tends to g’(y)f’(x), which gives (3).


--- Page 115 ---

106 PRINCIPLES OF MATHEMATICAL ANALYSIS

5.6 Examples
(a) Let f be defined by

|
(7) fe) = x sin x (x #0),

0 (x = 0).
Taking for granted that the derivative of sin x is cos x (we shall

discuss the trigonometric functions in Chap. 8), we can apply Theorems
5.3 and 5.5 whenever x #0, and obtain

(asin Leos!
(8) tf (x) = sin = 7085 (x #0).

At x =0, these theorems do not apply any longer, since 1/x is not defined
there, and we appeal directly to the definition: for ¢ #0,

As t 0, this does not tend to any limit, so that f’(0) does not exist.
(b) Let f be defined by

2 sin
(9) fo) = x* sin x (x #0),
0 (x = 0),

As above, we obtain
, _ 1 1
(10) S'(x) = 2x sin x7 cos x (x #0).

At x = 0, we appeal to the definition, and obtain

F(t) — FO)
0

- <|t}] (#0);

a!
ft sin -
t

letting t > 0, we see that

(11) f'(0) = 0.

Thus f is differentiable at all points x, but f’ is not a continuous
function, since cos (1/x) in (10) does not tend to a limit as x - 0,


--- Page 116 ---

DIFFERENTIATION 107

MEAN VALUE THEOREMS

5.7 Definition Let f be a real function defined on a metric space X. We say
that f has a local maximum at a point p € X if there exists 6 > 0 such that f(g) <
F(p) for all ge X with d(p, q) < 6.

Local minima are defined likewise.
Our next theorem is the basis of many applications of differentiation.
5.8 Theorem Let f be defined on [a, b]; if f has a local maximum at a point
x € (a, b), and if f'(x) exists, then f’(x) = 0.
The analogous statement for local minima is of course also true.
Proof Choose 6 in accordance with Definition 5.7, so that
a<x-d<x<x+td<b.

Ifx—-d<t<-x, then
fO-f@, 4
t-—-x

Letting 1 x, we see that f’(x) = 0.
Ifx<t<x+, then

fi) 7) <4
t-—x
which shows that f’(x) < 0. Hence f’(x) = 0.

5.9 Theorem If f and g are continuous real functions on [a,b] which are
differentiable in (a, b), then there is a point x & (a, b) at which

[f(6) — F@lg'(x) = (96) — g(a) f'@).
Note that differentiability is not required at the endpoints.
Proof Put
A(t) = [f() —f@lg@) - (96) -9@ISC)  (astsbd).
Then A is continuous on [a, 5], 4 is differentiable in (a, 6), and
(12) h(a) = f(b)9(@) — f(a)g(6) = h(d).

To prove the theorem, we have to show that h’(x) = 0 for some x € (a, b).
If h is constant, this holds for every xe (a, b). If A(t) > h(a) for
some ¢ € (a, b), let x be a point on [a, b] at which A attains its maximum


--- Page 117 ---

108 PRINCIPLES OF MATHEMATICAL ANALYSIS

(Theorem 4.16). By (12), x € (a, b), and Theorem 5.8 shows that h’(x) = 0.
If h(t) < h(a) for some ¢ € (a, b), the same argument applies if we choose
for x a point on [a, b] where / attains its minimum.

This theorem is often called a generalized mean value theorem; the following
special case is usually referred to as “‘the’’ mean value theorem:

5.10 Theorem If fis a real continuous function on [a, b] which is differentiable
in (a, b), then there is a point x € (a, b) at which
f(b) — fla) = (6 — a) f(x).
Proof Take g(x) = x in Theorem 5.9.

5.11 Theorem Suppose f is differentiable in (a, b).
(a) If f'(x) = 0 for all x € (a, b), then f is monotonically increasing.
(6) Iff'(x*) =0 for all x € (a, b), then f is constant.
(c) Iff'(x) <0 for all x € (a, b), then f is monotonically decreasing.

Proof All conclusions can be read off from the equation

F(%2) — f%1) = 2 — x) S'O),

which is valid, for each pair of numbers x,, x, in (a, b), for some x between
x, and x2.

THE CONTINUITY OF DERIVATIVES

We have already seen [Example 5.6(5)] that a function f may have a derivative
J’ which exists at every point, but is discontinuous at some point. However, not
every function is a derivative. In particular, derivatives which exist at every
point of an interval have one important property in common with functions
which are continuous on an interval: Intermediate values are assumed (compare
Theorem 4.23). The precise statement follows.

5.12 Theorem Suppose f is a real differentiable function on [a, b] and suppose
S'(a) <4<f'(6). Then there is a point x € (a, b) such that f'(x) = 2.
A similar result holds of course if f’(a) > f'(6).
Proof Put g(t) =/(t) — At. Then g’(a) < 0, so that g(t,) < g(a) for some
t, € (a, b), and g’(b) > 0, so that g(t.) < g(b) for some t, € (a, b). Hence

g attains its minimum on [a, b] (Theorem 4.16) at some point x such that
a<x<b. By Theorem 5.8, g(x) =0. Hence f(x) =A.


--- Page 118 ---

DIFFERENTIATION 109
Corollary If f is differentiable on [a,b], then f' cannot have any simple dis-
continuities on [a, b].

But f’ may very well have discontinuities of the second kind.

L’HOSPITAL’S RULE

The following theorem is frequently useful in the evaluation of limits.

5.13 Theorem Suppose f and g are real and differentiable in (a, b), and g'(x) #0
for all x € (a, b), where -00 Sa<b< +00. Suppose

(13) + A as xa.
if

(14) I(x) 70 and g(x) > 0 as x >,
or if

(15) g(x) — +0 as xa,
then

(16) Os Aas x04,

The analogous statement is of course also true if x > b, or if g(x) ~ —00
in (15). Let us note that we now use the limit concept in the extended sense of
Definition 4.33.

Proof We first consider the case in which —0o < A < +0. Choosea
real number q such that A <q, and then choose r such that A <r <q.
By (13) there is a point c € (a, 5) such that a < x < c implies

f'@)
(17) LAX)
g(x)
If a<x<y<c, then Theorem 5.9 shows that there is a point te (x, y)
such that
(18) f)-f)_SO_,

9x) -90) gO”
Suppose (14) holds. Letting x — a in (18), we see that
fY)

(19) —<<r<q (a<y<c).

gy)


--- Page 119 ---

110 PRINCIPLES OF MATHEMATICAL ANALYSIS

Next, suppose (15) holds. Keeping y fixed in (18), we can choose
a point c, € (a, y) such that g(x) > g(y) and g(x) > Oifa<x<c,. Multi-
plying (18) by [9(x) — g(y)/g(x), we obtain
£) 9) _ f%

20 —<re- + — a<x<c,).
e) aa)" "ge)* oa) @<*<
If we let x >a in (20), (15) shows that there is a point c, € (a, c,)
such that
f(x)
21 < a<x<Cy).
(21) wo! 2)

Summing up, (19) and (21) show that for any q, subject only to the
condition A < gq, there is a point c, such that f(x)/g(x) <q ifa<x<c,.

In the same manner, if —00 <A < +00, and p is chosen so that
p < A, we can find a point c3 such that

tf”)
g(x)

and (16) follows from these two statements.

(22) (a<x<cs),

DERIVATIVES OF HIGHER ORDER

5.14 Definition Iffhas a derivative f’ on an interval, and iff’ is itself differen-
tiable, we denote the derivative of f’ by f” and call f” the second derivative of f.
Continuing in this manner, we obtain functions

LL SL L™, eo f™,
each of which is the derivative of the preceding one. f is called the nth deriva-
tive, or the derivative of order n, of f.

In order for f™ (x) to exist at a point x, f~») (+) must exist in a neighbor-
hood of x (or in a one-sided neighborhood, if x is an endpoint of the interval
on which f is defined), and f~ 1) must be differentiable at x. Since f"~*) must
exist in a neighborhood of x, f“"~?) must be differentiable in that neighborhood.

TAYLOR’S THEOREM

5.15 Theorem Suppose f is a real function on [a, b], n is a positive integer,
f""-» is continuous on [a, b], f(t) exists for every t € (a, b). Let a, B be distinct
points of {a, b], and define

(23) P(t) = pa 0)

=0

— a)‘.


--- Page 120 ---

DIFFERENTIATION 111

Then there exists a point x between « and B such that

LR)

n!

(24) F(B) = P(B) + (B — 4)”.

For n = 1, this is just the mean value theorem. In general, the theorem
shows that f can be approximated by a polynomial of degree n — 1, and that
(24) allows us to estimate the error, if we know bounds on |f(x)|.

Proof Let M be the number defined by
(25) F(B) = P(B) + M(B — a)"
and put
(26) gt)=f(t)-P(t)- Mit-—o«)" (a<t<b).
We have to show that n!M =f (x) for some x between « and f. By
(23) and (26),
(27) I(t) =fOt)—n'IM (a<t<b).
Hence the proof will be complete if we can show that g(x) = 0 for some
x between a and £.
Since P(g) = f(a) for k =0,...,n — 1, we have
(28) g(a) =9'(@) = + = g"" (a) = 0.

Our choice of M shows that g(f) =0, so that g’(x,) =0 for some x,
between « and #, by the mean value theorem. Since g'(«) = 0, we conclude
similarly that g’(x.) = 0 for some x, between « and x,. After n steps we
arrive at the conclusion that g‘(x,) = 0 for some x, between « and x, _,,
that is, between « and f.

DIFFERENTIATION OF VECTOR-VALUED FUNCTIONS

5.16 Remarks Definition 5.1 applies without any change to complex functions
J defined on [a, b], and Theorems 5.2 and 5.3, as well as their proofs, remain
valid. If f, and f, are the real and imaginary parts of f, that is, if

f() =A) + ft)
fora <t <b, where f,(t) and f,(t) are real, then we clearly have

(29) f(x) =fi@) + #2);
also, f is differentiable at x if and only if both f, and f, are differentiable at x.


--- Page 121 ---

112 PRINCIPLES OF MATHEMATICAL ANALYSIS

Passing to vector-valued functions in general, i.e., to functions f which
map [a, b] into some R*, we may still apply Definition 5.1 to define f’(x). The
term ¢(t) in (1) is now, for each #, a point in R*, and the limit in (2) is taken with
respect to the norm of R*. In other words, f’(x) is that point of R* (if there is
one) for which

f(t) — OR

(30) lim | —

tox

—f )|=°.

and f’ is again a function with values in R*.
If fi, »--> f are the components of f, as defined in Theorem 4.10, then

(31) f’ = (fi, «+s fe)s

and f is differentiable at a point x if and only if each of the functions f,, ..., f,
is differentiable at x.

Theorem 5.2 is true in this context as well, and so is Theorem 5.3(a) and
(b), if fg is replaced by the inner product f- g (see Definition 4.3).

When we turn to the mean value theorem, however, and to one of its
consequences, namely, L’Hospital’s rule, the situation changes. The next two
examples will show that each of these results fails to be true for complex-valued
functions.

5.17 Example Define, for real x,
(32) f(x) = e* =cos x + isin x.

(The last expression may be taken as the definition of the complex exponential
e'*; see Chap. 8 for a full discussion of these functions.) Then

(33) f(2n) —f(0) =1-1=0,
but
(34) f(x) = ie,

so that |f’(x)| =1 for all real x.
Thus Theorem 5.10 fails to hold in this case.
5.18 Example On the segment (0, 1), define f(x) = x and
(35) g(x) =x + x7ei!*?,
Since |e''| = 1 for all real ¢, we see that

f@&)
(36) lim Fp =


--- Page 122 ---

DIFFERENTIATION 113

Next,
(37) g(x) =1+ [ox - =| el? O<x<1),
so that

' 2i 2
(38) 1v'o)| 2 pe —2 1221,
Hence

soy} lk
) 7@| lee © 2—x
and so
L(x)

(40) lim 7 0.

By (36) and (40), L’Hospital’s rule fails in this case. Note also that g’(x) #0
on (0, 1), by (38).

However, there is a consequence of the mean value theorem which, for
purposes of applications, is almost as useful as Theorem 5,10, and which re-
mains true for vector-valued functions: From Theorem 5.10 it follows that

(41) YF -f@| <—a) sup [OI

5.19 Theorem Suppose f is a continuous mapping of [a,b] into R* and f is
differentiable in (a, b). Then there exists x € (a, b) such that

|£() - f(a)| < (6 — a)|f'()|.
Proof! Put z = f(b) — f(a), and define
pt)=zf(t) (@st<bd).

Then ¢ is a real-valued continuous function on [a, b] which is differentia-
ble in (a, b). The mean value theorem shows therefore that

pb) — pa) = (6 — a)p'(x) = (b — az f(x)

for some x € (a, 6). On the other hand,
o(b) — (a) = 2° f(b) —z* f(a) =z°2 = |z|?.

The Schwarz inequality now gives
|z|? = (6 —a)|z-f'(x)| < (6 — a)|z| |f'@)|.

Hence {z| < (b — a){f‘(x)|, which is the desired conclusion.

1V, P. Havin translated the second edition of this book into Russian and added this
proof to the original one.


--- Page 123 ---

114 PRINCIPLES OF MATHEMATICAL ANALYSIS

EXERCISES
1. Let f be defined for all real x, and suppose that
f(x) —fO)| <(& — y)?
for all real x and y. Prove that fis constant.

2. Suppose f’(x) > 0 in (a, 6). Prove that fis strictly increasing in (a, b), and let g be
its inverse function. Prove that g is differentiable, and that
1
‘SF Q) => a<x <b),
ISO=Fy )

3. Suppose g is a real function on R', with bounded derivative (say |g’| <M). Fix
€ > 0, and define f(x) = x + eg(x). Prove that fis one-to-one if ¢ is small enough.
(A set of admissible values of ¢ can be determined which depends only on M.)

4. If

C1 Cn-1 Ch
Co+ > toot a + nti 0,
where Co, ..., C, are real constants, prove that the equation

Cot Cre tee 4+ Caiix" "1+ Cx" =0

has at least one real root between 0 and 1.
5. Suppose fis defined and differentiable for every x > 0, and f(x) +0 as x > + 0,
Put g(x) =f/(x + 1)—f(x). Prove that g(x) ~0asx >+o.,
6. Suppose
(a) fis continuous for x > 0,
(6) f’(x) exists for x > 0,

(c) f(0) =0,
(d) f’ is monotonically increasing.
Put

g(x) = (x >0)

£@)
x
and prove that g is monotonically increasing.
7. Suppose f’(x), g’(x) exist, g(x) #0, and f(x) = g(x) =0. Prove that

_ f(t) _ f(x)
lim — = TT
rox Q(t)  g'(x)
(This holds also for complex functions.)
8. Suppose f’ is continuous on [a, 6] and « >0. Prove that there exists § > 0 such
that
S(t) — fx)

ry FO <*


--- Page 124 ---

9.

10.

11.

12.

13.

14,

15,

DIFFERENTIATION 115

whenever 0 < |t—x| <8, a<x<b, a<t<b. (This could be expressed by
saying that fis uniformly differentiable on [a, b]if f’ is continuous on [a, b].) Does
this hold for vector-valued functions too?

Let f be a continuous real function on R?, of which it is known that f’(x) exists
for all x 40 and that f(x) > 3 as x > 0. Does it follow that f‘(0) exists?
Suppose f and g are complex differentiable functions on (0, 1), f(x) — 0, g(x) > 0,
Sf’) > A, g(x) > Bas x -> 0, where A and Bare complex numbers, B #0. Prove
that

lim 5G) B

Compare with Example 5.18. Hint:

£3 {£9 _ 4) = Ak.

g(x) x g(x) g(x)

Apply Theorem 5.13 to the real and imaginary parts of f(x)/x and g(x)/x.
Suppose fis defined in a neighborhood of x, and suppose f’(x) exists. Show that

lim f(x +h) +f — A) — 2f()

40 h?

=f").

Show by an example that the limit may exist even if f’(x) does not.
Hint: Use Theorem 5.13.
If f() =|x|*, compute f(x), £’(x) for all real x, and show that f'(0) does not
exist.
Suppose a and c are real numbers, c > 0, and fis defined on [—1, 1] by

x*sin(|x|"°) (if x #9),

f(x) = ( (if x =0).

Prove the following statements:

(a) fis continuous if and only if a > 0.

(6) f’(0) exists if and only if a> 1.

(c) f’ is bounded if and only if a>1-+ ec.

(da) f’ is continuous if and only if a@>1-+c.

(e) f"(0) exists if and only ifa>2+¢.

(Sf) f’ is bounded if and only if @ > 2+ 2c.

(g) f” is continuous if and only if a > 2 + 2e.

Let f be a differentiable real function defined in (a, 6). Prove that f is convex if
and only if f’ is monotonically increasing. Assume next that f’(x) exists for
every x € (a, 5), and prove that fis convex if and only if f’(x) >0 for all x € (a, 6).
Suppose a € R', fis a twice-differentiable real function on (a, 0), and My, M1, M2
are the least upper bounds of |f(x)|, |/’X)|, [f’(x)|, respectively, on (a, 0).
Prove that

Mi <4MoM;z.


--- Page 125 ---

116 PRINCIPLES OF MATHEMATICAL ANALYSIS

Hint: If h > 0, Taylor’s theorem shows that
1 ”
f'@) = Th [f(x + 2h) — f(x)] — Af")
for some & € (x, x + 2h). Hence

[f'CO] <hM, +72.

To show that M? = 4M, M; can actually happen, take a = —1, define
2x? —1 (—1<x <0),

I(x) = (x? -1
x?+1

(O<x < 0),

and show that Mo = 1, M, = 4, M2, =4.
Does M? <4M, Mz hold for vector-valued functions too?
16. Suppose f is twice-differentiable on (0, 00), f” is bounded on (0, 0), and f(x) > 0
as x» 00, Prove that f’(x) > 0 asx > o.
Hint: Let a — o in Exercise 15.
17. Suppose fis a real, three times differentiable function on [—1, 1], such that
f(-)=0, f@®=0, fi)=1, fO=
Prove that f(x) > 3 for some x € (—1, 1).
Note that equality holds for 4(x* + x?).
Hint: Use Theorem 5.15, with a =0 and 8 = +1, to show that there exist
s €(0, 1) and ¢ € (—1, 0) such that
FMS) + LM) = 6.
18. Suppose f is a real function on [a, 5), 7 is a positive integer, and f‘"-"” exists for
every ft € [a, 6]. Let «, 8, and P be as in Taylor’s theorem (5.15). Define
t
on = f= a

for t € [a, 6], ¢ +B, differentiate
f(t) — f(B) = (t — B)Q(t)
n— 1 times at t =, and derive the oni version of Taylor’s theorem:

f@) = P@ + ZO @- ay,
19. Suppose f is defined in (—1, 1) and £0) exists. Suppose —1<a,<8, <1,
&%, —> 0, and 8, 0 as n -> 00, Define the difference quotients
Bn — &n


--- Page 126 ---

20.

21.

22.

23.

DIFFERENTIATION 117

Prove the following statements:

(a) If a, <0 <8,, then lim D, =/’(0).

(6) If 0 <a, <P, and {Bn/(Bx — %n)} is bounded, then lim D, = f’(0).
(c) If f’ is continuous in (—1, 1), then lim D, =/f’(0).

Give an example in which fis differentiable in (—1, 1) (but f’ is not contin-
uous at 0) and in which «,, 8, tend to 0 in such a way that lim D, exists but is differ-
ent from f’(0).

Formulate and prove an inequality which follows from Taylor’s theorem and
which remains valid for vector-valued functions.

Let E be a closed subset of R'. We saw in Exercise 22, Chap. 4, that there is a
real continuous function fon R! whose zero set is E. Is it possible, for each closed
set E, to find such an f which is differentiable on R', or one which is 7 times
differentiable, or even one which has derivatives of all orders on R'?

Suppose / is a real function on (— 0, 0). Call x a fixed point of f if f(x) =x.
(a) If fis differentiable and f’(r) #1 for every real t, prove that f has at most one
fixed point.

(b) Show that the function f defined by

fM=t+Ud+e)7?

has no fixed point, although 0 < f(t) < 1 for all real ¢.

(c) However, if there is a constant A < 1 such that |f’(t)| < A for all real t, prove
that a fixed point x of f exists, and that x = lim x,, where x, is an arbitrary real
number and

Xn+1 =f (Xn)

forn=1,2,3,....
(d) Show that the process described in (c) can be visualized by the zig-zag path

(X1, X2) > (Xa, X2) > (X12, X3) > (X3, X3) > (X%3,, Xa) He.
The function f defined by

xe+1

f= Fy

has three fixed points, say «, 8, y, where
—2<a<—l, 0<f<1, 1<y<2.

For arbitrarily chosen x:, define {x,} by setting xn41 =f (xn).
(a) If x1 <«, prove that x, > —oo asn > 0.

(b) Ifa <x, </-, prove that x, > 8 asn— 00.

(c) If y <x1, prove that x, > +00 asn — 00,

Thus 8 can be located by this method, but « and y cannot.


--- Page 127 ---

118 PRINCIPLES OF MATHEMATICAL ANALYSIS

24, The process described in part (c) of Exercise 22 can of course also be applied to
functions that map (0, 00) to (0, 0).
Fix some « > 1, and put

f~= (« + *), g(x) = —.

Both f and g have V« as their only fixed point in (0, ©). Try to explain, on the
basis of properties of f and g, why the convergence in Exercise 16, Chap. 3, is so
much more rapid than it is in Exercise 17. (Compare /’ and g’, draw the zig-zags
suggested in Exercise 22.)

Do the same when 0 < « < 1.

25. Suppose f is twice differentiable on [a, 6], f(a) <0, f(b) >0, f(x) > 6 >0, and
0<f’(x) <M for all x €[a, b]. Let € be the unique point in (a, b) at which
f() =0.

Complete the details in the following outline of Newton’s method for com-
puting ¢.
(a) Choose x: € (£, b), and define {x,} by

_ I (Xn) .
f'n)
Interpret this geometrically, in terms of a tangent to the graph of f.
(6) Prove that x.41: <x, and that

Xn+1 =Xn

lim x, = &.
(c) Use Taylor’s theorem to show that

f(t)
2f' (Xn)

Naar —€= (%_ — £)?
for some tn € (£, Xn).
(d) If A = M/28, deduce that

0S mer — €S 5A — OF"

(Compare with Exercises 16 and 18, Chap. 3.)
(e) Show that Newton’s method amounts to finding a fixed point of the function

g defined by
_  £O)

How does g’(x) behave for x near €?
(f) Put f(x) = x'/3 on (—, 0) and try Newton’s method. What happens?


--- Page 128 ---

26.

27,

28.

29,

DIFFERENTIATION 119

Suppose f is differentiable on [a, b], f(a) =0, and there is a real number A such
that |/’(x)| < Alf(x)| on [a, 6). Prove that f(x) =0 for all x € [a, b]. Hint: Fix

Xo € [a, 5], let
Mo =sup| f(x)|, Mi =sup|f’(x)|

fora<x<xXo. For any such x,
f(x) | < Miro — a) < A(X0 — a)Mo.
Hence M, = 0 if A(xo — a) < 1. That is, f=0 on [a, xo]. Proceed.
Let ¢ be a real function defined on a rectangle R in the plane, given by a<x<b,
a<y<f. A solution of the initial-value problem
y=¢(x,y), ywa=c (ax<ec<f)

is, by definition, a differentiable function fon [a, b] such that f(a) =c, a <f(x) <8,
and

fO=b6a fi) (@<x<d),
Prove that such a problem has at most one solution if there is a constant A such
that

| (x, v2) ~ d&%, ¥1)| SAly2— |
whenever (x, y1) € R and (x, y2) E R.

Hint: Apply Exercise 26 to the difference of two solutions. Note that this

uniqueness theorem does not hold for the initial-value problem

y=y'?, 0) =0,
which has two solutions: f(x) = 0 and f(x) = x?/4. Find all other solutions.
Formulate and prove an analogous uniqueness theorem for systems of differential
equations of the form

Vy =X, Viy+-- Yd, = va)=ey  (F=1,..., &).
Note that this can be rewritten in the form
y=9o0,y), yla)=c
where y =()1,..., ¥x) ranges over a k-cell, is the mapping of a (& + 1)-cell
into the Euclidean k-space whose components are the functions ¢1,..., dx, and

is the vector (c1,..., cx). Use Exercise 26, for vector-valued functions.
Specialize Exercise 28 by considering the system

Vy = Vaan (j=1,...,4—-1),
k
Yi = SX) — Py GNX);
where f, 91, ..., 9 are continuous real functions on [a, 6], and derive a uniqueness
theorem for solutions of the equation
YO + glayE-P ++ gad’ + ay =f»),
subject to initial conditions

Ya=a, Y@=er, ..., yO Mae.


--- Page 129 ---

6

THE RIEMANN-STIELTJES INTEGRAL

The present chapter is based on a definition of the Riemann integral which
depends very explicitly on the order structure of the real line. Accordingly,
we begin by discussing integration of real-valued functions on intervals. Ex-
tensions to complex- and vector-valued functions on intervals follow in later
sections. Integration over sets other than intervals is discussed in Chaps. 10

and 11.

DEFINITION AND EXISTENCE OF THE INTEGRAL
6.1 Definition Let [a,b] be a given interval. By a partition P of [a,b] we
mean a finite set of points xo, x1, ..., X,, where
A=Xy SX S'S X%,-1 SX, =).
We write

Ax; =X, — Xi-1 (G=1,...,7).


--- Page 130 ---

THE RIEMANN-STIELTJES INTEGRAL 121

Now suppose f is a bounded real function defined on [a, b]. Corresponding to
each partition P of [a, b] we put

M,=supf(x)  (%-1 Sx <%),
m, = inf f(x) (x;-1 Sx < %,),

UPS) -y M, Ax,,

L(P,f) = 3m Ax,

and finally

) [ fax = int UEP)
5

Q) [ fax = sup L(P, f),

where the inf and the sup are taken over all partitions P of [a, 5]. The left
members of (1) and (2) are called the wpper and lower Riemann integrals of f
over [a, 6], respectively. ;

If the upper and lower integrals are equal, we say that f is Riemann-
integrable on [a, b], we write fe @ (that is, # denotes the set of Riemann-
integrable functions), and we denote the common value of (1) and (2) by

Q) [ fax,
or by

b
(4) [ #09 ax.

This is the Riemann integral of f over [a, 5]. Since f is bounded, there
exist two numbers, m and M, such that

m<f(xy)<M (asxsb).
Hence, for every P,
m(b — a) < L(P, f) < U(P,f) < M(b — a),
so that the numbers L(P, f) and U(P,f) form a bounded set. This shows that
the upper and lower integrals are defined for every bounded function f. The
question of their equality, and hence the question of the integrability of ff is a

more delicate one. Instead of investigating it separately for the Riemann integral,
we shall immediately consider a more general situation.


--- Page 131 ---

122 PRINCIPLES OF MATHEMATICAL ANALYSIS

6.2 Definition Let « be a monotonically increasing function on [a, b] (since
a(a) and a(b) are finite, it follows that a is bounded on [a, b]). Corresponding to
each partition P of [a, b], we write

Aa, = a(x;) — a(0%1-1).

It is clear that Aw, >0. For any real function f which is bounded on [a, 5]
we put

UP, S, a) = Y M; Aa;,
t=1

n
LP, f, a) = > mM, Aa,,
i=4
where M;, m, have the same meaning as in Definition 6.1, and we define

ab
(5) i) fda = inf U(P,f, @),

b
©) [ fda = sup LEP, f, a),

the inf and sup again being taken over all partitions.
If the left members of (5) and (6) are equal, we denote their common
value by

) [pe

or sometimes by

b
(8) [ S (x) da(x).

This is the Riemann-Stieltjes integral (or simply the Stieltjes integral) of
JS with respect to «, over [a, 5).

If (7) exists, i-e., if (5) and (6) are equal, we say that fis integrable with
respect to a, in the Riemann sense, and write fe A(a).

By taking o(x) = x, the Riemann integral is seen to be a special case of
the Riemann-Stieltjes integral. Let us mention explicitly, however, that in the
general case « need not even be continuous.

A few words should be said about the notation. We prefer (7) to (8), since
the letter x which appears in (8) adds nothing to the content of (7). It is im-
material which letter we use to represent the so-called ‘variable of integration.”
For instance, (8) is the same as

[ 70) dav).


--- Page 132 ---

THE RIEMANNGSTIELTIJES INTEGRAL 123

The integral depends on f, «, a and , but not on the variable of integration,
which may as well be omitted.

The role played by the variable of integration is quite analogous to that
of the index of summation: The two symbols

n n
Ye, y%
i=1 k=1

mean the same thing, since each means ¢, + cz + **' +¢,.

Of course, no harm is done by inserting the variable of integration, and
in many cases it is actually convenient to do so.

We shal! now investigate the existence of the integral (7). Without saying
so every time, f will be assumed real and bounded, and « monotonically increas-

ing on [a, b]; and, when there can be no misunderstanding, we shall write f in
b

place of f .

6.3 Definition We say that the partition P* is a refinement of P if P* >P

(that is, if every point of P is a point of P*), Given two partitions, P, and P,,
we say that P* is their common refinement if P* = P, U P,.

6.4 Theorem If P* is a refinement of P, then

©) LP, f, x) S L{P*, f, a)
an
(10) U(P*, f, 4) < U(P, f, 2).

Proof To prove (9), suppose first that P* contains just one point more
than P. Let this extra point be x*, and suppose x,;_,< x* <x,, where
X;., and x; are two consecutive points of P. Put

w, = inf f(x) (X;-; <x <x"),
w,=inff@™® (@*<x<x)).
Clearly w, = m,; and w, > m,, where, as before,
m,=inf f(x) = (x;-1 SX S x).
Hence
L(P*, f, «) — L(P, f, «)
= Wy [o(x*) — a(x ;-1)] + wala(x,) — a(x*)] — mfa(x;) — o(x;-1)]
= (Ww, — m,)[ax*) — a(x)-1)] + (w2 — m)[a(x,) — a(x*)] 2 0.

If P* contains k points more than P, we repeat this reasoning k
times, and arrive at (9). The proof of (10) is analogous.


--- Page 133 ---

124 PRINCIPLES OF MATHEMATICAL ANALYSIS

b zb
6.5 Theorem ) fdas i) fda.

Proof Let P* be the common refinement of two partitions P, and P,.
By Theorem 6.4,

L(P,,f, #) < L(P*, f. a) < U(P*, f, a) < U(P2, f, %).
Hence
(11) L(P,f, ®) S U(P2,f, &).
If P, is fixed and the sup is taken over all P,, (11) gives
(12) [fda < UP2,f, %.

The theorem follows by taking the inf over all P, in (12).

6.6 Theorem fe &(«) on [a, b] if and only if for every ¢>0 there exists a
partition P such that

(13) U(P,f, 0) —L(P, fia) <a.
Proof For every P we have
L(P,f. a) < [fdas [fdas UP, fa).

Thus (13) implies
O< [fdu— [fdu<e.

Hence, if (13) can be satisfied for every ¢ > 0, we have

J fda = {f do,
that is, fe B(a).

Conversely, suppose fe #(a), and let e >0 be given. Then there
exist partitions P, and P, such that

(14) U(Prf.9) - f fda < >

(15) [fda — LOPS, a <5.


--- Page 134 ---

THE RIEMANNGSTIELTJES INTEGRAL 125

We choose P to be the common refinement of P, and P,. Then Theorem
6.4, together with (14) and (15), shows that

UP, f, 0) < UP2f,%) < | fdut = <L(Py,fa) +es LPs, a) +6,
so that (13) holds for this partition P.

Theorem 6.6 furnishes a convenient criterion for integrability. Before we
apply it, we state some closely related facts.

6.7 Theorem
(a) If (13) holds for some P and some e, then (13) holds (with the same s)
for every refinement of P.
(b) If (13) holds for P ={xo, .-., X,} and if's;, t; are arbitrary points in
[xi-1, i], then

¥ [fed -F0)| Any <e.
(c) Iff€ Ra) and the hypotheses of (b) hold, then
3 fei) any — [f de

Proof Theorem 6.4 implies (a). Under the assumptions made in (8),
both f(s;) and f(t,) lie in [71;, Mj], so that | f(s;) —f(t)| < M@;—m,. Thus

<é.

»» f(s) —f(t)| Ae; < UPS &) — LOPS, @),
which proves (6). The obvious inequalities

L(P, fa) < Vf (ti) Aa; =< U(P, fa)
L(P, f, 0) < Sfdu< U(P,f, a)

and
prove (c).

6.8 Theorem [ff is continuous on [a, b] then f € Ba) on [a, b].
Proof Let ¢ > 0 be given. Choose y > 0 so that
[a(b) — a(a)]n <.

Since f is uniformly continuous on [a, b] (Theorem 4.19), there exists a
6 > 0 such that

(16) If@) -f@)| <1


--- Page 135 ---

126 PRINCIPLES OF MATHEMATICAL ANALYSIS

if x € [a, b], te [a, 5), and |x —t] <6.
If P is any partition of [a,b] such that Ax, <6 for all i, then (16)
implies that
(17) M,-m,<sn (i-1,...,n)

and therefore
U(P, f, «) — L(P, f, a) = M — my) Aa,

< nd ba = n[a(b) — a(a)] <e.
By Theorem 6.6, fe 2#(a).

6.9 Theorem Jf f is monotonic on [a,b], and if « is continuous on [a, b}, then
SE Ra). (We still assume, of course, that « is monotonic.)

Proof Let e>0 be given. For any positive integer n, choose a partition
such that

da, _ = 20

(@=1,...,7).

This is possible since « is continuous (Theorem 4.23),
We suppose that fis monotonically increasing (the proof is analogous
in the other case). Then

= f(x), m, = f(xi-4) (j=1,...,n),
so that
UPL.%) ~LP,f, 2) =O 5 3 Ved ~Se-0)

= @)— x) YO —f@l<e

if m is taken large enough. By Theorem 6.6, fe A(a).

6.10 Theorem Suppose f is bounded on [a, b), f has only finitely many points
of discontinuity on [a, b], and a is continuous at every point at which f is discon-
tinuous. Then fe A(a).

Proof Let e>0 be given. Put M = sup |f(x)|, let E be the set of points
at which fis discontinuous. Since E is finite and « is continuous at every
point of Z, we can cover E by finitely many disjoint intervals [u,, vj] <
[a, b] such that the sum of the corresponding differences a(v,) — a(u,) is
less than ¢. Furthermore, we can place these intervals in such a way that
every point of E 7 (a, 5) lies in the interior of some [w,, v,].


--- Page 136 ---

THE RIEMANNGSTIELTJES INTEGRAL 127

Remove the segments (u;, v;) from [a,b]. The remaining set K is
compact. Hence f is uniformly continuous on K, and there exists 6 > 0
such that | f(s) —f(t)| <eifseK, te K, |s—t| <6.

Now form a partition P = {xo, x,,...,%,} of [a, bj, as follows:
Each u, occurs in P. Each v,; occurs in P. No point of any segment (u,, v,)
occurs in P. If x,_, is not one of the u,;, then Ax; <6.

Note that M@; —m,<2M for every i, and that M, —m, < é unless
X;-1 is one of the u;. Hence, as in the proof of Theorem 6.8,

U(P,F, «) — LIP, f, «) < [a(b) — a(a)Je + 2Me.

Since ¢ is arbitrary, Theorem 6.6 shows that fe A(a).
Note: If fand « have a common point of discontinuity, then f need not

be in Aa). Exercise 3 shows this.

6.11

Theorem Suppose fe Aa) on [a,b], m<f<M, ¢ is continuous on

[m, M], and h(x) = o(f(x)) on [a, b]. Then h € #(a) on [a, b).

(18)

(19)

Proof Choose e > 0. Since ¢ is uniformly continuous on [m, M], there
exists 6 >0 such that 6<e and |¢(s) — O(t)| <« if |s —t| <6 and
5, te [m, M].

Since fe A(a), there is a partition P = {xo, x1, ..., X,} of [a, b] such
that

U(P, f, «) — L(P, f, a) < 6.

Let M,, m; have the same meaning as in Definition 6.1, and let Mj, m¥
be the analogous numbers for 4. Divide the numbers 1,..., 7 into two
classes: ie A if M,; -m,;<6,ie BifM;—m;26.

For je A, our choice of 6 shows that M* — mi < «.

For ie B, M* — mj < 2K, where K = sup|d(t)|, ms t<M. By
(18), we have

ieB ieB

so that )';.3 Aa, <6. It follows that
U(P, h, 0) — L(P, h, #) = ¥ (M¥# = m*) Aa, + (MM — mi) Aa,
ieA ieB
< e[a(b) — a(a)] + 2K65 < e[a(b) — x(a) + 2K].

Since ¢ was arbitrary, Theorem 6.6 implies that / € R(a).
Remark; This theorem suggests the question: Just what functions are

Riemann-integrable? The answer is given by Theorem 11.33(b).


--- Page 137 ---

128 PRINCIPLES OF MATHEMATICAL ANALYSIS

PROPERTIES OF THE INTEGRAL

6.12 Theorem
(a) ff, € R(@) and f, € Ra) on [a, b], then

fi the 2@),

of € R(a) for every constant c, and

[it fd de = fh det [fd

b b
i} ofdu=c{ Sf da.
(6) ff) <A) on [a, b], then
b b
[fdas ff. da.

(c) If fe Rw) on [a,b] and ifa<c<b, then fe Ra) on [a,c] and on
[c, 5], and

[ fda + [ fda = [ fda.
(d) If fe R(a) on {a, b) and if |f()| < M on [a, b], then
| [ f de
(e) If fe Ro,) and fe R(a,), then fe Ru, + 0) and
[flay +n) =f fee, + Pf dogs
if f € R(a) and c is a positive constant, then fe R(ca) and

[ fd(ca) = [ f de,

< M[a(b) — «(a)).

Proof If f=/, +f, and P is any partition of [a, b], we have
(20) LP, A, 0) +L(P,f,,%) < LP, f, a)
< UP, f, 0) < UPA, %) + UP. fr, 9):

If f, € Ba) and fy € Aa), let e > 0 be given. There are partitions P;
G = 1, 2) such that

U(P;, fj, %) — L(P;,f5,0 <6


--- Page 138 ---

(21)

6.13

THE RIEMANNSSTIELTJES INTEGRAL 129

These inequalities persist if P, and P, are replaced by their common
refinement P. Then (20) implies

U(P, Ff, ®) — L(P, f, ®) < 2e,
which proves that fe 2(a).

With this same P we have
UP S,0<ffjdate (G=1,2);
hence (20) implies
[fda < UP, fa) <Jfi dat J fy du + 2¢.

Since e was arbitrary, we conclude that

[fdua< ff, dat [fy da.

If we replace f, and f, in (21) by —f, and —/f;, the inequality is
reversed, and the equality is proved.

The proofs of the other assertions of Theorem 6.12 are so similar
that we omit the details. In part (c) the point is that (by passing to refine-
ments) we may restrict ourselves to partitions which contain the point c,
in approximating | f de.

Theorem I[f fe (a) and g € R(x) on [a, b], then
(a) fge RQ);

b b
(b) | f| € R(a) and [ f dal < [ if | do.

Proof If we take d(t) = t?, Theorem 6.11 shows that f? € R(a) if fe R(a).
The identity

4fg=(f+ 9" —f-9Y
completes the proof of (a).
If we take d(t) = |t|, Theorem 6.11 shows similarly that |f| € #(a).
Choose c = +1, so that
cf fda =0.
Then
| ffdau| =cf fda =f cfdas-{ |f| da,

since ef < |f].

6.14 Definition The unit step function I is defined by

_ 0 (x < 0),
Ix) = f (x >0).


--- Page 139 ---

130 PRINCIPLES OF MATHEMATICAL ANALYSIS

6.15

Theorem If a<s <b, f is bounded on [a, b], f is continuous at s, and

a(x) = I(x — s), then

6.16

[ fae =f00.

Proof Consider partitions P= {x9,x,,X2,%3}, Where x »=a, and
xX, =S< xX, <x;=5, Then

Since f is continuous at s, we see that M@, and m, converge to f(s) as
Xo 58.

Theorem Suppose c,>0 for 1, 2, 3,..., Lc, converges, {s,} is a sequence

of distinct points in (a, b), and

(22)

a(x) = Ye, I(x — s,).

Let f be continuous on [a, b]. Then

(23)

(24)

(25)

[faa = ¥ cfr)

Proof The comparison test shows that the series (22) converges for
every x. Its sum a(x) is evidently monotonic, and (a) = 0, a(b) = Xe,.
(This is the type of function that occurred in Remark 4.31.)

Let ¢ > 0 be given, and choose N so that

0
Vc, <6.
N+1

Put
N re)
a(x) = > c, L(x ~ Sn), Ota(x) = » c,1(x ~ Sn)
n=1 N+1
By Theorems 6.12 and 6.15,
b N
[, fas = & caf (sy.
Since «,(b) — «2(a) < ¢,

fra < Me,



--- Page 140 ---

THE RIEMANNSSTIELTJES INTEGRAL 131

where M = sup|f(x)|. Since « =a, + a,, it follows from (24) and (25)
that

b N
6) [Pree — ¥ eh)

If we let N - 00, we obtain (23).

< Me.

6.17 Theorem Assume « increases monotonically and «' € @ on [a, b]. Let f
be a bounded real function on [a, }).
Then f € R(a) if and only if fu’ e R. In that case

(27) [ fdu= [ SF (x)a'(x) dx.

Proof Let ¢>0 be given and apply Theorem 6.6 to a’: There is a par-
tition P = {xo,..., x,} of [a, b] such that

(28) U(P, «’) — L(P, «’) < «.
The mean value theorem furnishes points 1; € [x;_,, x;] such that
Aa; = a'(t;) Ax;
fori=1,...,”. Ifs,e[x;_,, x], then
nt
(29) d |a'(s;) — a'(t))| Ax; <e,
i=1
by (28) and Theorem 6.7(b). Put M = sup|f(x)|. Since
p> f (si) Aa; = LS sda') Ax;
it follows from (29) that
n n
(30) 2 fe) Aa; — x F(s,)a'(s;) Ax;| < Me.
In particular,
Y f(s) Aa; < UCP, fa’) + Me,
i=1

for all choices of s; € [x;_,, x,], so that
U(P,f, ) < U(P, fo’) + Me.
The same argument leads from (30) to

U(P, fe’) < U(P, f, 0) + Me.
Thus
(31) | U(P, f, 0) — U(P, fa’)| < Me.


--- Page 141 ---

132 PRINCIPLES OF MATHEMATICAL ANALYSIS

Now note that (28) remains true if P is replaced by any refinement.
Hence (31) also remains true. We conclude that

If. fda — [fF (x)a'(x) dx| < Me.

But ¢ is arbitrary. Hence
pb +b
(32) [ fda =| f(a") ae,

for any bounded f. The equality of the lower integrals follows from (30)
in exactly the same way. The theorem follows.

6.18 Remark The two preceding theorems illustrate the generality and
flexibility which are inherent in the Stieltjes process of integration. If «is a pure
step function [this is the name often given to functions of the form (22)], the
integral reduces to a finite or infinite series. If « has an integrable derivative,
the integral reduces to an ordinary Riemann integral. This makes it possible
in many cases to study series and integrals simultaneously, rather than separately.

To illustrate this point, consider a physical example. The moment of
inertia of a straight wire of unit length, about an axis through an endpoint, at
right angles to the wire, is

(33) [2 dm

where m(x) is the mass contained in the interval [0, x]. If the wire is regarded
as having a continuous density p, that is, if m’(x) = p(x), then (33) turns into

1
(34) I, x? p(x) dx.

On the other hand, if the wire is composed of masses m, concentrated at
points x;, (33) becomes

(35) > x7 m,.
i
Thus (33) contains (34) and (35) as special cases, but it contains much

more; for instance, the case in which m is continuous but not everywhere
differentiable.

6.19 Theorem (change of variable) Suppose 9 is a strictly increasing continuous
function that maps an interval [A, B] onto [a, b). Suppose « is monotonically
increasing on [a, b] and f ¢ R(«) on [a, b]. Define B and g on [A, B] by

(36) BY) = «(90)), 9) = F(9()).-


--- Page 142 ---

THE RIEMANNG-STIELTJES INTEGRAL 133

Then g € &(B) and
B b
(37) [. g dp = [ fda.

Proof To each partition P = {xq,..., x,} of [a, b] corresponds a partition
OQ ={yo,--+s Yn} Of [A, B], so that x; = g(y,). All partitions of [A, B]
are obtained in this way. Since the values taken by f on [x;-,, x,] are
exactly the same as those taken by g on [y;-1, y;], we see that

(38) U(Q,9,B)=UP,£%, L(Q,9, B)=L(P,f, a).

Since f¢ #(a), P can be chosen so that both U(P, f, x) and L(P, f, «)
are close to J fda. Hence (38), combined with Theorem 6.6, shows that
g € RB) and that (37) holds. This completes the proof.

Let us note the following special case:
Take a(x) = x. Then B =. Assume ¢’ € & on [A, B]. If Theorem
6.17 is applied to the left side of (37), we obtain

b B
(39) [ £0) & =f F@O)0'O) &.

INTEGRATION AND DIFFERENTIATION

We still confine ourselves to real functions in this section. We shall show that
integration and differentiation are, in a certain sense, inverse operations.

6.20 Theorem Let fe # on [a,b]. Fora <x <b, put
F(x) = f f(t) dt.

Then F is continuous on [a, b); furthermore, if f is continuous at a point Xo of
[a, bl, then F is differentiable at x, and
F'(Xo) = (Xo).
Proof Since fe, f is bounded. Suppose |f(t)| <M for ast<b.
Ifa<x<y<b, then
y
IFO) - Foo! =| fail < My — 2),
by Theorem 6.12(c) and (d). Given ¢ > 0, we see that
|F(”) — F(Q)| <¢,



--- Page 143 ---

134 PRINCIPLES OF MATHEMATICAL ANALYSIS

provided that |y—x|<e/M. This proves continuity (and, in fact,

uniform continuity) of F.
Now suppose f is continuous at x9. Given ¢ > 0, choose 6 > 0 such

that
f(t) —f(%o)| <8
if |t-—x0o| <6, anda<t<b. Hence, if
Xp —-O<S SX St<XyVt+d and a<s<t<b,

we have, by Theorem 6.12(d),

FO FS) _ F¢x0) = —— fw) — f(X%q)] dul <a.

It follows that F’(x9) = f(Xo).

6.21. The fundamental theorem of calculus Jf f € # on [a, 5] and if there is
a differentiable function F on [a, b] such that F' = f, then

i) ” f(x) dx = F(b) — F(a).

Proof Let ¢ >0 be given. Choose a partition P = {xo, ..., x,} of [a, b]
so that U(P,f) — L(P,f) < ¢. The mean value theorem furnishes points
t; € [x;-15 x] such that

F(x\) — F(x;-1) = f(t) Ax;
fori=1,...,n. Thus
yf Ax; = F(b) — F(a).
It now follows from Theorem 6.7(c) that

<é.

b
F(b) — F(a) - { fx) dx

Since this holds for every ¢ > 0, the proof is complete.

6.22 Theorem (integration by parts) Suppose F and G are differentiable func-
tions on [a, b], F' = fe &, and G'=ge. Then

[ Feo dx = F(b)G(b) — F(a)G(a) - [ "e(x)G(x) dx.

Proof Put A(x) = F(x)G(x) and apply Theorem 6.21 to H and its deriv-
ative. Note that H’ e #, by Theorem 6.13.


--- Page 144 ---

THE RIEMANN-STIELTJES INTEGRAL 135

INTEGRATION OF VECTOR-VALUED FUNCTIONS

6.23 Definition Let jf, ...,f, be real functions on [a, b], and let f = (f;,..., A)
be the corresponding mapping of [a, 5] into R*. If « increases monotonically
on [@, 5], to say that f € #(«) means that f, e A(«) forj=1,..., k. If this is the

case, we define
[tda= ([A de, eo Eh az).

In other words, ff dx is the point in R* whose jth coordinate is {f; dw.

It is clear that parts (a), (c), and (e) of Theorem 6.12 are valid for these
vector-valued integrals; we simply apply the earlier results to each coordinate.
The same is true of Theorems 6.17, 6.20, and 6.21. To illustrate, we state the
analogue of Theorem 6.21.

6.24 Theorem Iff and¥F map [a, b] into R*, iff € Z on [a, b], and if F’ =f, then
b
f f(t) dt = F(b) — F(a).

The analogue of Theorem 6.13(5) offers some new features, however, at
least in its proof.

6.25 Theorem If f maps [a,b] into R* and if { € R(«) for some monotonically
increasing function « on [a, b}, then |f| € B(«), and

(40) | [ie da| < {- |£| dev

Proof If/,,...,/, are the components of f, then
(41) lf} =(i+- +f".

By Theorem 6.11, each of the functions f? belongs to #(«); hence so does
their sum. Since x? is a continuous function of x, Theorem 4.17 shows
that the square-root function is continuous on [0, M], for every real M.
If we apply Theorem 6.11 once more, (41) shows that |f| € 2(qa).

To prove (40), put y = (,,..., ),), Where y, = Sf, da. Then we have
y = |f de, and

Iyl?= Dy = Ly, [ide = fC yf) ae.
By the Schwarz inequality,
(42) YS Ss ly! [£0] (a<t<b);


--- Page 145 ---

136 PRINCIPLES OF MATHEMATICAL ANALYSIS

hence Theorem 6,12(5) implies

(43) Iyl? < |y| f [fl ae.

If y = 0, (40) is trivial. If y 4 0, division of (43) by |y| gives (40).

RECTIFIABLE CURVES

We conclude this chapter with a topic of geometric interest which provides an
application of some of the preceding theory. The case k = 2 (i.e., the case of
plane curves) is of considerable importance in the study of analytic functions
of a complex variable.

6.26 Definition A continuous mapping y of an interval [a, 5] into R* is called
a curve in R*. To emphasize the parameter interval [a, 5], we may also say that
y is a curve on [a, b].

If y is one-to-one, y is called an arc.
If y(a) = y(b), y is said to be a closed curve.

It should be noted that we define a curve to be a mapping, not a point set.
Of course, with each curve » in R* there is associated a subset of R*, namely
the range of y, but different curves may have the same range.

We associate to each partition P = {xp,..., x,} of [a,b] and to each
curve y on [a, 5] the number

AP, 1) = ¥ [red ~ rev:

The ith term in this sum is the distance (in R*) between the points y(x;-,) and
y(x;). Hence A(P, y) is the length of a polygonal path with vertices at (Xo),
(x4), «++, Y(Xq), in this order. As our partition becomes finer and finer, this
polygon approaches the range of y more and more closely. This makes it seem
reasonable to define the length of y as

A(y) = sup A(P, 7),

where the supremum is taken over all partitions of [a, 5].

If A(y) < 00, we say that y is rectifiable.

In certain cases, A(y) is given by a Riemann integral. We shall prove this
for continuously differentiable curves, i.e., for curves y whose derivative y' i8
continuous.


--- Page 146 ---

THE RIEMANNGSTIELTJES INTEGRAL 137

6.27 Theorem Jf y’ is continuous on [a, b], then y is rectifiable, and
b ,
AQ) =f ly'@| at.
a
Proof Ifa<x;-, <x,< ), then

i rO a < i- | y(t) | at.

| y(x1) — yOu-1)| =
Hence
b
A(P,») < [yO at
for every partition P of [a, b]. Consequently,

b
AQ) sf [vl at.

To prove the opposite inequality, let e >0 be given. Since y’ is
uniformly continuous on (a, 5], there exists 6 > 0 such that
ly@-yOl<e — if|s—t| <6.

Let P={xo,...,X,} be a partition of [a, 6], with Ax; <6 for all 7. If
X;-1 <t<x;, it follows that

ly’) < ly’'@dl +e.
Hence

re [y’@)| dt < | y'(x)| Ax, + ¢ Ax;
= If vo + (x) — (OI a +6 Ax,
< IP ve a + [wea — y(t) a| +8 Ax,

S| (x) — y(xi-1)| + 28 Ax;.

If we add these inequalities, we obtain

[ly Ol ats AG, 9) +206 - a

< A(y) + 2e(6 — a).
Since ¢ was arbitrary,

[vO as Ac.

This completes the proof.


--- Page 147 ---

138 PRINCIPLES OF MATHEMATICAL ANALYSIS

EXERCISES

1.

i)

Suppose a increases on [a, 6], a< x0 <5, « is continuous at xo, f(xo) = 1, and
S(O) =0 if x #x0. Prove that fe B(«) and that | fda = 0.

. Suppose f> 0, f is continuous on [a, b}, and in f(x) dx =0. Prove that f(x) =0

for all x € [a, b]. (Compare this with Exercise 1.)

. Define three functions 81, 82, 83 as follows: B,(x) = 0 if x <0, B(x) =1 if x >0

for j= 1, 2, 3; and £,(0) = 0, 8.(0) =1, B3(0) = 4. Let f be a bounded function on
[—1, 1].
(a) Prove that f¢ &(B;) if and only if f(0-+) = f(0) and that then

[ta8.=F00).

(b) State and prove a similar result for B..
(c) Prove that fe @(B3) if and only if f is continuous at 0.
(d) If fis continuous at 0 prove that

[rae. = [a8 = | rdBs =f).

. If f(x) = 0 for all irrational x, f(x) = 1 for all rational x, prove that f ¢ Z ona, b]

for any a<b.

. Suppose f is a bounded real function on [a, b], and f? € @ on [a, b]. Does it

follow that fé #? Does the answer change if we assume that f* € #?

Let P be the Cantor set constructed in Sec. 2.44. Let f be a bounded real function
on (0, 1] which is continuous at every point outside P. Prove that fe # on [0, 1}.
Hint: P can be covered by finitely many segments whose total length can be made
as small as desired. Proceed as in Theorem 6.10.

Suppose f is a real function on (0, 1] and fe & on [c, 1] for every c>0. Define

[, 709 ae =1im [09 a

if this limit exists (and is finite).

(a) If fe & on [0, 1}, show that this definition of the integral agrees with the old
one,

(b) Construct a function f such that the above limit exists, although it fails to exist
with | | in place of f.

. Suppose fe @ on [a, b] for every b >a where a is fixed. Define

[pee ax = tim [709 ae

if this limit exists (and is finite). In that case, we say that the integral on the left
converges. If it also converges after f has been replaced by |/|, it is said to con-
verge absolutely,


--- Page 148 ---

10.

THE RIEMANNGSTIELTJES INTEGRAL 139

Assume that f(x) >0 and that f decreases monotonically on [1, 0). Prove

that
[109 dx
converges if and only if

converges. (This is the so-called “integral test’’ for convergence of series.)

. Show that integration by parts can sometimes be applied to the “improper”

integrals defined in Exercises 7 and 8. (State appropriate hypotheses, formulate a
theorem, and prove it.) For instance show that

” cos x ° sinx
=), ao

Show that one of these integrals converges absolutely, but that the other does not.
Let p and g be positive real numbers such that

1 + 1 =1,
Pq
Prove the following statements.
(a) If u>0 and v > 0, then
P a
uw< all + L .
P q

Equality holds if and only if u? = o*.
(6) If fe Ra), g € A(x), FSO, g = 0, and

[[ Prda=i=f ot do,
then
[ foae<i.

(c) If f and g are complex functions in A(«), then

< {i ae ax} “{f lgl* ax}

This is Hélder’s inequality. When p=q=2 it is usually called the Schwarz
inequality. (Note that Theorem 1.35 is a very special case of this.)

(d) Show that Hélder’s inequality is also true for the ‘“‘improper’’ integrals de-
scribed in Exercises 7 and 8.

[ foaa



--- Page 149 ---

140 PRINCIPLES OF MATHEMATICAL ANALYSIS

11. Let « be a fixed increasing function on [a, 5]. For u € @(a), define

b 1/2
(lle = 4) \u}* a} .

Suppose f, g, h € #(«), and prove the triangle inequality

WF Alle < IF—glle + ilg — Alle
as a consequence of the Schwarz inequality, as in the proof of Theorem 1.37.
12. With the notations of Exercise 11, suppose fe #(«) and e>0. Prove that
there exists a continuous function g on [a, b] such that ||f—glla <e.
Hint: Let P={xo,..., Xn} be a suitable partition of [a, 5], define

a) = fo) + FE fey

if X-1<¢<m.
13. Define

f= f er sin (02) dt.

(a) Prove that | f(x)| < 1/x if x >0.
Hint; Put t? = u and integrate by parts, to show that f(x) is equal to

cos (x?) cos [(x-+1)?] _ en COs u
2x 2x + 1) w | 403/72"

Replace cos u by —1.
(6) Prove that

2xf(x) = cos (x?) — cos [(x + 1)?] + r(x)

where |r(x)| <c/x and c is a constant.
(c) Find the upper and lower limits of xf(x), as x > «0.

(d) Does [-sin (t?) dt converge?
14, Deal similarly with

f= in ‘sin (e*) dt.

Show that
e*| f(x)| <2
and that
e*f (x) = cos (e*) — e~! cos (e**+) + r(x),

where |r(x)| < Ce-*, for some constant C.


--- Page 150 ---

THE RIEMANN-STIELTJES INTEGRAL 141

15. Suppose / is a real, continuously differentiable function on [a, 6], f(a) = f(b) = 0,

16.

17.

18.

and
i) S?(x) dx = 1.
Prove that
[ sf0OP'@) dx = -4
and that

b b
freor dr: f ere de> a.
For 1 <s < ©, define
Uy= +.
n=t 1°
(This is Riemann’s zeta function, of great importance in the study of the distri-

bution of prime numbers.) Prove that

° [x]

(a) Us) = sf oid

and that

() &s)=—_- fe de,

s— 1 xeti

where [x] denotes the greatest integer < x.

Prove that the integral in (6) converges for all s > 0.

Hint: To prove (a), compute the difference between the integral over [1, N]
and the Mth partial sum of the series that defines {(s).
Suppose « increases monotonically on [a, 6], g is continuous, and g(x) = G’(x)
fora<x<b. Prove that

f ov) dx = G(b)a(b) — G(a)a(a) — { “Gs.

Hint: Take g real, without loss of generality. Given P ={xo0, %1,..., Xn};
choose ¢; € (x:-1, x:) so that g(t;) Ax; = G(x:) — G(x:-1). Show that

¥ ebdatt) Ax; = G(b)«(b) — G(a)o(a) — p> G(x1-1) Ac.

Let 71, y2, v3 be curves in the complex plane, defined on [0, 277] by
yi(t) = et, y(t) = e2"*, ya(t) = e2n!t sin (i),

Show that these three curves have the same range, that y, and y2 are rectifiable,
that the length of y: is 27, that the length of y2 is 47, and that y3 is not rectifiable.


--- Page 151 ---

142 PRINCIPLES OF MATHEMATICAL ANALYSIS

19. Let y; be a curve in R*, defined on [a, 5]; let 6 be a continuous 1-1 mapping of
(c, d] onto [a, b], such that 4(c) = a; and define y2(s) = y.(A(s)). Prove that y2 is
an arc, a closed curve, or a rectifiable curve if and only if the same is true of y,.
Prove that y2 and y,; have the same length.


--- Page 152 ---

7

SEQUENCES AND SERIES OF FUNCTIONS

In the present chapter we confine our attention to complex-valued functions
(including the real-valued ones, of course), although many of the theorems and
proofs which follow extend without difficulty to vector-valued functions, and
even to mappings into general metric spaces. We choose to stay within this
simple framework in order to focus attention on the most important aspects of
the problems that arise when limit processes are interchanged.

DISCUSSION OF MAIN PROBLEM

7.1 Definition Suppose {f,}, 2=1,2,3,..., is a sequence of functions
defined on a set E, and suppose that the sequence of numbers {/,(x)} converges
for every x € E. We can then define a function f by

(1) f(@)=limf(x) (xe £).


--- Page 153 ---

144 PRINCIPLES OF MATHEMATICAL ANALYSIS

Under these circumstances we say that {/,} converges on E and that / is
the limit, or the limit function, of {f,}. Sometimes we shall use a more descriptive
terminology and shall say that ‘“‘{/,} converges to f pointwise on E’”’ if (1) holds.
Similarly, if &f,(x) converges for every x ¢ E, and if we define

Q) f= Fh)  @eb)

the function fis called the sum of the series Lf,.

The main problem which arises is to determine whether important
properties of functions are preserved under the limit operations (1) and (2).
For instance, if the functions f, are continuous, or differentiable, or integrable,
is the same true of the limit function? What are the relations between /;, and /’,
say, or between the integrals of f, and that of f?

To say that fis continuous at a limit point x means

lim f (1) = f().

Hence, to ask whether the limit of a sequence of continuous functions is con-
tinuous is the same as to ask whether
(3) lim lim f,() = lim lim (0),
tox n7>@ NO fx

i.e., whether the order in which limit processes are carried out is immaterial.
On the left side of (3), we first let n + 00, then t+ x; on the right side, t > x
first, then 2 + oo.

We shall now show by means of several examples that limit processes
cannot in general be interchanged without affecting the result. Afterward, we
shall prove that under certain conditions the order in which limit operations

are carried out is immaterial.
Our first example, and the simplest one, concerns a ‘double sequence.”

7.2 Example For m= 1, 2,3,...,n=1,2,3,..., let

m
Sin,n =
, m+n
Then, for every fixed n,
lim S44. = 1,
m~> co
so that
(4) lim lim s,,,, = 1.

n+>o m+


--- Page 154 ---

SEQUENCES AND SERIES OF FUNCTIONS 145

On the other hand, for every fixed m,

lim Sun = 0,
nwo
so that
(5) lim lim s,,,, = 0.
mo n>

7.3 Example Let

x?

Sl) = ay (x real; n = 0, 1, 2, wes

and consider
2

co [2] x
6 = ‘(x)= ¥ ——--
Since f,(0) = 0, we have /(0) = 0. For x #0, the last series in (6) is a convergent
geometric series with sum 1 + x? (Theorem 3.26). Hence

so that a convergent series of continuous functions may have a discontinuous
sum.
7.4 Example For m = 1, 2,3,..., put

Sn(X) = lim (cos m!nx)?".

When m!x is an integer, f,,(x) = 1. For all other values of x, f,,(x) = 0. Now let
f(x) = lim f,,(x).

For irrational x, f,,(x) = 0 for every m; hence f(x) =0. For rational x, say
x = p/q, where p and q are integers, we see that m!x is an integer if m > q, so
that f(x) = 1. Hence

(8) lim lim (cos m!nx)*" =

mo no

0 (x irrational),
1 (x rational).

We have thus obtained an everywhere discontinuous limit function, which
is not Riemann-integrable (Exercise 4, Chap. 6).


--- Page 155 ---

146 PRINCIPLES OF MATHEMATICAL ANALYSIS

7.5 Example Let

sin nx
Ja

F(x) = lim f,@) = 0.

(9) fu(®) =

and

(x real, n = 1, 2, 3,...),

Then f’(x) = 0, and
Fi) = J 1 COS nx,
so that {f7} does not converge tof’. For instance,
F,0) = /n> +0
as n— oo, whereas f’(0) = 0.
7.6 Example Let
(10) Six =n?x(l—x?"  (0<x<I1,n=1,2,3,...).

For 0 < x <1, we have

lim f,(x) = 0,
a->o
by Theorem 3.20(d). Since f,(0) = 0, we see that
qd) limf(~=0 O<xs').
n7>o

A simple calculation shows that

1
—_— 2)n = .
[> ey dx = =

Thus, in spite of (11),
1 n
[, foe) dx = 55> +00
as n—> 00,
If, in (10), we replace n? by n, (11) still holds, but we now have
. ct . n 1
fim Jo) d= fim 33

whereas

f. lim ro) dx =0.

nao


--- Page 156 ---

SEQUENCES AND SERIES OF FUNCTIONS 147

Thus the limit of the integral need not be equal to the integral of the limit,
even if both are finite.

After these examples, which show what can go wrong if limit processes
are interchanged carelessly, we now define a new mode of convergence, stronger
than pointwise convergence as defined in Definition 7.1, which will enable us to
arrive at positive results.

UNIFORM CONVERGENCE

7.7 Definition We say that a sequence of functions {f,},” = 1, 2, 3,...,
converges uniformly on E to a function fif for every ¢ > 0 there is an integer V
such that n = N implies

(12) Iflx) — f(x) | <e

for all x € E.

It is clear that every uniformly convergent sequence is pointwise con-
vergent. Quite explicitly, the difference between the two concepts is this: If {/,}
converges pointwise on £, then there exists a function f such that, for every
e > 0, and for every x € E, there is an integer N, depending on ¢ and on x, such
that (12) holds if n > N; if {f,} converges uniformly on E, it is possible, for each
& > 0, to find one integer N which will do for all x € E.

We say that the series 2/,(x) converges uniformly on E if the sequence
{s,} of partial sums defined by

x fio) = s(x)

converges uniformly on E.
The Cauchy criterion for uniform convergence is as follows.

7.8 Theorem The sequence of functions {f,}, defined on E, converges uniformly
on E if and only if for every & >0 there exists an integer N such that m> N,
n> WN, x €E implies

(13) | fu) — fn) |S 2.
Proof Suppose {f,} converges uniformly on £, and let f be the limit

function. Then there is an integer N such that n > N, x 6 E implies
€
f(x) —F)| <>:
so that

fil) — Sn) |S I) —£@) 1 + fC) — Fino) | Se
ifn> Nm>N,xeE.


--- Page 157 ---

148 PRINCIPLES OF MATHEMATICAL ANALYSIS

Conversely, suppose the Cauchy condition holds. By Theorem 3.11,
the sequence {f,(x)} converges, for every x, to a limit which we may call
J (x). Thus the sequence { 7/,} converges on E, tof. We have to prove that
the convergence is uniform.

Let ¢ > 0 be given, and choose N such that (13) holds. Fix nm, and
let m— oo in (13). Since f(x) > f(x) as m — 00, this gives

(14) |flx) — f(x) | Se
for every n = N and every x e E, which completes the proof.

The following criterion is sometimes useful.

7.9 Theorem Suppose
lim f,G)=f0) — (« € B).

Put
M, = sup |fulx) — F(x) |.

Then f, ~ f uniformly on E if and only if M,-+0 asn- oo.

Since this is an immediate consequence of Definition 7.7, we omit the
details of the proof.

For series, there is a very convenient test for uniform convergence, due to
Weierstrass.

7.10 Theorem Suppose { f,} is a sequence of functions defined on E, and suppose
(nl <M, (xek,n=1,2,3,...).

Then Lf, converges uniformly on E if UM, converges.
Note that the converse is not asserted (and is, in fact, not true).

Proof If 2M, converges, then, for arbitrary ¢ > 0,

| Ee

provided m and n are large enough. Uniform convergence now follows
from Theorem 7.8.

<Mise (x € E),


--- Page 158 ---

SEQUENCES AND SERIES OF FUNCTIONS 149

UNIFORM CONVERGENCE AND CONTINUITY

7.11 Theorem Suppose f, -f uniformly on a set E in a metric space. Let x be
a limit point of E, and suppose that

(15) lim f,(2) = A, (n = 1, 2, 3,...).
trx
Then {A,} converges, and
(16) lim f(¢) = lim A,.
tox no
In other words, the conclusion is that
(17) lim lim f,(4) = lim lim f,(9).
tox azo n>0o tox

Proof Let ¢>0 be given. By the uniform convergence of {f,}, there
exists N such that n > N,m > N,t € E imply

(18) lat) — fut) | <8.
Letting t > x in (18), we obtain
|A, ~ A,, | sé

for n> N,m2N, so that {A,} is a Cauchy sequence and therefore
converges, say to A.
Next,

(19) If -—Al < IfO-F,00] + £0 -4al + |4.- 4}:

We first choose n such that
(20) VO - AO <5

for all t e E (this is possible by the uniform convergence), and such that
(21) 4, A] <5.

Then, for this n, we choose a neighborhood V of x such that

(22) LA) — Anl $5

if teVoE, t¥x.
Substituting the inequalities (20) to (22) into (19), we see that

If) ~ Al se,
provided te Vin E, t#x. This is equivalent to (16).


--- Page 159 ---

150 PRINCIPLES OF MATHEMATICAL ANALYSIS

7.12 Theorem If {f,} is a sequence of continuous functions on E, and if f,>f
uniformly on E, then f is continuous on E.

This very important result is an immediate corollary of Theorem 7.11.

The converse is not true; that is, a sequence of continuous functions may
converge to a continuous function, although the convergence is not uniform.
Example 7.6 is of this kind (to see this, apply Theorem 7.9). But there is a case
in which we can assert the converse.

7.13 Theorem Suppose K is compact, and

(a) {f,} is a sequence of continuous functions on K,
(b) {f,} converges pointwise to a continuous function f on K,
(c) f(x) =fi41.(%) for allx e Kin = 1, 2,3,....
Then f,, ~ f uniformly on K.
Proof Put g,=/,—f Then g, is continuous, g,—+0 pointwise, and
In 29n+1- We have to prove that g, 0 uniformly on K.

Let ¢>0 be given. Let K, be the set of all xe K with g,(x) >«.
Since g,, is continuous, K, is closed (Theorem 4.8), hence compact (Theorem
2.35). Since g, > 9,+1, we have K,> K,4,. Fix xe K. Since g,(x) > 0,
we see that x ¢ X, if nis sufficiently large. Thus x ¢ (| K,. In other words,
(\ K, is empty. Hence Ky is empty for some N (Theorem 2.36). It follows
that 0 < g,(x) < efor all x e K and for all = N. This proves the theorem.

Let us note that compactness is really needed here. For instance, if

1
Sol) = nx +1

then f,(x) + 0 monotonically in (0, 1), but the convergence is not uniform.

(0<x<1;n=1, 2, 3,...)

7.14 Definition If X is a metric space, ¢(X) will denote the set of all complex-
valued, continuous, bounded functions with domain YX.

[Note that boundedness is redundant if X is compact (Theorem 4.15).
Thus ¢(X) consists of all complex continuous functions on X if X is compact.]
We associate with each fe G(X) its supremum norm

fll = sup If).
Since f is assumed to be bounded, ||f||< 00. It is obvious that || f|| = 0 only if
FS (*) =0 for every x € X, that is, only if f=0. Ifh =/f+g, then
\A(x) | < If) + IgG) s Ifll + llgll
for all x e X; hence

If+ gil <Ifll + lal.


--- Page 160 ---

SEQUENCES AND SERIES OF FUNCTIONS 151

If we define the distance between fe @(X) and g € G(X) to be ||f—g]l,
it follows that Axioms 2.15 for a metric are satisfied.

We have thus made @(X) into a metric space.

Theorem 7.9 can be rephrased as follows:

A sequence {f,} converges to f with respect to the metric of €(X) if and

only if f, +f uniformly on X.

Accordingly, closed subsets of @(X) are sometimes called uniformly
closed, the closure of a set x < G(X) is called its uniform closure, and so on.

7.15 Theorem The above metric makes @(X) into a complete metric space.

Proof Let {f,} be a Cauchy sequence in ¢(X). This means that to each
é>0 corresponds an N such that ||f, —f,||<e if n= N and m>N.
It follows (by Theorem 7.8) that there is a function f with domain X to
which {f,} converges uniformly. By Theorem 7.12, f is continuous.
Moreover, f is bounded, since there is an n such that |f(x) —f,(x)| <1
for all x e X, and f, is bounded.
Thus fe@(X), and since f,->f uniformly on X, we have

If—Sall +0 as in — 00,

UNIFORM CONVERGENCE AND INTEGRATION

7.16 Theorem Let « be monotonically increasing on [a,b]. Suppose f, € B(x)
on [a, b}, forn = 1, 2, 3, ..., and suppose f, + f uniformly on [a, b]. Then f ¢ B(a)
on [a, b}, and

(23) f , fda = lim i} "edo

nwo

(The existence of the limit is part of the conclusion.)

Proof It suffices to prove this for real f,. Put

the supremum being taken over a < x <b. Then
Tn &n SS Sn t+ bn,
so that the upper and lower integrals of f (see Definition 6.2) satisfy
b ~ b
(25) [ Ge-e)dus[fda<[fdusf (f,+2,) de.
a —_ a

Hence

O< J fda —{ fda < 2eq{a(b) — a(a)).


--- Page 161 ---

152 PRINCIPLES OF MATHEMATICAL ANALYSIS

Since ¢, >0 as n> 00 (Theorem 7.9), the upper and lower integrals of f

are equal.
Thus f¢ @(«). Another application of (25) now yields

b b
[ faa- J f,dx| < ela) - a(@)].

(26)

This implies (23).
Corollary If /, € &(«) on [a, b] and if
{@=VAC)  @sxsd)
the series converging uniformly on [a, b], then
b 2 b
[ fae= > f fax.
a n=1"a

In other words, the series may be integrated term by term.

UNIFORM CONVERGENCE AND DIFFERENTIATION

We have already seen, in Example 7.5, that uniform convergence of {/,} implies
nothing about the sequence {f/}. Thus stronger hypotheses are required for the
assertion that f/ > f'if f, of.

7.17 Theorem Suppose {f,} is a sequence of functions, differentiable on {a, b]

and such that {f,(xo)} converges for some point x on [a, 5]. If {f,} converges
uniformly on {a, b], then {f,} converges uniformly on [a, b), to a function f, and

(27) f'@) = lim fy (x) @sx<b).

Proof Let ¢> 0 be given. Choose N such that n > N, m > N, implies
(28) Lfa(%0) ~ Jno) | <5

and

é
(29) lf) —frlt)| < 16 - a) (@<t<b).


--- Page 162 ---

(30)

(31)

(32)

(33)

SEQUENCES AND SERIES OF FUNCTIONS 153

If we apply the mean value theorem 5.19 to the function f, — fj,, (29)
shows that

|x—tle

a2) ~ Lu) LAD + Sa Sp — gy $5

for any x and ¢ on [a, b), ifn2N,m2N. The inequality
fal) — Fru) |< fa) — Sn) — no) + Sn(%o) | + Sao) — Sno) |
implies, by (28) and (30), that
fal) — f(x) | < 6 (asx<bn>=N,m2N),
so that {f,} converges uniformly on [a, 5]. Let
f(x) =lim SAX) (asx <b).
Let us now fix a point x on [a, b] and define

MOK) gay FO =L)

t-x t-—x

a(t) =

fora<t<b,t#x. Then
lim ¢,(t) = f(x) (n = 1, 2, 3,...).
tox

The first inequality in (30) shows that

é

so that {¢,} converges uniformly, for ¢ # x. Since {/,} converges to f, we
conclude from (31) that

lim $(0) = $0

uniformly fora <t<6b,t#x.
If we now apply Theorem 7.11 to {¢,}, (32) and (33) show that

lim ¢(t) = lim f/ (x);
tox n>
and this is (27), by the definition of (7).

Remark: If the continuity of the functions f’ is assumed in addition to

the above hypotheses, then a much shorter proof of (27) can be based on
Theorem 7.16 and the fundamental theorem of calculus.


--- Page 163 ---

154 PRINCIPLES OF MATHEMATICAL ANALYSIS

7.18 Theorem There exists a real continuous function on the real line which is
nowhere differentiable.

Proof Define
(34) g(x)= |x| (-lsxs1)

and extend the definition of @(x) to all real x by requiring that
(35) o(x + 2) = o().

Then, for all s and f,

(36) le(s) — o()| < |s—t].
In particular, @ is continuous on R!. Define

G7) fo) = ¥ @o4's).

Since 0<@ <1, Theorem 7.10 shows that the series (37) converges
uniformly on R!. By Theorem 7.12, fis continuous on R}.
Now fix a real number x and a positive integer m. Put
(38) 6, = £44-™

where the sign is so chosen that no integer lies between 4"x and 4"(x + 6,,).
This can be done, since 4” |6,,| = 4. Define

When n > m, then 4"6,, is an even integer, so that y, =0. When0 <n <™m,
(36) implies that |y,| <4".
Since |y,, | = 4", we conclude that
f(x + 6) —£(@)
5mm

m

As m-— 0, 6,, +0. It follows that fis not differentiable at x.

EQUICONTINUOUS FAMILIES OF FUNCTIONS

In Theorem 3.6 we saw that every bounded sequence of complex numbers
contains a convergent subsequence, and the question arises whether something
similar is true for sequences of functions. To make the question more precise,
we shall define two kinds of boundedness.


--- Page 164 ---

SEQUENCES AND SERIES OF FUNCTIONS 155

7.19 Definition Let {7} be a sequence of functions defined on a set £.

We say that {,} is pointwise bounded on E if the sequence {f,(x)} is bounded
for every x € E, that is, if there exists a finite-valued function ¢ defined on E
such that

If) | <x) Wek, n=1,2,3,..,).

We say that {f,} is uniformly bounded on E if there exists a number M

such that
R(O|<Mi (xe E,n=1,2,3,...).

Now if {f,} is pointwise bounded on E and £, is a countable subset of E,
it is always possible to find a subsequence {f,,} such that {f,,,(x)} converges for
every x € E,;, This can be done by the diagonal process which is used in the
proof of Theorem 7.23.

However, even if {f,} is a uniformly bounded sequence of continuous
functions on a compact set Z, there need not exist a subsequence which con-
verges pointwise on £. In the following example, this would be quite trouble-
some to prove with the equipment which we have at hand so far, but the proof
is quite simple if we appeal to a theorem from Chap. 11.

7.20 Example Let
Fix) =sinnx (05x <22,n=1,2,3,...).

Suppose there exists a sequence {n,} such that {sin n,x} converges, for every
x © [0, 27]. In that case we must have

lim (sin a,x — sinm4,x)=0 (0< x <2n);

hence

k> 0

By Lebesgue’s theorem concerning integration of boundedly convergent
sequences (Theorem 11.32), (40) implies

an

(41) lim f (sin 44x — sin ny 41x)? dx =0.
k+0 *0

But a simple calculation shows that

2n
f (sin 1,x — sin m4,x)? dx = 2n,
0

which contradicts (41).


--- Page 165 ---

156 PRINCIPLES OF MATHEMATICAL ANALYSIS

Another question is whether every convergent sequence contains a
uniformly convergent subsequence. Our next example will show that this
need not be so, even if the sequence is uniformly bounded on a compact set.
(Example 7.6 shows that a sequence of bounded functions may converge
without being uniformly bounded; but it is trivial to see that uniform conver-
gence of a sequence of bounded functions implies uniform boundedness.)

7.21 Example Let

x?

WOO = T= my

Then |f,(x)| < 1, so that {f,} is uniformly bounded on [0, 1]. Also
limf()=0 0O<x<I),

(0<x<1,n=1,2,3,...).

but
f(c) =1 (n = 1,2,3,...),

so that no subsequence can converge uniformly on (0, 1].

The concept which is needed in this connection is that of equicontinuity;
it is given in the following definition.

7.22 Definition A family ¥ of complex functions f defined on a set E in a
metric space X is said to be equicontinuous on E if for every ¢ > 0 there exists a
6 > 0 such that

If) —f0)| <e

whenever d(x, y)<6,x EE, ye, and feF. Here d denotes the metric of X.

It is clear that every member of an equicontinuous family is uniformly
continuous.

The sequence of Example 7.21 is not equicontinuous.

Theorems 7.24 and 7.25 will show that there is a very close relation
between equicontinuity, on the one hand, and uniform convergence of sequences
of continuous functions, on the other. But first we describe a selection process
which has nothing to do with continuity.

7.23 Theorem If {f,} is a pointwise bounded sequence of complex functions on
a countable set E, then {f,} has a subsequence {f,,,} such that {f,,(x)} converges for
every x EE,


--- Page 166 ---

SEQUENCES AND SERIES OF FUNCTIONS 157

Proof Let {x;}, i= 1, 2, 3,..., be the points of E, arranged in a sequence.
Since {7,(x,)} is bounded, there exists a subsequence, which we shall
denote by {/, ,}, such that {/; ,(x,)} converges as k - 00.

Let us now consider sequences S,, S,, S3,..., which we represent
by the array

Si: fin Az fis Siva
So: faa Soe t2,3 S24
S3: foi fa fas Sra

and which have the following properties:

(a) S, is a subsequence of S,_,, forn = 2,3,4,....

(b) {frx(%a)} converges, as k-+0o (the boundedness of {f,(x,)}

makes it possible to choose S,, in this way);

(c) The order in which the functions appear is the same in each se-

quence; i.e., if one function precedes another in S,, they are in the same

relation in every S,, until one or the other is deleted. Hence, when

going from one row in the above array to the next below, functions

may move to the left but never to the right.

We now go down the diagonal of the array; i.e., we consider the
sequence
S: fin fry fa faa’

By (c), the sequence S (except possibly its first n — 1 terms) is a sub-
sequence of S,, for n=1,2,3,.... Hence (b) implies that {f, ,(x,)}
converges, as n > 00, for every x; € E.

7.24 Theorem J/f K is a compact metric space, if f,¢@(K) for n= 1, 2, 3,...,
and if { f,} converges uniformly on K, then {f,} is equicontinuous on K.

Proof Let e>0 be given. Since {f,} converges uniformly, there is an
integer N such that

Ifn-fvll<@ = (@>N).

(See Definition 7.14.) Since continuous functions are uniformly con-
tinuous on compact sets, there is a 6 > 0 such that

fi) —fi0)| <e

ifl<i<N and d(x, y)<6.
If n > N and d(x, y) <6, it follows that

fl) — Su) | S Ufa) — ful) 1 + fv) — fx) 1 + Lf) —F,0) | < 32.

In conjunction with (43), this proves the theorem.


--- Page 167 ---

158 PRINCIPLES OF MATHEMATICAL ANALYSIS

7,25

Theorem I[f K is compact, if f,€ @(K) for n = 1, 2,3,..., and if {f,} is

pointwise bounded and equicontinuous on K, then

(44)

(45)

(46)

(a) {/f,} is uniformly bounded on K,
(6) {f,} contains a uniformly convergent subsequence.

Proof

(a) Let e>0 be given and choose 6 > 0, in accordance with Definition
7.22, so that

f(x) — fx) | <8

for all n, provided that d(x, y) <6.

Since K is compact, there are finitely many points p,,..., p, in K
such that to every x e K corresponds at least one p, with d(x, p,) <6.
Since{ f,} is pointwise bounded, there exist M, < 00 such that |f,(p,)| < M;
for all n. If M=max(M,,...,M,), then [f,(x)|<M+e for every
x e€K. This proves (a).

(6) Let E be a countable dense subset of K. (For the existence of such a
set E, see Exercise 25, Chap. 2.) Theorem 7.23 shows that {f,} has a
subsequence {7,,,} such that {f,,(x)} converges for every x € E.

Put f,,=9:, to simplify the notation. We shall prove that {g,}
converges uniformly on K.

Let e>0, and pick 6>0 as in the beginning of this proof. Let
V(x, 5) be the set of all y e K with d(x, y) <6. Since E is dense in K, and
K is compact, there are finitely many points x,,..., x,, in E such that

Kc V(x, 6) V+ U Vx, 8).

Since {g,(x)} converges for every x € E, there is an integer N such
that

19:(%s) — 9)(%5) | <8

whenever i2N,j>N,1<s<m.
If x € K, (45) shows that x e V(x,, 6) for some s, so that

lg(x) — g(x.) | <e
for every i. If i= N andj 2 N, it follows from (46) that

lg) — g(x)! S lg) — olxs) | + 194(%5) — 9)(%0) | + 195) — ox) |
< 3e.

This completes the proof.


--- Page 168 ---

SEQUENCES AND SERIES OF FUNCTIONS 159

THE STONE-WEIERSTRASS THEOREM

7.26 Theorem If f is a continuous complex function on {a, b], there exists a
sequence of polynomials P,, such that

lim P,(x) = f(x)

uniformly on [a, b). If f is real, the P,, may be taken real.

This is the form in which the theorem was originally discovered by
Weierstrass.

Proof We may assume, without loss of generality, that [a, 6] = [0, 1].
We may also assume that f(0) =/(1) =0. For if the theorem is proved
for this case, consider

g(x) =f) —fO) — xf) -fO] Osx).

Here g(0) = g(1) = 0, and if g can be obtained as the limit of a uniformly
convergent sequence of polynomials, it is clear that the same is true for /,
since f — g is a polynomial.

Furthermore, we define f(x) to be zero for x outside [0, 1]. Then f
is uniformly continuous on the whole line.

We put

(47) 0,(x) =¢,(1-x2)" (n= 1,2,3,...)

where c, is chosen so that
1
(48) [ Q(@)de=1 (1 =1,2,3,..)).
-1
We need some information about the order of magnitude of c,. Since

[ ( - xy dx=2f (1 — xy de22 {a ~ x)" dx
0 0

-1

vn
>2f" (1 ~ nx?) dx
0

4
3./n
1
> ——9
Jn
it follows from (48) that
(49) Cn </n.


--- Page 169 ---

160 PRINCIPLES OF MATHEMATICAL ANALYSIS

(50)

(51)

The inequality (1 — x?)" > 1 — nx? which we used above is easily
shown to be true by considering the function

(1 — x?) — 14 nx?
which is zero at x = 0 and whose derivative is positive in (0, 1).
For any 6 > 0, (49) implies

0,(x) </n(Ql- 6" (6 < |x] <1),

so that Q, +0 uniformly in 6 < |x| <1.
Now set

1
P(x) = i} f(x+0O,(t)dt (0<x <1).
-1
Our assumptions about f show, by a simple change of variable, that
1-x 1
PQ=f — f(x+ NO) dt =f FOO - 9 at,
—x 0
and the last integral is clearly a polynomial in x. Thus {P,} is a sequence

of polynomials, which are real if f is real.
Given & > 0, we choose 6 > 0 such that |y — x| <6 implies

f0) -f@)| <5:

Let M = sup |f(x)|. Using (48), (50), and the fact that Q,(x) > 0, we
see that forO <x <1,

1
Px) f= | Tree #9) - Fon] OW0 a
1
<[_ We +) ~FO)|O,(0 at
-6 ee 1
< 2M | O,(t) dt + af, Q,(t) dt + 2M f Q,(t) dt
<4M./n (1-6) +5

<é

for all large enough , which proves the theorem.

It is instructive to sketch the graphs of Q, for a few values of n; also,

note that we needed uniform continuity of f to deduce uniform convergence
of {P,}.


--- Page 170 ---

SEQUENCES AND SERIES OF FUNCTIONS 161

In the proof of Theorem 7.32 we shall not need the full strength of
Theorem 7.26, but only the following special case, which we state as a corollary.

7.27. Corollary For every interval [— a, a] there is a sequence of real poly-
nomials P,, such that P,(0) = 0 and such that

lim P,(x) = |x|
uniformly on [— a, a].

Proof By Theorem 7.26, there exists a sequence {P**} of real polynomials
which converges to |x| uniformly on [— a, a]. In particular, P*(0) +0
asn-— oo. The polynomials

have desired properties.

We shall now isolate those properties of the polynomials which make
the Weierstrass theorem possible.

7.28 Definition A family o of complex functions defined on a set EF is said
to be an algebra if (i) f + g € &, (ii) fg € oA, and (iii) cf e o for all fev, g Ev
and for all complex constants c, that is, if of is closed under addition, multi-
plication, and scalar multiplication. We shall also have to consider algebras of
real functions; in this case, (iii) is of course only required to hold for all real c.

If sf has the property that fe. whenever f, € W (n= 1, 2, 3,...) and
f,7f uniformly on E, then #7 is said to be uniformly closed.

Let @ be the set of all functions which are limits of uniformly convergent
sequences of members of of. Then @ is called the uniform closure of sf. (See
Definition 7.14.)

For example, the set of all polynomials is an algebra, and the Weierstrass
theorem may be stated by saying that the set of continuous functions on [a, b]
is the uniform closure of the set of polynomials on [a, b).

7.29 Theorem Let @ be the uniform closure of an algebra sf of bounded
functions. Then B is a uniformly closed algebra.

Proof If fe@ and g e@, there exist uniformly convergent sequences
{f,}, {9,} such that f, >f,g,->g and f, € %,g, € %. Since we are dealing
with bounded functions, it is easy to show that

Sn+Gn7f+9, Sin>fo, hood,

where c is any constant, the convergence being uniform in each case.
Hence f+ g €&, fg € B, and cfe &, so that & is an algebra.
By Theorem 2.27, @ is (uniformly) closed.


--- Page 171 ---

162 PRINCIPLES OF MATHEMATICAL ANALYSIS

7.30 Definition Let o& be a family of functions on a set E. Then sf is said
to separate points on E if to every pair of distinct points x,, x, € E there corre-
sponds a function f € & such that f(x,) # (x2).

If to each x € E there corresponds a function g € w such that g(x) #0,
we say that xf vanishes at no point of E.

The algebra of all polynomials in one variable clearly has these properties
on R!. An example of an algebra which does not separate points is the set of
all even polynomials, say on [— 1, 1], since f(— x) = f(x) for every even function f.

The following theorem will illustrate these concepts further.

7.31 Theorem Suppose sf is an algebra of functions on a set E, sf separates
points on E, and sf vanishes at no point of E. Suppose x,, x2 are distinct points
of E, and c,,¢, are constants (real if of is a real algebra). Then sf contains a
function f such that
Sf(%1) = C1, S(%2) =e.
Proof The assumptions show that sf contains functions g,h, and k
such that

g(x) #g(xX2), h(x) #0, k(x.) £0.

Put
u=gk—g(x)k, v=gh—g(x2)h.

Then u € of, v & &, u(x,) = v(x,) = 0, u(x.) # 0, and v(x,) # 0. Therefore

_ C10 + C2u
v(x1)  u(x2)

has the desired properties.

We now have all the material needed for Stone’s generalization of the
Weierstrass theorem.

7.32 Theorem Let o& be an algebra of real continuous functions on a compact
set K. If sf separates points on K and if sf vanishes at no point of K, then the
uniform closure B of sf consists of all real continuous functions on K.

We shall divide the proof into four steps.

step 1 If fe, then |f|\e.
Proof Let
(52) a=sup [f()| (xe K)


--- Page 172 ---

SEQUENCES AND SERIES OF FUNCTIONS 163

and let e>0 be given. By Corollary 7.27 there exist real numbers
Cy, «++, €, Such that

(53) <eé (-a<y <a).

Lev — ly!
t=1

Since # is an algebra, the function

a
g= x ef!
i=1
is a member of @. By (52) and (53), we have
lax) — If@)||<e (eX).

Since @ is uniformly closed, this shows that |f| e« #.

step 2 Iffe Band g eZ, then max(f,g) «€ B and min(f, g) € B.

By max (f, g) we mean the function / defined by

_(f@) iff) 290,
W(x) = ne if f(x) < a(x),

and min (Jf, g) is defined likewise.

Proof Step 2 follows from step 1 and the identities

max (fg) =i8 4 Hoa,
min(f,g) =248- Fa.

By iteration, the result can of course be extended to any finite set
of functions: If f,...,f, €@, then max (fj,...,/,) €@, and

min (f,,...S,)€f.
STEP 3. Given a real function f, continuous on K, a point x € K, and ¢ > 0, there
exists a function g, € B such that g,(x) =f(x) and
(34) g{th>f()-e (tek).

Proof Since « < # and wo satisfies the hypotheses of Theorem 7.31 so
does @. Hence, for every y € K, we can find a function h, ¢ @ such that

(55) h(x) =f(x), hy) = 0).


--- Page 173 ---

164 PRINCIPLES OF MATHEMATICAL ANALYSIS

By the continuity of A, there exists an open set J,, containing y,

such that
(56) h(t)>f()}-e (ted).
Since K is compact, there is a finite set of points y,,..., y, such that
(57) KeoJ,ue ud,.
Put

gx = max (h,,,..., hy).
By step 2,g €@, and the relations (55) to (57) show that g, has the other
required properties.

STEP 4 Given a real function f, continuous on K, and e > 0, there exists a function
he such that

(58) |A(x) —f(x)|<e (we).

Since # is uniformly closed, this statement is equivalent to the conclusion
of the theorem.

Proof Let us consider the functions g,, for each x € K, constructed in
step 3. By the continuity of g,, there exist open sets V, containing x,

such that
(59) gt)<f(t)+e (teV,).
Since K is compact, there exists a finite set of points x,,..., %,_
such that
(60) Kev, uv.
Put

h= min (9,5 +++ Dap):
By step 2, h € @, and (54) implies

(61) At)>f(t)—e (tek),
whereas (59) and (60) imply
(62) A(t) <f@) +e (t € K).

Finally, (58) follows from (61) and (62).


--- Page 174 ---

SEQUENCES AND SERIES OF FUNCTIONS 165

Theorem 7.32 does not hold for complex algebras. A counterexample is

given in Exercise 21. However, the conclusion of the theorem does hold, even
for complex algebras, if an extra condition is imposed on ., namely, that
be self-adjoint. This means that for every fe. its complex conjugate f must

also belong to &; f is defined by f(x) = f(x).

7.33 Theorem Suppose x is a self-adjoint algebra of complex continuous
functions on a compact set K, & separates points on K, and sf vanishes at no
point of K. Then the uniform closure B of & consists of all complex continuous
functions on K. In other words, xf is dense @(K).

Proof Let »/, be the set of all real functions on K which belong to x.

If fe W and f= u + iv, with u, v real, then 2u =f + f, and since
is self-adjoint, we see that ue W,. If x, Ax, there exists fe of such
that f(x,) = 1, f(x.) = 0; hence 0 = u(x.) ¥ u(x,) = 1, which shows that
WZ separates points on K. If x e K, then g(x) #0 for some g € x, and
there is a complex number / such that Ag(x) > 0; if f= 4g, f= u + iv, it
follows that u(x) > 0; hence »/, vanishes at no point of K.

Thus %, satisfies the hypotheses of Theorem 7.32. It follows that
every real continuous function on K lies in the uniform closure of ~,,
hence lies in #. If f is a complex continuous function on K, f=u +iv,
then ue B, ve B, hence fe #. This completes the proof.

EXERCISES

1,

2.

=)

Prove that every uniformly convergent sequence of bounded functions is uni-
formly bounded.

If {f,} and {gn} converge uniformly on a set E, prove that {f, + g,} converges
uniformly on £. If, in addition, {/,} and {gn} are sequences of bounded functions,
prove that {f,g,} converges uniformly on E.

. Construct sequences {f,}, {gn} which converge uniformly on some set E, but such

that {f,gn} does not converge uniformly on E (of course, {f,g,} must converge on
E).

. Consider

wo 1
IO= Dae
For what values of x does the series converge absolutely? On what intervals does
it converge uniformly? On what intervals does it fail to converge uniformly? Is f
continuous wherever the series converges? Is f bounded?


--- Page 175 ---

166 PRINCIPLES OF MATHEMATICAL ANALYSIS

5. Let
0 nei’
fx) = { sin? =
. x n+l
n
Show that {/,} converges to a continuous function, but not uniformly. Use the
series & f, to show that absolute convergence, even for all x, does not imply uni-

form convergence.
Prove that the series

n

6

© aitn
Oa

converges uniformly in every bounded interval, but does not converge absolutely
for any value of x.
7. For n= 1, 2,3,..., x real, put

fle) = a
Show that {f,} converges uniformly to a function f, and that the equation
f'®)= lim fax)
is correct if x 40, but false if x = 0.
8. If

0 (<0),
10) ={f (50)

if {x,} is a sequence of distinct points of (a, 5), and if =]ca| converges, prove that
the series

S(~= ¥ cal(x— x) (a@a<x<b)

converges uniformly, and that f is continuous for every x # Xn.
9. Let {f,} be a sequence of continuous functions which converges uniformly to a
function f on a set E. Prove that

lirn fan) = SX)

for every sequence of points x, € E such that x, ->x, and x € E. Is the converse of
this true?


--- Page 176 ---

SEQUENCES AND SERIES OF FUNCTIONS 167

10. Letting (x) denote the fractional part of the real number x (see Exercise 16, Chap. 4,
for the definition), consider the function
S@)= 5 (x) (x real).
nazi A
Find all discontinuities of f, and show that they form a countable dense set.
Show that fis nevertheless Riemann-integrable on every bounded interval.
11. Suppose {/,3, {gn} are defined on E, and
(a) =f, has uniformly bounded partial sums;
(6) gn 0 uniformly on E;
(c) g(x) [92(x) S9s(x) =": for every x € E.
Prove that = fg, converges uniformly on Z. Hint: Compare with Theorem
3.42.
12. Suppose g and f,(n = 1, 2, 3, ...) are defined on (0, ©), are Riemann-integrable on
[t, T] whenever 0<¢<T< ©, | f,| <9, f,—/f uniformly on every compact sub-
set of (0, 00), and

f g(x) dx < 00.
is)
Prove that
lim [ f,Q)dx= i} fe) dx.

(See Exercises 7 and 8 of Chap. 6 for the relevant definitions.)

This is a rather weak form of Lebesgue’s dominated convergence theorem
(Theorem 11.32). Even in the context of the Riemann integral, uniform conver-
gence can be replaced by pointwise convergence if it is assumed that fe #. (See
the articles by F. Cunningham in Math. Mag., vol. 40, 1967, pp. 179-186, and
by H. Kestelman in Amer. Math. Monthly, vol. 77, 1970, pp. 182-187.)

13. Assume that {f,} is a sequence of monotonically increasing functions on R’ with
0<f.(x) <1 for all x and all x.
(a) Prove that there is a function f and a sequence {n,} such that

I(x) = lim F(x)

for every x € R'. (The existence of such a pointwise convergent subsequence is
usually called Helly’s selection theorem.)
(b) If, moreover, f is continuous, prove that f,, /f uniformly on compact sets.
Hint: (i) Some subsequence {/,,,} converges at all rational points r, say, to
f(r). Gi) Define f(x), for any x € R', to be sup f(r), the sup being taken over all
r<x. (iii) Show that f,,(x) >/f(x) at every x at which f is continuous. (This is
where monotonicity is strongly used.) (iv) A subsequence of {/,,} converges at
every point of discontinuity of f since there are at most countably many such
points. This proves (a). To prove (6), modify your proof of (iii) appropriately.


--- Page 177 ---

168 PRINCIPLES OF MATHEMATICAL ANALYSIS

14,

15.

16.

17.

18.

19.

Let f be a continuous real function on R! with the following properties:
0< f(t) <1, f@¢+2)=f() for every ¢, and

0 O<t<}

f= {" <t<}).

Put O(¢) = (x(t), y(t), where
AO=E 2-3, =P 2-3").

Prove that © is continuous and that ® maps I = [0, 1] onto the unit square J? < R?.
If fact, show that ® maps the Cantor set onto J?.
Hint: Each (xo, yo) € J? has the form

2 C
xo= Y 2-"Gan-15 Yo = 227%

n=t

where each a, is O or 1. If

fo]

to= 3 3-!4ai)

show that f(3*to) = a,, and hence that x(to) = x0, W(to) = Yo.

(This simple example of a so-called ‘space-filling curve’? is due to I. J.
Schoenberg, Bull. A.M.S., vol. 44, 1938, pp. 519.)
Suppose fis a real continuous function on R', f(t) = f(nt) for n=1, 2, 3,..., and
{f,} is equicontinuous on [0, 1]. What conclusion can you draw about f?
Suppose {/,} is an equicontinuous sequence of functions on a compact set K, and
{f,} converges pointwise on K. Prove that {f,} converges uniformly on K.
Define the notions of uniform convergence and equicontinuity for mappings into
any metric space. Show that Theorems 7.9 and 7.12 are valid for mappings into
any metric space, that Theorems 7.8 and 7.11 are valid for mappings into any
complete metric space, and that Theorems 7.10, 7.16, 7.17, 7.24, and 7.25 hold for
vector-valued functions, that is, for mappings into any R*.
Let {f,} be a uniformly bounded sequence of functions which are Riemann-inte-
grable on [a, 5), and put

Fo=[ hod (@<xsb)

Prove that there exists a subsequence {F,,} which converges uniformly on [a, 5].
Let K be a compact metric space, let 5 be a subset of @(K). Prove that S is compact
(with respect to the metric defined in Section 7.14) if and only if S is uniformly
closed, pointwise bounded, and equicontinuous. (If S is not equicontinuous,
then S contains a sequence which has no equicontinuous subsequence, hence has
no subsequence that converges uniformly on K.)


--- Page 178 ---

20.

21

22.

23.

SEQUENCES AND SERIES OF FUNCTIONS 169

If f is continuous on [0, 1] and if
1
i) fGox"dx=0 (n=0,1,2,...)
0

prove that f(x) =0 on [0,1]. Hint: The integral of the product of f with any
1
polynomial is zero. Use the Weierstrass theorem to show that I, S?(x) dx =0.

Let K be the unit circle in the complex plane (i.e., the set of all z with |z| = 1), and
let x be the algebra of all functions of the form

fe") = ¥ cue (8 real).

Then . separates points on K and . vanishes at no point of K, but nevertheless
there are continuous functions on K which are not in the uniform closure of x.
Hint: For every fe &

2x
) fee" d= 0,
oO

and this is also true for every fin the closure of 7.
Assume f € &(«) on [a, 5], and prove that there are polynomials P, such that

bd
lim i) | f— Px |? du =0.
(Compare with Exercise 12, Chap. 6.)
Put Po = 0, and define, for n = 0, 1, 2,...,

Py o:(x) = P,(x) + eo Pie)

Prove that
lim P,(x) = |x|,
nc
uniformly on [—1, 1].
(This makes it possible to prove the Stone-Weierstrass theorem without first

proving Theorem 7.26.)
Hint: Use the identity

[x] —PaesGa)= lal —Po]|1 — LEROY)

to prove that 0 < P,(x) <Pisi(x) < |x| if |x| <1, and that

|x| — Pax) < ixi(1 _ ety <

if |x| <1.


--- Page 179 ---

170 +=PRINCIPLES OF MATHEMATICAL ANALYSIS

24.

25.

Let X be a metric space, with metric d. Fix a point ae X. Assign to each pe X
the function /, defined by
fAx) = d(x, p)—d(x,a) (x € X).
Prove that | f,(x)| <d(a, p) for all x € X, and that therefore f, € G(X).
Prove that
fo — Fall = d(p, @)

for all p,q € X.

If D(p) =f, it follows that ® is an isomerry (a distance-preserving mapping)
of X onto BCX) ¢ G(X).

Let Y be the closure of BCX) in @(X). Show that Y is complete.

Conclusion: X is isometric to a dense subset of a complete metric space Y.
(Exercise 24, Chap. 3 contains a different proof of this.)
Suppose ¢ is a continuous bounded real function in the strip defined by
0<x<1,-—0 <y< oo, Prove that the initial-value problem

y =$(x,y), yO=c
has a solution. (Note that the hypotheses of this existence theorem are less stringent
than those of the corresponding uniqueness theorem; see Exercise 27, Chap. 5.)
Hint: Fix n, Fori=0,..., 7, put x:=i/n. Let f, be a continuous function
on [0, 1] such that f,(0) = ¢,

Slt) = b0x1, fax) if x.<t < X44,
and put
An(t) = fat) — H(t, fa(t)),

except at the points x,, where A,(t) = 0. Then
fix) = e+ { Ub,.A(O) + Malt) dt.

Choose M < © so that |¢| <M. Verify the following assertions.

(a) [fal <M, [4,| <2M, A, €@, and | f,| <|c| + M=M,, say, on [0, 1], for
all n.

(6) {fr} is equicontinuous on [0, 1], since | f;| <M.

(c) Some {f,,} converges to some f, uniformly on [0, 1].

(d) Since ¢ is uniformly continuous on the rectangle O<x <1, |y| <M,

uniformly on [0, 1].
(e) A,(t) > 0 uniformly on [0, 1], since

Ant) = $0015 fale) — $04, fat)

in (Xt, Xt41).


--- Page 180 ---

SEQUENCES AND SERIES OF FUNCTIONS 171

(f) Hence
fa)=e+ f $6, f() at
tt)
This f is a solution of the given problem.
26. Prove an analogous existence theorem for the initial-value problem

y' = (x,y), yO)=c,

where now c € R*, y € R*, and ® is a continuous bounded mapping of the part of
R*+! defined by O< x <1, y € R* into R*. (Compare Exercise 28, Chap, 5.) Hint:
Use the vector-valued version of Theorem 7.25.


--- Page 181 ---

8

SOME SPECIAL FUNCTIONS

POWER SERIES

In this section we shall derive some properties of functions which are represented
by power series, i.e., functions of the form

) £0) = ¥ cx"
or, more generally,
Q) f(x) = ¥en — ay

These are called analytic functions.

We shall restrict ourselves to real values of x. Instead of circles of con-
vergence (see Theorem 3.39) we shall therefore encounter intervals of conver-
gence.

If (1) converges for all x in (—R, R), for some R> 0 (R may be +00),
we say that fis expanded in a power series about the point x = 0. Similarly, if
(2) converges for |x — a| < R, fis said to be expanded in a power series about
the point x = a. As a matter of convenience, we shall often take a = 0 without
any loss of generality.


--- Page 182 ---

SOME SPECIAL FUNCTIONS

8.1 Theorem Suppose the series

(3) 6, x"

converges for |x| < R, and define

o fo)=Lex"  (ix1<B)

173

Then (3) converges uniformly on [—R+ &, R — e], no matter which e>0

is chosen. The function f is continuous and differentiable in (— R, R), and

6) f@)= Yonge! (x1 <P.
Proof Let ¢ > 0 be given. For |x| < R—, we have
|cnx"| <|euCR — €)"| 5
and since
Xc,(R —e)"

converges absolutely (every power series converges absolutely in the
interior of its interval of convergence, by the root test), Theorem 7.10

shows the uniform convergence of (3) on [—R +, R— é].
Since “/n —1asn-—-o, we have

lim sup 2/n|c,| = lim sup “eal,
n7O nwo

so that the series (4) and (5) have the same interval of convergence.

Since (5) is a power series, it converges uniformly in [—R+e,
R-—e], for every ¢ >0, and we can apply Theorem 7.17 (for series in-

stead of sequences). It follows that (5) holds if |x| < R—«.

But, given any x such that |x| < R, we can find an ¢ > 0 such that

|x| <.R-—e. This shows that (5) holds for |x| < R.
Continuity of f follows from the existence of f’ (Theorem 5.2).

Corollary Under the hypotheses of Theorem 8.1, f has derivatives of all

orders in (—R, R), which are given by

(6) SR) = VY nn-VY- (HQ —k + Ve, x"*
n=k
In particular,

(7) fO) =k  (k =0,1,2,...).
(Here f© means f, and f™ is the kth derivative of f, for k = 1, 2, 3, ...).


--- Page 183 ---

174 PRINCIPLES OF MATHEMATICAL ANALYSIS

Proof Equation (6) follows if we apply Theorem 8.1 successively to f,
S'S", .... Putting x = 0 in (6), we obtain (7).

Formula (7) is very interesting. It shows, on the one hand, that the
coefficients of the power series development of f are determined by the values
of fand of its derivatives at a single point. On the other hand, if the coefficients
are given, the values of the derivatives of f at the center of the interval of con-
vergence can be read off immediately from the power series.

Note, however, that although a function f may have derivatives of all
orders, the series Zc, x", where c, is computed by (7), need not converge to f(x)
for any x #0. In this case, cannot be expanded in a power series about x = 0.
For if we had f(x) = Za, x", we should have

nia, =f);
hence a, =c,. An example of this situation is given in Exercise 1.

If the series (3) converges at an endpoint, say at x = R, then fis continuous
not only in (—R, R), but also at x = R. This follows from Abel’s theorem (for
simplicity of notation, we take R = 1):

8.2 Theorem Suppose Xc, converges. Put
Ce]
S@)=Veqx" (-1<x<1).
n=0
Then
(8) lim f(x) = ¥ ¢,-
x71 n=0
Proof Let s,=c¢co +’ +¢,,5-; =0. Then
m Lad m-1
Yep x" = Yo (Sq — Sy) x" = (1 — x) YS, x + Sy
a=0 n=0 a=0
For |x| < 1, we let m — 00 and obtain
wo
(9) f(x) = (1 — x) Ls x",

Suppose s = lim s,. Let ¢ > 0 be given. Choose N so that n> N

nwo

implies

é
|s—s,| <3


--- Page 184 ---

SOME SPECIAL FUNCTIONS 175

Then, since
(1 - yx =1 ({x|<1),
we obtain from (9)
If) -s1=|d- 95 (4 -92"| <9 Y Ions] lal" 45 se

if x > 1 — 6, for some suitably chosen 6 > 0. This implies (8).
As an application, let us prove Theorem 3.51, which asserts: Jf Za,, Lb, ,
Le,, converge to A, B, C, and if c,=agb, + ++: +a,b9, then C= AB. We let
wo foe] fe o)
SQ) =a", g)= PL bx, Wa) =D cnx

for O<x<1. For x <1, these series converge absolutely and hence may be
multiplied according to Definition 3.48; when the multiplication is carried out,
we see that

(10) T(x) 9g) = A(x) (O<x<1).
By Theorem 8.2,
(11) f@)74, 9®)7B A) HC

as x >1. Equations (10) and (11) imply AB = C.
We now require a theorem concerning an inversion in the order of sum-
mation. (See Exercises 2 and 3.)

8.3 Theorem Given a double sequence {a,;}, i= 1, 2, 3, ..., j=1, 2, 3,...,
suppose that

and Xb, converges. Then

o wo

(13) y Lau= dh Vay.
t=1j=1 J=Hiisi
Proof We could establish (13) by a direct procedure similar to (although
more involved than) the one used in Theorem 3.55. However, the following
method seems more interesting.


--- Page 185 ---

176 PRINCIPLES OF MATHEMATICAL ANALYSIS

Let £ be a countable set, consisting of the points x9, x1, x2,..., and
suppose x, >X9 asn—oo. Define

(14) fia) = Say @=1,2,3,-.9,

(i,n=1, 2,3,...),

Gi;

tae 3

(15) Fi%n) =

j=1

(16) g(x) = ¥ fe) (xe E).

Now, (14) and (15), together with (12), show that each /; is con-
tinuous at x9. Since |f,(x)| < 5; for x € E, (16) converges uniformly, so
that g is continuous at x» (Theorem 7.11). It follows that

YY ay = Yeo) = aC) = lim g(x)

imi j=1
- 2 . co on
=limY f(x,) =lim Y Ya,
n>oisl nto i=1 j=l
0

nto f=liel jFiis
8.4 Theorem Suppose
2]
f@) = YX",
n=0

the series converging in |x|<R. If —R<a<R, then f can be expanded ina
power series about the point x = a which converges in |x — a|< R— |a|, and

2 £@)
(17) f(x) = or mI ——(x-a)"  (|x-a|<R-|al).

This is an extension of Theorem 5.15 and is also known as Taylor’s

theorem.

Proof We have

ft) = ¥ ele — a) + a
= 2,0 oy (r ) ane 7 ay

-¥, (",) at] (x — a)”.

n=m


--- Page 186 ---

SOME SPECIAL FUNCTIONS 177

This is the desired expansion about the point x = a. To prove its validity,
we have to justify the change which was made in the order of summation.
Theorem 8.3 shows that this is permissible if

8 o Rn
° 2 xe

converges. But (18) is the same as

Cn (4 a’~™(x — a)”

(19) ¥ lea (x —al +14)’

and (19) converges if |x —a| + |a|<R.
Finally, the form of the coefficients in (17) follows from (7).

It should be noted that (17) may actually converge in a larger interval than
the one given by |x —a|< R- |al.

If two power series converge to the same function in (—R, R), (7) shows
that the two series must be identical, i.e., they must have the same coefficients.
It is interesting that the same conclusion can be deduced from much weaker
hypotheses :

8.5 Theorem Suppose the series La,x" and Xb,x" converge in the segment
S=(—R, R). Let E be the set of all x € S at which

(20) y a,x" = ¥ by x.
na=0 n=0

If E has a limit point in S, then a, = 6, forn =0, 1, 2,.... Hence (20) holds for
allxeS.

Proof Put c, =a, — 6, and
(21) fx=Sex" (eS).
n=0

Then f(x) =0 on E.

Let A be the set of all limit points of F in S, and let B consist of all
other points of S. It is clear from the definition of “limit point” that B
is open. Suppose we can prove that A is open. Then A and B are disjoint
open sets. Hence they are separated (Definition 2.45). Since S= AUB,
and S is connected, one of A and B must be empty. By hypothesis, A is
not empty. Hence B is empty, and A = S. Since fis continuous in S,
AcE, Thus E = S, and (7) shows that c, = 0 form =0, 1, 2,..., which
is the desired conclusion.


--- Page 187 ---

178 PRINCIPLES OF MATHEMATICAL ANALYSIS

Thus we have to prove that A is open. If x) € A, Theorem 8.4 shows
that

22) f0) = ¥ dy xo)" (|= Ho] < R= ||)

We claim that d, = 0 for all 7. Otherwise, let k be the smallest non-
negative integer such that d, #0. Then
(23) F(X) = — xo)'9(X) (JX — X09] < R—- [0]),
where

(24) g(x) = X, G+ m(% — Xo)”.
Since g is continuous at x» and

(Xo) = 4, #0,

there exists a 6 > 0 such that g(x) #0 if |x ~— xo>| <6. It follows from
(23) that f(x) #0 if 0< |x —x 9} <6. But this contradicts the fact that
Xo is a limit point of E.

Thus d, = 0 for all n, so that f(x) = 0 for all x for which (22) holds,
i.e., in a neighborhood of x). This shows that A is open, and completes
the proof.

THE EXPONENTIAL AND LOGARITHMIC FUNCTIONS
We define

a

(25) E@)= y=

The ratio test shows that this series converges for every complex z. Applying
Theorem 3.50 on multiplication of absolutely convergent series, we obtain

zg" 2 ym ~ n gkywrn*
=0 mi!

FOE) = ai eo mi ~ do ko kia Bi

n=0 n! =o k n=0 n!}

Ms

which gives us the important addition formula
(26) E(z + w) = EE) (z, w complex).
One consequence is that
(27) E(z)E(—z) = E(@ — z) = E(0) =1 (z complex).


--- Page 188 ---

SOME SPECIAL FUNCTIONS 179

This shows that Z(z) #0 for all z. By (25), E(x) > 0 if x > 0; hence (27) shows
that E(x) > 0 for all real x. By (25), E(x) > +00 as x + +00; hence (27) shows
that E(x) +0 as x + —oo along the real axis. By (25), 0 < x < y implies that
E(x) < Ely); by (27), it follows that E(—y) < E(— x); hence E is strictly in-
creasing on the whole real axis.

The addition formula also shows that

E(z + h) — E(z) E(h)
h

(28) lim = E(z) lim a E(2);
h=0 h=0 h

the last equality follows directly from (25).
Iteration of (26) gives
(29) E(z, + +++ + 2,) = E(z,) +++ E(Z,).

Let us take z, = *': =z, = 1. Since E(1) =e, where e is the number defined
in Definition 3.30, we obtain

(30) E(n) =e" (n = 1, 2,3, ...).
If p = n/m, where n, m are positive integers, then

(31) [E(p)]" = E(mp) = E(n) = e",
so that

(32) E(p)=e? (p>0,p rational).

It follows from (27) that E(—p) = e~” if p is positive and rational. Thus (32)
holds for all rational p.
In Exercise 6, Chap. 1, we suggested the definition

(33) x? = sup x?,

where the sup is taken over all rational p such that p < y, for any rea! y, and
x > 1. If we thus define, for any real x,

(34) e“=supe? (p<x, prational),
the continuity and monotonicity properties of E, together with (32), show that
(35) E(x) =e*

for all real x. Equation (35) explains why E is called the exponential function.
The notation exp (x) is often used in place of e*, expecially when x is a
complicated expression.
Actually one may very well use (35) instead of (34) as the definition of e*;
(35) is a much more convenient starting point for the investigation of the
Properties of e*. We shall see presently that (33) may also be replaced by a
more convenient definition [see (43)].


--- Page 189 ---

180 PRINCIPLES OF MATHEMATICAL ANALYSIS

We now revert to the customary notation, e*, in place of E(x), and sum-
marize what we have proved so far.

8.6 Theorem Let e* be defined on R' by (35) and (25). Then
(a) e* is continuous and differentiable for all x;
(6) @y =e;
(c) e* isa strictly increasing function of x, and e* > 0;
(d) e*t? = e%e);
(e-) e*>~+0 asx—++o, e* -0asx>—o;
(f) lim,.4,.*"e"* = 0, for every n.
Proof We have already proved (a) to (e); (25) shows that
xnt i
* 7 ast!
for x > 0, so that
!
xe * < @+p!
x

and (f) follows. Part (f) shows that e* tends to +00 “faster” than any
power of x, as x ~ +00.

Since E is strictly increasing and differentiable on R', it has an inverse
function L which is also strictly increasing and differentiable and whose domain
is E(R'), that is, the set of all positive numbers. L is defined by

(36) ELY))=y (>),
or, equivalently, by
(37) L(E(x))=x (x real).

Differentiating (37), we get (compare Theorem 5.5)
L'(E(x)) + E(x) = 1.
Writing y = E(x), this gives us

; 1
(38) L(y) = (y > 0).
Taking x = 0 in (37), we see that L(1) =0. Hence (38) implies

¥ dx

(39) Lo)= f=.


--- Page 190 ---

SOME SPECIAL FUNCTIONS 181

Quite frequently, (39) is taken as the starting point of the theory of the logarithm
and the exponential function. Writing u = E(x), v = E()), (26) gives

Luv) = L(E(x) + E(y)) = (E(x + y)) =x + y,
so that
(40) L(uv) = L(u) + Lv) (u>0,v>0).
This shows that Z has the familiar property which makes logarithms useful
tools for computation. The customary notation for L(x) is of course log x.
As to the behavior of log x as x > +00 and as x +0, Theorem 8.6(e)
shows that
log x + +00 asx +0,
log x + —00 as x +0.
It is easily seen that
(41) x" = E(nL(x))

if x > 0 and a is an integer. Similarly, if m is a positive integer, we have
1

(42) xm = E(— L(s)),
m

since each term of (42), when raised to the mth power, yields the corresponding
term of (36). Combining (41) and (42), we obtain

(43) x* = E(aL(x)) = e*!8*

for any rational a.

We now define x*, for any real « and any x > 0, by (43). The continuity
and monotonicity of E and L show that this definition leads to the same result
as the previously suggested one. The facts stated in Exercise 6 of Chap. 1, are
trivial consequences of (43).

If we differentiate (43), we obtain, by Theorem 5.5,

(44) (x*)’ = E(aL(x)) « = = axt},

Note that we have previously used (44) only for integral values of «, in which
case (44) follows easily from Theorem 5.3(b). To prove (44) directly from the
definition of the derivative, if x* is defined by (33) and « is irrational, is quite
troublesome.

The well-known integration formula for x* follows from (44) if « # —1,

and from (38) if «= —1. We wish to demonstrate one more property of log x,
namely,
(45) lim x~*logx=0

x7 +0


--- Page 191 ---

182 PRINCIPLES OF MATHEMATICAL ANALYSIS

for every « > 0. That is, log x + +00 “slower” than any positive power of x,
as xX > +00.
For if 0 < e<a, and x > 1, then

x x
x* log x = x79 f rtdt<x*f te! dt
1 1

x®—-1 x*%
<
g g

=x *: >

and (45) follows. We could also have used Theorem 8.6(/) to derive (45).

THE TRIGONOMETRIC FUNCTIONS
Let us define

(46) C(x) = ; [E(ix) + E(-ix)], SQ) = S [E(ix) — E(—ix)].

We shall show that C(x) and S(x) coincide with the functions cos x and sin x,
whose definition is usually based on geometric considerations. By (25), E(Z) =

E(z). Hence (46) shows that C(x) and S(x) are real for real x. Also,
(47) E(ix) = C(x) + iS(x).

Thus C(x) and S(x) are the real and imaginary parts, respectively, of E(ix), if
xis real. By (27),

| E(ix)|? = Eli EG) = Ex) E(- ix) = 1,

so that
(48) | E(ix)| =1 (x real).

From (46) we can read off that C(0) = 1, S(0) = 0, and (28) shows that
(49) C(x) = — S(x), S’(x) = C(x).

We assert that there exist positive numbers x such that C(x) =0. For
suppose this is not so. Since C(0) = 1, it then follows that C(x) > 0 for all
x > 0, hence S’(x) > 0, by (49), hence S is strictly increasing; and since S(O) = 0,
we have S(x) > Oif x > 0. Hence if 0 < x < y, we have

(50) Suny - x) < | "S(t) dt = C(x) - C(y) <2.

The last inequality follows from (48) and (47). Since S(x) > 0, (50) cannot be
true for large y, and we have a contradiction.


--- Page 192 ---

SOME SPECIAL FUNCTIONS 183

Let x9 be the smallest positive number such that C(x)) = 0. This exists,
since the set of zeros of a continuous function is closed, and C(0) #0. We
define the number z by

(51) TN = 2X9.

Then C(x/2) =0, and (48) shows that S(z/2) = +1. Since C(x) >0 in
(0, x/2), S is increasing in (0, 2/2); hence S(x/2) = 1. Thus

and the addition formula gives

(52) E(xi) = -1, E(2ni) = 1;
hence

(53) E(z + 2xi) = E(z) (z complex).
8.7 Theorem

(a) The function E is periodic, with period 2ni.

(b) The functions C and S are periodic, with period 2n.

(c) IfQ0<t< 2z, then E(it) #1.

(d) If zis a complex number with |z| = 1, there is a unique t in [0, 27)
such that Eit) = z.

Proof By (53), (a) holds; and (6) follows from (a) and (46).
Suppose 0 < t < x/2 and E(it) = x + iy, with x, y real. Our preceding
work shows that 0 <x<1,0<y<1. Note that

E(4it) = (x + iy)* = x* — 6xy? + yt + dixy(x? — y?).

If E(4it) is real, it follows that x? — y? =0; since x? + y? = 1, by (48),
we have x? = y? = 4, hence E(4it) = —1. This proves (c).
IfO<t, <t, < 27, then

E(it, [E(it,))"* = E(it, — ity) #1,

by (c). This establishes the uniqueness assertion in (d).

To prove the existence assertion in (d), fix z so that |z| = 1. Write
z=x-+ iy, with x and y real. Suppose first that x >0 and y>0. On
[0, x/2], C decreases from I to 0. Hence C(t) = x for some te [0, 2/2].
Since C? + S? = 1 and S>0 on [0, n/2], it follows that z = E(it).

If x <0 and y 20, the preceding conditions are satisfied by — iz.
Hence —iz = E(it) for some t € [0, 2/2], and since i = E(ni/2), we obtain
z= E(i(t+7/2)). Finally, if y <0, the preceding two cases show that


--- Page 193 ---

184 PRINCIPLES OF MATHEMATICAL ANALYSIS

—z= E(it) for some te (0, 2). Hence z = — E(it) = E(i(t + 2)).
This proves (d), and hence the theorem.

It follows from (d) and (48) that the curve » defined by
(54) yt)= EGt) (<t<2n)
is a simple closed curve whose range is the unit circle in the plane. Since
y'(t) =iE(it), the length of y is

2n
{ ly@] at = 22,

by Theorem 6.27. This is of course the expected result for the circumference of
a circle of radius 1. It shows that z, defined by (51), has the usual geometric
significance.

In the same way we see that the point y(r) describes a circular arc of length
to as ¢ increases from 0 to fg. Consideration of the triangle whose vertices are
Z7,=0, = Z2 = p(“o); Z3 = C(to)
shows that C(t) and S(t) are indeed identical with cos ¢ and sin ¢, if the latter

are defined in the usual way as ratios of the sides of a right triangle.

It should be stressed that we derived the basic properties of the trigono-
metric functions from (46) and (25), without any appeal to the geometric notion
of angle. There are other nongeometric approaches to these functions. The
papers by W. F. Eberlein (Amer. Math. Monthly, vol. 74, 1967, pp. 1223-1225)
and by G. B. Robison (Math. Mag., vol. 41, 1968, pp. 66-70) deal with these
topics.

THE ALGEBRAIC COMPLETENESS OF THE COMPLEX FIELD

We are now in a position to give a simple proof of the fact that the complex
field is algebraically complete, that is to say, that every nonconstant polynomial
with complex coefficients has a complex root.

8.8 Theorem Suppose ag, ..., a, are complex numbers, n> 1, a, #9,
n
P(z) => a, 2".
6

Then P(z) = 0 for some complex number z.
Proof Without loss of generality, assume a, = 1. Put
(55) y= inf | P(z)| (z complex)
If |z| = R, then
(56) |P(z)| = Rl — |a,-1]|Ro* — +++ — |ao| R~")-


--- Page 194 ---

SOME SPECIAL FUNCTIONS 185

The right side of (56) tends to 0 as R00. Hence there exists Rp such
that |P(z)| > wif |z| > Ro. Since |P| is continuous on the closed disc
with center at 0 and radius Ry, Theorem 4.16 shows that | P(zo)| = for
some Zo.

We claim that p = 0.

If not, put Q(z) = P(z + 29)/P(Zo). Then @Q is a nonconstant poly-
nomial, Q(0) = 1, and | Q(z)| = 1 for all z. There is a smallest integer k,
1<k <n, such that

(57) O(z)=14+b,2*4+ +++ +5,2", db, #0.
By Theorem 8.7(d) there is a real 6 such that
(58) e*®b, = | by | .

If r > 0 and r*|b,| < 1, (58) implies
\1 + b, r*ei*| = 1 - r* byl,
so that
| O(re'*)| <1 — r{|b,| _ r| bes] 7 rk ba |}.

For sufficiently small r, the expression in braces is positive; hence
| Q(re'®)| < 1, a contradiction.
Thus yu = 0, that is, P(zo) = 0.

Exercise 27 contains a more general result.

FOURIER SERIES

8.9 Definition A trigonometric polynomial is a finite sum of the form
N

(59) f(x) =a9 + YG, cosnx+b,sinnx) (x real),
n=1

where dy,..., dy, 04,.--, by are complex numbers. On account of the identities
(46), (59) can also be written in the form

(60) f(x) = y c,e"* (x real),

which is more convenient for most purposes. It is clear that every trigonometric
polynomial is periodic, with period 27.

If n is a nonzero integer, e’"* is the derivative of e'"*/in, which also has
period 2x. Hence

1p me, fl (ifn =0),
(61) aml! dx = |) (ifn = +1, +2,...).


--- Page 195 ---

186 PRINCIPLES OF MATHEMATICAL ANALYSIS

Let us multiply (60) by e~'"*, where m is an integer; if we integrate the
product, (61) shows that

(62) Cm = x } . fen ™ dx

for |m| < N. If |m|>N, the integral in (62) is 0.

The following observation can be read off from (60) and (62): The
trigonometric polynomial f, given by (60), is real if and only if c_, = c, for
n=0,...,N.

In agreement with (60), we define a trigonometric series to be a series of
the form

(63) Yc,e — (x real);

the Nth partial sum of (63) is defined to be the right side of (60).

If f is an integrable function on [—7z, z], the numbers c,, defined by (62)
for all integers m are called the Fourier coefficients of f, and the series (63) formed
with these coefficients is called the Fourier series of f.

The natural question which now arises is whether the Fourier series of f
converges to f, or, more generally, whether fis determined by its Fourier series.
That is to say, if we know the Fourier coefficients of a function, can we find
the function, and if so, how?

The study of such series, and, in particular, the problem of representing a
given function by a trigonometric series, originated in physical problems such
as the theory of oscillations and the theory of heat conduction (Fourier’s
“Théorie analytique de la chaleur” was published in 1822). The many difficult
and delicate problems which arose during this study caused a thorough revision
and reformulation of the whole theory of functions of a real variable. Among
many prominent names, those of Riemann, Cantor, and Lebesgue are intimately
connected with this field, which nowadays, with all its generalizations and rami-
fications, may well be said to occupy a central position in the whole of analysis.

We shall be content to derive some basic theorems which are easily
accessible by the methods developed in the preceding chapters. For more
thorough investigations, the Lebesgue integral is a natural and indispensable
tool.

We shall first study more general systems of functions which share a
property analogous to (61).

8.10 Definition Let {¢,} (n = 1, 2, 3,...) be a sequence of complex functions
on [a, 5], such that

b —
(64) [ Pu(X)Pm(x) dx =O (n #™m).


--- Page 196 ---

SOME SPECIAL FUNCTIONS 187

Then {@,} is said to be an orthogonal system of functions on [a, b]. If, in addition,
b
(65) f Ida]? dx = 1

for all n, {¢,} is said to be orthonormal.
For example, the functions (22)~+e'"* form an orthonormal system on
{[—2, z]. So do the real functions

1 cosx sinx cos2x sin2x
If {¢,} is orthonormal on [a, b] and if
b
(66) c=/ SOGOMd  (=1,2,3,...,

we call c, the mth Fourier coefficient of f relative to {f,}. We write

co

and call this series the Fourier series of f (relative to {¢,}).

Note that the symbol ~ used in (67) implies nothing about the conver-
gence of the series; it merely says that the coefficients are given by (66).

The following theorems show that the partial sums of the Fourier series
of f have a certain minimum property. We shall assume here and in the rest of
this chapter that fe Z, although this hypothesis can be weakened.

8.11 Theorem Let {¢,} be orthonormal on [a, b]. Let

(68) Su() = Di Cm Pn)
be the nth partial sum of the Fourier series of f, and suppose
(69) 1502) = Y Yn Pl
Then
b b
(70) [f-slaxs f ifs)? ax,

and equality holds if and only if
(71) Ym = lm (m=l1,...,n).

That is to say, among all functions t,, s, gives the best possible mean
square approximation to f.


--- Page 197 ---

188 PRINCIPLES OF MATHEMATICAL ANALYSIS

Proof Let j denote the integral over [a, 6], = the sum from 1 to n. Then
[fia = [FD Fn Fm =X Cm Fn
by the definition of {c,,},
Flt? =f tats = [Ere be E HPs =D Lye?
since {@,,} is orthonormal, and so
fitted? = fl? - fia — [ite + f deal?
= [FI =F nm — E En Im + DS Ym Fo
= [UP =¥ lel? +E 9m — Gnd?

which is evidently minimized if and only if y,, = c,-
Putting »,, = C,, in this calculation, we obtain

b n b
(72) [ IsGO1? dx = ¥ lewl? < J LF@)I? ax,
a 1 a
since {| f—t,|? > 0.

8.12 Theorem If {¢,} is orthonormal on [a, b}, and if

eo

F(x) ~ Lon ,(X),
then
oO b
(73) Ylal?s i, F(x) |? dex.
In particular,
(74) lim c, = 0.

Proof Letting noo in (72), we obtain (73), the so-called “Bessel
inequality.”

8.13 Trigonometric series From now on we shall deal only with the trigono-
metric system. We shal! consider functions f that have period 27 and that are
Riemann-integrable on [—z, x] (and hence on every bounded interval). The
Fourier series of f is then the series (63) whose coefficients c, are given by the
integrals (62), and

N
(75) Sy(X) = Sy(f5 x) = p> c,e™


--- Page 198 ---

SOME SPECIAL FUNCTIONS 189

is the Nth partial sum of the Fourier series of f The inequality (72) now takes
the form

1 ® N 1 fd
(76) spb Iswanl? dx = 3d lel? soz J GDI? ae

In order to obtain an expression for sy that is more manageable than (75)
we introduce the Dirichlet kernel

N sin (N + 4)x

D = mx = .
(77) we) p> Ne sin (x/2)
The first of these equalities is the definition of D,(x). The second follows if
both sides of the identity

(e* _ 1)Dy(x) = el(N +1)x _ e INx
are multiplied by e7 */?.
By (62) and (75), we have

N Jj 7 . .
Wfi=Y sf foe deem

_ 1 f FOS el at
On -2 —N ,
so that
8) fi=— [SOK Nadas [fe —NDMO at
WN On dan N ~ Undid w(t) at.
The periodicity of all functions involved shows that it is immaterial over which
interval we integrate, as long as its length is 2x. This shows that the two integrals
in (78) are equal.
We shall prove just one theorem about the pointwise convergence of

Fourier series.

8.14 Theorem /f, for some x, there are constants 6 >0 and M < @ such that

(79) If + t)-f@)| < Mt

for all te(—6, 5), then

(80) lim sy(f; x) = f(x).
N->o

Proof Tefine

(81) f(x — t)-f@)

a) =a


--- Page 199 ---

190 PRINCIPLES OF MATHEMATICAL ANALYSIS

for 0 < |t| <2, and put g(0) = 0. By the definition (77),

] n
aa) Px dx =1.

Hence (78) shows that
sFix)—S@) =5- fale) sin (w + 5)! dt

1 t]. 1 /@ t
=> ) _. Ee cos ;| sin Nt dt + an f Jay sin ;| cos Nt dt.

By (79) and (81), g(t) cos (t/2) and g(t) sin (t/2) are bounded. The last
two integrals thus tend to 0 as N- 0, by (74). This proves (80).

Corollary If f(x) =0 for all x in some segment J, then lim sy(f; x) = 0 for
every xeJ.

Here is another formulation of this corollary:
If f(t) = g(t) for all t in some neighborhood of x, then
Sy; x) — Sy; x) = Sy(f— 9; x) 70. as N00.

This is usually called the /ocalization theorem. Jt shows that the behavior
of the sequence {s,(f; x)}, as far as convergence is concerned, depends only on
the values of f in some (arbitrarily small) neighborhood of x. Two Fourier
series may thus have the same behavior in one interval, but may behave in
entirely different ways in some other interval. We have here a very striking
contrast between Fourier series and power series (Theorem 8.5).

We conclude with two other approximation theorems.

8.15 Theorem [ff is continuous (with period 2n) and if ¢ > 0, then there is a
trigonometric polynomial P such that

| P(x) — f(x) <

for all real x.

Proof If we identify x and x + 27, we may regard the 22-periodic func-
tions on R! as functions on the unit circle 7, by means of the mapping
x —e'*, The trigonometric polynomials, i.e., the functions of the form
(60), form a self-adjoint algebra /, which separates points on 7, and
which vanishes at no point of T. Since T is compact, Theorem 7.33 tells
us that / is dense in (7). This is exactly what the theorem asserts.

A more precise form of this theorem appears in Exercise 15.


--- Page 200 ---

SOME SPECIAL FUNCTIONS 191

8.16 Parseval’s theorem Suppose f and g are Riemann-integrable functions
with period 2x, and

(82) fOV~S ee, g~ Y yel™
Then ” “

(83) tim =f" Lf) — 56s 91? dx = 0,

(84) 5 J P00) dx =F ete
(85 sf Wel? ax = F Jey?

Proof Let us use the notation
1 ¢ 2
(86 Wala ={5- J Ineo l? ax|

Let e > 0 be given. Since fe Z and f(z) = f(—72), the construction
described in Exercise 12 of Chap. 6 yields a continuous 27-periodic func-
tion A with

(87) If—Allz <e.

By Theorem 8.15, there is a trigonometric polynomial P such that
| h(x) — P(x)| <e for all x. Hence ||a—Pll,<e. If P has degree No,
Theorem 8.11 shows that

1/2

(88) |k — sy(A)|l2 < ||A — Pilz <e
for all N= No. By (72), with A — fin place of f,
(89) IIsy(A) — spf lla = IIsw(h —S)ll2 SA —S ln <8

Now the triangle inequality (Exercise 11, Chap. 6), combined with
(87), (88), and (89), shows that

(90) If-snA)l2<3e (NZ Np).
This proves (83). Next,

(91 Lf” syifg dx = Sc =f eg) dx = ¥ og5
) ad Su de = Yen =f eGR) de = Y ey
and the Schwarz inequality shows that

(92) [ra = [vie <|\f- sig) < {fl7—sel? figl?}



--- Page 201 ---

192 PRINCIPLES OF MATHEMATICAL ANALYSIS

which tends to 0, as N > 00, by (83). Comparison of (91) and (92) gives
(84). Finally, (85) is the special case g =f of (84).

A more general version of Theorem 8.16 appears in Chap. 11.

THE GAMMA FUNCTION

This function is closely related to factorials and crops up in many unexpected
places in analysis. Its origin, history, and development are very well described
in an interesting article by P. J. Davis (Amer. Math. Monthly, vol. 66, 1959,
pp. 849-869). Artin’s book (cited in the Bibliography) is another good elemen-
tary introduction.

Our presentation will be very condensed, with only a few comments after
each theorem. This section may thus be regarded as a large exercise, and as an
opportunity to apply some of the material that has been presented so far.

8.17 Definition For0<x <0,
(93) T(x) = ) t1e-* dy,
0

The integral converges for these x. (When x <1, both 0 and oo have to
be looked at.)

8.18 Theorem
(a) The functional equation
T@w4+1)=sT@)

holds if0<x<o.
(6) T@t+1)=na! forn =1, 2,3,....
(c) log I is convex on (0, 0).

Proof An integration by parts proves (a). Since I'(1) = 1, (a) implies

(b), by induction. If 1 <p < oo and (1/p) + (1/q) = 1, apply Hdlder’s
inequality (Exercise 10, Chap. 6) to (93), and obtain

r(= + 2) < T(x)'FGy)4.
P @q
This is equivalent to (c).

It is a rather surprising fact, discovered by Bohr and Mollerup, that
these three properties characterize ' completely.


--- Page 202 ---

SOME SPECIAL FUNCTIONS 193

8.19 Theorem If f is a positive function on (0, 0) such that
(a) fxt+l)=xf@),
(6) f(l)=1,
(c) log fis convex,

then f(x) = T(x).

Proof Since I satisfies (a), (6), and (c), it is enough to prove that f(x) is
uniquely determined by (a), (6), (c), for all x > 0. By (@), it is enough to
do this for x € (0, 1).

Put » = logf. Then

(94) o(x + 1) = o(x) + log x (0<x< o),

(1) = 0, and @ is convex. Suppose 0 < x < 1, and n is a positive integer.
By (94), o(2 + 1) = log(n!). Consider the difference quotients of @ on the
intervals [n,n + 1], [2 +1,2+1+4+-], [n+1,n+2]. Since g is convex

Repeated application of (94) gives
p(n + 1 + x) = p(x) + log [x + 1) +++ +2)).
Thus

tn*
ail | sx tog (1 +2).

0< 00) - bes | paral

The last expression tends to 0 asm + 00. Hence (x) is determined, and
the proof is complete.

As a by-product we obtain the relation

(95) P(e) = tim ——2
no (xX +1)°*° (x +n)

at least when 0 < x < 1; from this one can deduce that (95) holds for all x > 0,
since T(x + 1) = xF(x).
8.20 Theorem Jf x > 0 and y> 0, then

r@ro)
T(x+y)

1
(96) I, Pod —1yct des

This integral is the so-called beta function B(x, y).


--- Page 203 ---

194 PRINCIPLES OF MATHEMATICAL ANALYSIS

Proof Note that B(1, y) = 1/y, that log B(x, y) is a convex function of
x, for each fixed y, by Hélder’s inequality, as in Theorem 8.18, and that

(97) Bx +1,y) = 5 BOs y).

To prove (97), perform an integration by parts on
Bx+ly)= {. ( ) (1 — #**9-? dt.

These three properties of B(x, y) show, for each y, that Theorem 8.19
applies to the function f defined by
Ta@ty)

To) Be?

f(x) =
Hence f(x) = T(x).

8.21 Some consequences The substitution ¢ = sin? 6 turns (96) into

ai? - - TOTO)
2x-1 2y-1
(98) 2 i, (sin 6)?*-* (cos 6)?" * d0 == Tai
The special case x = y = } gives
(99) 1) = /7.
The substitution ¢ = s? turns (93) into
(100) T(x) =2 f sleds (O<x< 0).
0
The special case x = } gives
(101) fo efdsaJ/n.
— ao
By (99), the identity
“1 1
(102) T(x) = <r (5 rE)
tT

follows directly from Theorem 8.19.
8.22 Stirling’s formula This provides a simple approximate expression for
T(x + 1) when x is large (hence for 2! when n is large). The formula is

Tx +)


--- Page 204 ---

SOME SPECIAL FUNCTIONS 195

Here is a proof. Put ¢ = x(J + u) in (93). This gives
(104) T(x + 1) = x4? e* f [A + we™*P du.
-1
Determine /(u) so that A(0) = 1 and
uz
(105) (1 + uje~" = exp |- z na
if -l1<u<o,u#0. Then
2
(106) h(u) = a [wu — log (1 + w)].

It follows that A is continuous, and that A(u) decreases monotonically from 0
to 0 as w increases from —1 to oo.
The substitution u = s J 2/x turns (104) into

(107) Tet iyaxte* Jif als) ds

where

_ fexp[—s?A(s Jax) (—./x/2< 5 < «),
vals) = [F Goa

Note the following facts about W,(s):

(a) For every s, ,(s) +e7” as x 300.

(b) The convergence in (a) is uniform on [— A, A], for every 4 < oo.
(c) When s <0, then 0< p(s) <e7™.

(d) When s>0 and x > 1, then 0 < #,(s) < W,(s).

(e) JF W(s) ds < w.

The convergence theorem stated in Exercise 12 of Chap. 7 can therefore

be applied to the integral (107), and shows that this integral converges to J Tt
as x > 00, by (101). This proves (103),

A more detailed version of this proof may be found in R. C. Buck’s
“Advanced Calculus,” pp. 216-218. For two other, entirely different, proofs,
see W. Feller’s article in Amer. Math. Monthly, vol. 74, 1967, pp. 1223-1225
(with a correction in vol. 75, 1968, p. 518) and pp. 20-24 of Artin’s book.

Exercise 20 gives a simpler proof of a less precise result.


--- Page 205 ---

196 PRINCIPLES OF MATHEMATICAL ANALYSIS

EXERCISES
1. Define

_ fe? (#0),
fe) = (0 (x=0).

Prove that f has derivatives of all orders at x=0, and that f()=0 for
n=1,2,3,....

2. Let a,, be the number in the ith row and jth column of the array

—]l 0 0 0
+ -1 0 0
t + -1 0
4 4 4-1
so that
0 G<ys),
2-t > s)
Prove that

3. Prove that
EE aE Ray

if a.y > 0 for all ¢ and j (the case + 00 = +00 may occur).
4. Prove the following limit relations:

C7

} =logb (6>0).

_ oF —
@ in

(b) lim C2 A+) _ 1.
x70 x
(c) lim d+x)'"=e,

. x\"
(4) lim (142) = e*,


--- Page 206 ---

SOME SPECIAL FUNCTIONS 197

5. Find the following limits

_e—(1+ x)
(@) lim x .

n
login

(5) lim [n'/" — 1].

(c) lim tan x — x

x70 x(1 — cos x)"

(d) lim 2S |
xoo tan x—x

6. Suppose f(x) f(y) = f(x + y) for all real x and y.
(a) Assuming that f is differentiable and not zero, prove that

f(x) = e*

where c is a constant.
(6) Prove the same thing, assuming only that f is continuous.

7.1f0<x< 5 prove that

2 sin x

<i.

8. For n= 0, 1, 2,..., and x real, prove that
|sin nx| <n|sin x].
Note that this inequality may be false for other values of . For instance,
|sin 4or| > $[{sin z|.
9. (a) Put sy=14+(3)+°::+(1/N). Prove that
lim (sy — log N)
Noo
exists. (The limit, often denoted by y, is called Euler’s constant. Its numerical
value is 0.5772.... It is not known whether y is rational or not.)
(6) Roughly how large must m be so that N = 10” satisfies sy > 100?
10. Prove that > 1/p diverges; the sum extends over all primes.

(This shows that the primes form a fairly substantial subset of the positive
integers.)


--- Page 207 ---

198 PRINCIPLES OF MATHEMATICAL ANALYSIS

Hint: Given N, let pi, ..., px be those primes that divide at least one in-
teger <N. Then

The last inequality holds because
(1 — x)7! <e*

ifO<x<h.
(There are many proofs of this result. See, for instance, the article by
I. Niven in Amer. Math. Monthly, vol. 78, 1971, pp. 272-273, and the one by
R. Bellman in Amer. Math. Monthly, vol. 50, 1943, pp. 318-319.)
11. Suppose fe & on [0, A] for all A < «, and f(x) > 1 as x > +00. Prove that

limt| e—“f(x)dx=1 (t > 0).

t0 °

12. Suppose 0 <8 <7, f(x) = 1 if |x| <8, f(x) =0 if 8 < |x| <7, and f(x + 27) =
S() for all x.
(a) Compute the Fourier coefficients of f.
(6) Conclude that

(d) Let 8 >0 and prove that

(e) Put 6 = 7/2 in (c). What do you get?
13. Put f(x) = x if 0<x < 2m, and apply Parseval’s theorem to conclude that
1

7
sn? 6°

Ms


--- Page 208 ---

SOME SPECIAL FUNCTIONS 199

14. If f(x) = (@ — |x|)? on [—7, 7], prove that

15.

16.

{x)= v4 + ¥ A cosnx
and deduce that

a ye

naan? 6’ nel n* 90°

(A recent article by E. L. Stark contains many references to series of the form
¥ n7*, where s is a positive integer. See Math. Mag., vol. 47, 1974, pp. 197-202.)

With D, as defined in (77), put
KWo) = Faq —} x, D,(x).
Prove that
1 1-cos(N+1)x
Kw) = 7 — cos x
and that
(a) Kn 20,

() ~ [" Knlx) de = 1,

(c) Kx(x) <—— if 0<8< |x| <7.

2
N - 1 1—cosd
If sy =Sy(/; x) is the Mth partial sum of the Fourier series of f, consider

the arithmetic means

Sot sit t'+$n
N+1

Oon=
Prove that
ots = sf fo— Kult) de

and hence prove Fejér’s theorem:
Iff is continuous, with period 27, then on(f 3 x) > f(x) uniformly on [—7, 7).
Hint: Use properties (a), (5), (c) to proceed as in Theorem 7.26.

Prove a pointwise version of Fejér’s theorem:
IffeR and f(x +), f(x —) exist for some x, then

jim om fs x) = af +) + fO—))


--- Page 209 ---

200

17,

18.

19,

20.

PRINCIPLES OF MATHEMATICAL ANALYSIS

Assume f is bounded and monotonic on [—7, 7), with Fourier coefficients c,, as
given by (62).
(a) Use Exercise 17 of Chap. 6 to prove that {vc,} is a bounded sequence.
(6) Combine (a) with Exercise 16 and with Exercise 14(e) of Chap. 3, to conclude
that
lim sx(f3 x) = a+) +S)

for every x.
(c) Assume only that fe # on [—7, 7] and that f is monotonic in some segment
(a, B)< [—7, 7]. Prove that the conclusion of (6) holds for every x € («, B).

(This is an application of the localization theorem.)
Define

J (x) = x3 — sin? x tan x
g(x) = 2x? — sin? x — x tan x.

Find out, for each of these two functions, whether it is positive or negative for all
x € (0, 7/2), or whether it changes sign. Prove your answer.

Suppose f is a continuous function on R’, f(x + 27) = f(x), and «/7 is irrational.
Prove that

for every x. Hint: Do it first for f(x) = e'**.
The following simple computation yields a good approximation to Stirling’s
formula.

For m= 1, 2, 3,..., define

S(x) = (m+ 1— x) log m+ (x — m) log (m+ 1)
if m<x<m-+1, and define

x
Gx) =— —1+ logm

if m—4<x <m+. Draw the graphs of fand g. Note that f(x) <log x <g(x)
if x >1 and that

[7 £0) de = log (nt) — 4 log n > 4+ [ 9) dx,

Integrate log x over [1, ”]. Conclude that
$ <log(a)—(n+ D)lognt+n<l
for n= 2,3, 4,.... (Note: log V27 ~ 0.918... .) Thus

ets

n!} <
<Gleyrvn


--- Page 210 ---

SOME SPECIAL FUNCTIONS 201

21. Let

22.

] bd
Leas [ [D(t)| dt (=1,2,3,....

Prove that there exists a constant C > 0 such that
L,>C logn (n= 1, 2, 3,...),

or, more precisely, that the sequence

{ —- 4 log |
wT
is bounded.

If « is real and —1 <x <1, prove Newton’s binomial theorem

(+x=1 +5 end ent.

Hint: Denote the right side by f(x). Prove that the series converges. Prove that

(1+ xf’) =af)

and solve this differential equation.
Show also that

2 Tinta) ,

(l—x)""= 2 IT)

if -1<x<landa>0.

. Let y be a continuously differentiable closed curve in the complex plane, with

parameter interval! [a, 6], and assume that y(t) 40 for every ¢ € [a, 5]. Define the
index of y to be

_1 pPprv®
Ind (y) = 5 mo

Prove that Ind (y) is always an integer.

Hint: There exists » on [a, 6] with y’ = y’/y, p(a) = 0. Hence y exp(—¢)
is constant. Since (a) = »(b) it follows that exp p(b) = exp y(a) = 1. Note that
(b) = 277i Ind (y).

Compute Ind (y) when y(t) = e'"', a = 0, b = 27.

Explain why Ind (y) is often called the winding number of y around 0.

Let y be as in Exercise 23, and assume in addition that the range of y does not
intersect the negative real axis. Prove that Ind (y)=0. Hint: For O<c< 0,

Ind (y+ ¢) is a continuous integer-valued function of c. Also, Ind (y+ c) +0
as ¢> 0,


--- Page 211 ---

202 PRINCIPLES OF MATHEMATICAL ANALYSIS

25.

26.

27.

Suppose y; and y.2 are curves as in Exercise 23, and
lyst) — yalt)|<|yi)| @<t<d).
Prove that Ind (y:) = Ind (yz).

Hint: Put y = y2/y1. Then |1— | <1, hence Ind (y) = 0, by Exercise 24.

Also,

y oy. Vw
Let y be a closed curve in the complex plane (not necessarily differentiable) with
parameter interval [0, 27], such that y(t) + 0 for every z € [0, 27].

Choose § > 0 so that |y(t)| >8 for all ¢ € [0, 27]. If P, and P, are trigo-
nometric polynomials such that |P,(t)— y(t)| <8/4 for all t € 0, 27] (their exis-
tence is assured by Theorem 8.15), prove that

Ind (P:) = Ind (P2)
by applying Exercise 25.

Define this common value to be Ind (y).

Prove that the statements of Exercises 24 and 25 hold without any differenti-
ability assumption.
Let f be a continuous complex function defined in the complex plane. Suppose
there is a positive integer n and a complex number c 4 0 such that

im 2-"7@) =¢c,

Prove that f(z) = 0 for at least one complex number z.

Note that this is a generalization of Theorem 8.8.

Hint: Assume f(z) #0 for all z, define

y(t) = f(re")

for O<r<0,0<¢<2z7, and prove the following statements about the curves
Yet
(a) Ind (yo) = 0.
(6) Ind (y,) =n for all sufficiently large r.
(c) Ind (y,) is a continuous function of r, on [0, 2).
{In (b) and (c), use the last part of Exercise 26.]

Show that (a), (6), and (c) are contradictory, since n > 0.

. Let D be the closed unit disc in the complex plane. (Thus z € D if and only if

|z| <1.) Let g be a continuous mapping of D into the unit circle 7. (Thus,
|g(z)| = 1 for every z ¢ D.)

Prove that g(z) = —z for at least one z € T.

Hint: ForO<r<1,0<t<2z, put

y(t) = g(re"),

and put h(t) = e-"y,(rt). If g(z) # —z for every z€ 7, then Y(t) # —1 for every
t €[0, 27]. Hence Ind (x) = 0, by Exercises 24 and 26, It follows that Ind (y:) =1.
But Ind (yo) = 0. Derive a contradiction, as in Exercise 27.


--- Page 212 ---

SOME SPECIAL FUNCTIONS 203

29. Prove that every continuous mapping f of D into D has a fixed point in D.
(This is the 2-dimensional case of Brouwer’s fixed-point theorem.)
Hint: Assume f(z) # z for every z€ D, Associate to each z ¢ D the point
g(z) € T which lies on the ray that starts at f(z) and passes through z. Then g
maps D into T, g(z) = z if z € T, and g is continuous, because
g(z) =z — s(z)[f(z) — 2],
where s(z) is the unique nonnegative root of a certain quadratic equation whose
coefficients are continuous functions of fand z. Apply Exercise 28,
30. Use Stirling’s formula to prove that

m T(x+e)
xwo X°I(x) ~

1

for every real constant c.
31. In the proof of Theorem 7.26 it was shown that

1 2 4
[ a= deo

for n= 1, 2, 3, ... . Use Theorem 8.20 and Exercise 30 to show the more precise
result

— 1 —
lim Vn J Q—x2)"dx = V7.

n= 0


--- Page 213 ---

9

FUNCTIONS OF SEVERAL VARIABLES

LINEAR TRANSFORMATIONS

We begin this chapter with a discussion of sets of vectors in euclidean n-space R”.
The algebraic facts presented here extend without change to finite-dimensional
vector spaces over any field of scalars. However, for our purposes it is quite
sufficient to stay within the familiar framework provided by the euclidean spaces.

9.1 Definitions

(a) A nonempty set X c R" is a vector space ifx +ye X and cxe X
for all x e X, ye X, and for all scalars c.

(b) If x,,..., X,¢ R" and cy,..., c, are scalars, the vector
CyXy Se CyXp

is called a linear combination of x,,..., X,. If Sc R" and if EZ is the set
of all linear combinations of elements of S, we say that S spans E, or that
E is the span of S.

Observe that every span is a vector space.


--- Page 214 ---

FUNCTIONS OF SEVERAL VARIABLES 205

(c) A set consisting of vectors x,,..., x, (we Shall use the notation
{x,,...,X,} for such a set) is said to be independent if the relation
CX, +°'' + ¢,X, = Oimplies that c, =++- =c, =0. Otherwise {x,,..., x,}
is said to be dependent.

Observe that no independent set contains the null vector.

(d) Ifa vector space X contains an independent set of r vectors but con-
tains no independent set of r + 1 vectors, we say that X has dimension r,
and write: dim X¥ =r.

The set consisting of 0 alone is a vector space; its dimension is 0.
(e) An independent subset of a vector space X which spans X is called
a basis of X.

Observe that if B = {x,,...,x,} is a basis of X, then every xe X
has a unique representation of the form x = Zc,;x,. Such a representation
exists since B spans X, and it is unique since B is independent. The
numbers c,, ..., ¢, are called the coordinates of x with respect to the
basis B.

The most familiar example of a basis is the set {e,, ..., e,}, where
e, is the vector in R" whose jth coordinate is 1 and whose other coordinates
are all0. Ifxe R",x =(%1,..., X,), then x = Zx,e;. We shall call

{e,,..., e,}
the standard basis of R’.

9.2 Theorem Let r be a positive integer. If a vector space X is spanned by a
set of r vectors, then dim X <r.

Proof If this is false, there is a vector space X which contains an inde-
pendent set Q = {y,,..., y.41} and which is spanned by a set Sy consisting
of r vectors.

Suppose 0 < i <r, and suppose a set S; has been constructed which
spans X and which consists of all y,; with 1 <j <i plus a certain collection
of r — i members of Sp, say X,,..., X,-;- (In other words, 5S; is obtained
from Sp by replacing i of its elements by members of Q, without altering
the span.) Since S; spans X, y;., is in the span of S;; hence there are

scalars a,,..., @;44, b;,..-, 6,-;, With a;,, = 1, such that
i+1 r-i
Yiay,+ b,x, = 0.
jFi k=1

If all b,’s were 0, the independence of Q would force all a;’s to be 0, a
contradiction. It follows that some x, € S; is a linear combination of the
other members of 7; = S; v {y;,,}. Remove this x, from 7; and call the
remaining set S;,;. Then S;,, spans the same set as 7;, namely X, so
that S;,, has the properties postulated for S; with i+ 1 in place of i.


--- Page 215 ---

206 PRINCIPLES OF MATHEMATICAL ANALYSIS

Starting with S,, we thus construct sets S;,...,5,. The last of
these consists of y,,...,y,, and our construction shows that it spans X.
But Q is independent; hence y,,, is not in the span of S,. This contra-
diction establishes the theorem.

Corollary dim R" =n.

Proof Since {e,, ..., e,} spans R", the theorem shows that dim R" <n.
Since {e,, ..., €,} is independent, dim R” > n.

9.3. Theorem Suppose X is a vector space, and dim X =n.

(a) A-set E of n vectors in X spans X if and only if E is independent.

(b) X has a basis, and every basis consists of n vectors.

(c) Ifl1<r<nand {y,,...,y,} is an independent set in X, then X has a
basis containing {y,, ..., Yy}-

Proof Suppose E = {x;,...,x,}. Since dim X =n, the set {x,,..., X,, y}
is dependent, for every ye X. If £ is independent, it follows that y is in
the span of E; hence E spans X. Conversely, if E is dependent, one of its
members can be removed without changing the span of Z. Hence £
cannot span X, by Theorem 9.2. This proves (a).

Since dim X¥ =n, X contains an independent set of n vectors, and
(a) shows that every such set is a basis of X; (b) now follows from 9.1(@)
and 9.2.

To prove (c), let {x,,..., x,} be a basis of X. The set

S = {Y 1,006 Veo Xap ee es Mah

spans X and is dependent, since it contains more than n vectors. The
argument used in the proof of Theorem 9.2 shows that one of the x,’s is
a linear combination of the other members of S. If we remove this x; from
S, the remaining set still spans X. This process can be repeated r times
and leads to a basis of X which contains {y,,..., y,}, by (a).

9.4 Definitions A mapping A of a vector space X into a vector space Y is said
to be a linear transformation if

A(X; + X2) = AX, + AX, A(cx) = cAx

for all x, x,, x, € X and all scalars c. Note that one often writes Ax instead
of A(x) if A is linear.

Observe that A0 = 0 if A is linear. Observe also that a linear transforma-
tion A of X into Y is completely determined by its action on any basis: If


--- Page 216 ---

FUNCTIONS OF SEVERAL VARIABLES 207

{X,,..., X,} is a basis of X, then every x e X has a unique representation of the
form
nt
x= > Ci Xi,
i=1
and the linearity of A allows us to compute Ax from the vectors Ax,,..., AX,
and the coordinates c,, ..., c, by the formula
n
Ax =) ¢; AX;.
i=1

Linear transformations of X into X are often called linear operators on X.
If A is a linear operator on X which (i) is one-to-one and (ii) maps XY onto
X, we say that A is invertible. In this case we can define an operator A~! on ¥
by requiring that A~*(Ax) =x for all x € X. It is trivial to verify that we then
also have A(A~!x) =x, for all x € X, and that A~? is linear.

An important fact about linear operators on finite-dimensional vector
spaces is that each of the above conditions (i) and (ii) implies the other:

9.5 Theorem A linear operator A on a finite-dimensional vector space X is
one-to-one if and only if the range of A is all of X.

Proof Let {x,,...,x,} be a basis of X. The linearity of A shows that
its range &(A) is the span of the set @ = {Ax,,..., Ax,}. We therefore
infer from Theorem 9.3(a) that @(A) = X if and only if Q is independent.
We have to prove that this happens if and only if A is one-to-one.
Suppose A is one-to-one and ic; Ax; = 0. Then A(Xc;x,) = 0, hence

Xe,x; = 0, hence cy = +++ =c, = 0, and we conclude that Q is independent.
Conversely, suppose Q is independent and A(Xc;x,)=0. Then
Xe; Ax; =0, hence cy =--- =c, =0, and we conclude: Ax = 0 only if

x =0. If now Ax = Ay, then A(x — y) = Ax — Ay =0, so that x — y = 0,
and this says that A is one-to-one.

9.6 Definitions
(a) Let L(X, Y) be the set of all linear transformations of the vector space
X into the vector space Y. Instead of L(X, X), we shall simply write L(X).
If A,, A, €L(X, Y) and if c,, c. are scalars, define c, A, + ¢, A, by
(Cc, A, + Cy Ay)X = C1 A,X + C2 AX (xéE X).
It is then clear that c,A, + c, A, €L(X, Y).
(b) If X, Y, Z are vector spaces, and if Ae L(X, Y) and Be L(Y, Z), we
define their product BA to be the composition of A and B:
(BA)x = B(Ax) (xe X).
Then BA € L(X, Z).


--- Page 217 ---

208 PRINCIPLES OF MATHEMATICAL ANALYSIS

Note that BA need not be the same as AB, even if ¥ = Y =Z.
(c) For AéL(R", R"), define the norm ||A|| of A to be the sup of all
numbers | Ax|, where x ranges over all vectors in R" with |x| <1.
Observe that the inequality

| Ax| < |All |x|
holds for all xe R". Also, if A is such that | Ax] < A|x| for all xe R’,
then ||Alj <A.
9.7 Theorem

(a) If AE L(R", R”), then ||A|| < 00 and A is a uniformly continuous
mapping of R" into R".
(b) If A, Be L(R", R") and c is a scalar, then
A+B] <All + (Bl, [led] = le] |All.

With the distance between A and B defined as \|A — B\|, L(R", R™) is a
metric space.
(c) If Ae L(R", R™) and Be L(R", R*), then

BA] < | Bl |All.
Proof
(a) Let {e;,...,e,} be the standard basis in R" and suppose x = £c,e,,
|x| <1, so that |c;|] <1 fori=1,...,. Then
| Ax| =|5 ¢, Ae, | <) le;| |Ael <> | Aeil
so that

{|All <) | 4ei|< 0.

Since | Ax — Ay| < ||Al| |x — y| if x, y eR", we see that A is uniformly
continuous.
(b) The inequality in (6) follows from

|(4 + B)x| = |Ax + Bx| < |Ax| + |Bx| < (All + BI) [x1.
The second part of (6) is proved in the same manner. If
A, B, Ce L(R", R"),
we have the triangle inequality

|A — Cll = (A -B)+B-C)| <A - Bl + B-Ch,


--- Page 218 ---

FUNCTIONS OF SEVERAL VARIABLES 209

and it is easily verified that || A — B| has the other properties of a metric
(Definition 2.15).
(c) Finally, (c) follows from
|(BA)x| = | B(Ax)| < ||Bi| | Ax] < [BI All [x].
Since we now have metrics in the spaces L(R", R”), the concepts of open

set, continuity, etc., make sense for these spaces. Our next theorem utilizes
these concepts.

9.8 Theorem Let Q be the set of all invertible linear operators on R".

(1)

(2)

(a) IfAEQ, Be L(R’), and
|B-Al|| AT} <1,

then Be Q.
(b) Q is an open subset of L(R"), and the mapping A — A™~' is continuous
on Q.
(This mapping is also obviously a 1—1 mapping of Q onto Q,
which is its own inverse.)

Proof
(a) Put ||A~*|| =1/a, put ||B— Al] =f. Then B <a. For every xe R’,

a|x| =a|A~*Ax| < a[|A7? | - | Ax}
= | Ax] < |(4 — B)x| + | Bx| < B|x| + | Bxl,
so that
(a — B)|x|<|Bx| we R”).

Since « — 8 > 0, (1) shows that Bx 40 if x #0. Hence Bis 1 —1.
By Theorem 9.5, BEQ. This holds for all B with ||B-- All| <a. Thus
we have (a) and the fact that Q is open.
(b) Next, replace x by B~*y in (1). The resulting inequality

(a—f)|B-*y|< |BB"y|=ly| (ye R’)
shows that ||B~*|| < (a — B)~*. The identity
BoA = BA — BAM,

combined with Theorem 9.7(c), implies therefore that

- - - - B
Bui_— 4! Bui ||A-—B 1 <——-—..
|< Bul | | |]. I< @-BD

This establishes the continuity assertion made in (b), since 8 >0 as B—> A.


--- Page 219 ---

210 PRINCIPLES OF MATHEMATICAL ANALYSIS

9.9 Matrices Suppose {x,,..., x,} and {y,,..., y,,} are bases of vector spaces
X and Y, respectively. Then every Ae L(X, Y) determines a set of numbers

a;, such that

It is convenient to visualize these numbers in a rectangular array of m rows
and n columns, called an m by n matrix:

Gi1 M2 *** Aty

a a wes
id Daeeeennnnneee ”

Qn Qn2 ee Ginn

Observe that the coordinates a,, of the vector Ax, (with respect to the basis
{¥i,--+, Ym}) appear in the jth column of [A]. The vectors Ax; are therefore
sometimes called the column vectors of [A]. With this terminology, the range
of A is spanned by the column vectors of [A].

If x = Xc,x,, the linearity of A, combined with (3), shows that

m nt
(4) Ax=) ( a,c) Yi-
i=1 \jai
Thus the coordinates of Ax are L,a,;c;. Note that in (3) the summation
ranges over the first subscript of a,,, but that we sum over the second subscript
when computing coordinates.

Suppose next that an m by n matrix is given, with real entries a;,. If A is
then defined by (4), it is clear that A <¢ L(X, Y) and that [A] is the given matrix.
Thus there is a natural 1-1 correspondence between L(X, Y) and the set of all
real m by n matrices. We emphasize, though, that [4] depends not only on A
but also on the choice of bases in X and Y. The same A may give rise to many
different matrices if we change bases, and vice versa. We shall not pursue this
observation any further, since we shall usually work with fixed bases. (Some
remarks on this may be found in Sec. 9.37.)

If Z is a third vector space, with basis {z,,..., Z,}, if A is given by (3),
and if

By: =) brite (BA)x) = 3 Cj %»
then A eL(X, Y), Be L(Y, Z), BA € L(X, Z), and since
B(Ax;) = B » 4ij¥i = » a;, BY;

= > ai; >, Das Ze => (2 bx 5) ZK»
k R Ni


--- Page 220 ---

FUNCTIONS OF SEVERAL VARIABLES 211

the independence of {z,,..., z,} implies that

(5) Cey = Ybuay (lsksp,l<j<n).

This shows how to compute the p by » matrix [BA] from [B] and [A]. If we
define the product [B][A] to be [BA], then (5) describes the usual rule of matrix
multiplication.

Finally, suppose {x,,..., x,} and {y,, ..., y,,} are standard bases of R” and
R”, and A is given by (4). The Schwarz inequality shows that

| Ax|? => (2 ais64)" <> (> ais) ci) =) aj;|x|?.
t\y iN dj iJ
Thus
(6) || Al <P ail *".

If we apply (6) to B— A in place of A, where A, Be L(R", R”), we see
that if the matrix elements a,, are continuous functions of a parameter, then the
same is true of A. More precisely:

If S is a metric space, if ay1, ..., An, are real continuous functions on S,
and if, for each p€ S, A, is the linear transformation of R" into R" whose matrix
has entries a;(p), then the mapping p— A, is a continuous mapping of S into
LCR", R™).

DIFFERENTIATION

9.10 Preliminaries In order to arrive at a definition of the derivative of a
function whose domain is R” (or an open subset of R"), let us take another look
at the familiar case n = 1, and let us see how to interpret the derivative in that
case in a way which will naturally extend to n > 1.

If f is a real function with domain (a, b) < R' and if x € (a, b), then f’(x)
is usually defined to be the real number

lim fern,

h-O0

(7)

provided, of course, that this limit exists. Thus

(8) fx +h) — f(x) =f'()h + rh)
where the “‘remainder”’ r(A) is small, in the sense that
hoo h


--- Page 221 ---

212 PRINCIPLES OF MATHEMATICAL ANALYSIS

Note that (8) expresses the difference f(x + A) — f(x) as the sum of the
linear function that takes h to f’(x)A, plus a small remainder.

We can therefore regard the derivative of f at x, not as a real number,
but as the linear operator on R! that takes h to f’(x)A.

[Observe that every real number « gives rise to a linear operator on R!;
the operator in question is simply multiplication by «. Conversely, every linear
function that carries R' to R! is multiplication by some real number. It is this
natural 1-1 correspondence between R’ and Z(R') which motivates the pre-
ceding statements. ]

Let us next consider a function f that maps (a, b) < R' into R". In that
case, f’(x) was defined to be that vector y ¢ R” (if there is one) for which
(10) lim fae - y} =0.

h-0
We can again rewrite this in the form
(11) f(x +h) — f(x) = hy + r(h),

where r(h)/h-> 0 as h-+0. The main term on the right side of (11) is again a
linear function of A. Every y € R” induces a linear transformation of R! into
R", by associating to each he R' the vector Ay € R". This identification of R”
with L(R’, R”) allows us to regard f’(x) as a member of L(R’, R”).

Thus, iff is a differentiable mapping of (a, b) c R! into R", and if x € (a, b),
then f’(x) is the linear transformation of R! into R™ that satisfies

lim f(x + h) — f(x) TEA

12 0,
(12) lim p
or, equivalently,
~ _—f'
(13) tim HO +4 —f@)—f'@Al _ 9

h-+0 |A|

We are now ready for the case n > 1.

9.11 Definition Suppose £ is an open set in R", f maps E into R", and xe E.
If there exists a linear transformation A of R" into R™ such that

f h) — f(x) —
tim Lf +b) ~ £(&) ~ Ab] _
h=0 |h|

then we say that f is differentiable at x, and we write
(15) f'(x) =A.
If f is differentiable at every x e E, we say that f is differentiable in E.

(14) 0,


--- Page 222 ---

FUNCTIONS OF SEVERAL VARIABLES 213

It is of course understood in (14) that he R”. If |h| is small enough, then
x+heE, since E is open. Thus f(x +h) is defined, f(x + h) € R”, and since
Ae L(R", R"), Ahe R”. Thus

f(x +h) — f(x) — Ahe R”.
The norm in the numerator of (14) is that of R”. In the denominator we have
the R"-norm of h.

There is an obvious uniqueness problem which has to be settled before

we go any further.

9,12 Theorem Suppose E and f are as in Definition 9.11, x € E, and (14) holds
Proof If B = A, — A;, the inequality
| Bh] < [f(x +h) — £(x) — A,h| + [f(x +h) ~ f(x) — 42h
shows that | Bh|/|h| +0 ash—0. For fixed h # 9, it follows that
| B(th)
>
| th
The linearity of B shows that the left side of (16) is independent of ¢.
Thus Bh = 0 for every he R”. Hence B =0.

as t70.

(16)

9.13 Remarks
(a) The relation (14) can be rewritten in the form
(17) f(x + h) — f(x) =f’@h+rh)

where the remainder r(h) satisfies

; __ {r(h)|
(18) lim rT 0.

We may interpret (17), as in Sec. 9.10, by saying that for fixed x and small
h, the left side of (17) is approximately equal to f’(x)h, that is, to the value
of a linear transformation applied to h.
(6) Suppose f and £ are as in Definition 9.11, and f is differentiable in E.
For every x € E, f’(x) is then a function, namely, a linear transformation
of R" into R”. But f' is also a function: f’ maps E into L(R", R”).
(c) A glance at (17) shows that f is continuous at any point at which f is
differentiable.
(d) The derivative defined by (14) or (17) is often called the differential
of f at x, or the total derivative of f at x, to distinguish it from the partial
derivatives that will occur later.


--- Page 223 ---

214 PRINCIPLES OF MATHEMATICAL ANALYSIS

9.14 Example We have defined derivatives of functions carrying R” to R” to
be linear transformations of R" into R”. What is the derivative of such a linear
transformation? The answer is very simple.

If A é L(R", R") and if x € R", then
(19) A(x) =A.

Note that x appears on the left side of (19), but not on the right. Both

sides of (19) are members of L(R", R”), whereas Ax € R™.
The proof of (19) is a triviality, since

(20) A(x + h) — Ax = Ah,
by the linearity of A. With f(x) = Ax, the numerator in (14) is thus 0 for every
he R". In (17), r(h) = 0.

We now extend the chain rule (Theorem 5.5) to the present situation.

9.15 Theorem Suppose E is an open set in R",{ maps E into R",f is differentiable
at Xy € E, g maps an open set containing {(E) into R*, and g is differentiable at
f(X9). Then the mapping F of E into R* defined by

F(x) = g(f (x)
is differentiable at Xx), and
(21) F'(Xo) = B(f(Ko))f (Xo).

On the right side of (21), we have the product of two linear transforma-
tions, as defined in Sec. 9.6.

Proof Put yo ={(Xo), A =f (Xo), B = 2'(¥o), and define
v(K) = g(Yo + k) — g(¥o) — Bk,
for all he R" and ke R” for which f(x) + h) and g(yo +k) are defined.
Then
(22) ju(h)| =e(h){h], | v(k)| = 4(k)|k],
where e(h) > 0 as h-> 0 and n(k) > 0 ask- 0.
Given h, put k = f(xy + h) — f(Xo). Then
(23) |k| = | 4h + u(h)|< [|]4l| + e(h)] [hl,
and
F(xo + h) — F(X) — BAh = g(yo + k) — B(Yo) — BAh
= Bik — Ah) + v(k)
= Bu(h) + v(k).


--- Page 224 ---

FUNCTIONS OF SEVERAL VARIABLES 215

Hence (22) and (23) imply, for h 4 0, that
|F(Xy + h) — F(X,) — BAh|
|h|

Let h->0. Then e(h)-0. Also, k- 0, by (23), so that n(k) 0.
It follows that F’(x.) = BA, which is what (21) asserts.

S ||Bl eh) + [Al] + eh) In).

9.16 Partial derivatives We again consider a function f that maps an open
set Ec R" into R”. Let {e,,..., e,} and {u,,..., u,,} be the standard bases of
R" and R™. The components of f are the real functions f;, ..., f,, defined by

(24) fo) =¥ fied (xe B),

or, equivalently, by f(x) =f(x):u,,1<sism.
Forxe £,1sism,1<j <n, we define

. x + te) —f(x
(25) (Dg FN) = tim HEF DLO,
provided the limit exists. Writing /(x1,...,x,) in place of f(x), we see that
D,f, is the derivative of f, with respect to x,, keeping the other variables fixed.
The notation

CA

(26) i,

is therefore often used in place of D,f,, and D,f;, is called a partial derivative.

In many cases where the existence of a derivative is sufficient when dealing
with functions of one variable, continuity or at least boundedness of the partial
derivatives is needed for functions of several variables. For example, the
functions f and g described in Exercise 7, Chap. 4, are not continuous, although
their partial derivatives exist at every point of R?. Even for continuous functions.
the existence of all partial derivatives does not imply differentiability in the sense
of Definition 9.11; see Exercises 6 and 14, and Theorem 9.21.

However, if f is known to be differentiable at a point x, then its partial
derivatives exist at x, and they determine the linear transformation f’(x)
completely:

9.17 Theorem Suppose { maps an open set E < R" into R", and f is differentiable
at a point x 6 E. Then the partial derivatives (D,f,)(x) exist, and

m

(27) {'(x)e, = 2, D,f@Ou (1 <j<7n).


--- Page 225 ---

216 PRINCIPLES OF MATHEMATICAL ANALYSIS

Here, as in Sec. 9.16, {e,,...,e,} and {u,,...,u,,} are the standard bases
of R" and R”.

Proof Fix j. Since f is differentiable at x,
f(x + te,) — f(x) =f'(x)(te)) + r(e,)
where |r(te,)|/t->0 as +0. The linearity of f’(x) shows therefore that
(28) lim f(x + 0 — f(x)

t70

=f'(x)e,.

If we now represent f in terms of its components, as in (24), then (28)
becomes

im $A #0) ~f)

t70 i=1

(29) u; =f'(x)e;.
It follows that each quotient in this sum has a limit, as t + 0 (see Theorem
4.10), so that each (D,f,)(x) exists, and then (27) follows from (29).

Here are some consequences of Theorem 9.17:
Let [f’(x)] be the matrix that represents f’(x) with respect to our standard
bases, as in Sec. 9.9.

Then f’(x)e; is the jth column vector of [f’(x)], and (27) shows therefore
that the number (D,/;)(x) occupies the spot in the ith row and jth column of
[f’(x)]. Thus

69) oe .
(Dif) °° (Dafa)
If h = £/,e; is any vector in R", then (27) implies that
G0) Foon =F F D,fa0h,|w,
i=1lj=1

9.18 Example Let y be a differentiable mapping of the segment (a, b) < R'
into an open set Ec R", in other words, y is a differentiable curve in Z. Let f
be a real-valued differentiable function with domain E. Thus fis a differentiable
mapping of E into R'. Define

(31) Ht) =f) (@<t<b).
The chain rule asserts then that

(32) IH) =fOO"O @<t<d).


--- Page 226 ---

FUNCTIONS OF SEVERAL VARIABLES 217

Since y'(t)¢ L(R), R") and f'(y(t)) ¢ L(R", R'), (32) defines g/(t) as a linear
operator on R’. This agrees with the fact that g maps (a, b) into R'. However,
g(t) can also be regarded as a real number. (This was discussed in Sec. 9.10.)
This number can be computed in terms of the partial derivatives of f and the
derivatives of the components of y, as we shall now see.

With respect to the standard basis {e,,..., e,} of R”, [y’(¢)] is the n by 1
matrix (a “column matrix’) which has y; (¢) in the ith row, where y,,..., y, are
the components of y. For every x € E, [f’(x)] is the 1 by matrix (a “row matrix”)
which has (D,f)(x) in the jth column. Hence [g'(t)] is the 1 by 1 matrix whose
only entry is the real number

G3) It) = DAO (0.

This is a frequently encountered special case of the chain rule. It can be
rephrased in the following manner.

Associate with each xe E a vector, the so-called “gradient” of f at x,
defined by

4) (WA) = ¥ DsNOe:.
Since

(35) ¥O=Lri@e,

(33) can be written in the form

(36) I(t) = (WA),

the scalar product of the vectors (Vf)(p(t)) and »’(2).
Let us now fix an x é £, let ue R" be a unit vector (that is, |u{ = 1), and
specialize y so that

(37) yt)=xtu (-we<t<o).
Then y(t) =u for every ¢. Hence (36) shows that
(38) g'(0) = (VA)(x) - u.
On the other hand, (37) shows that
Ht) — gO) = f(x + tu) — f(x).
Hence (38) gives
km LY) SO

t30 t

(39) = (Wf) (x): u.


--- Page 227 ---

218 PRINCIPLES OF MATHEMATICAL ANALYSIS

The limit in (39) is usually called the directional derivative of f at x, in the
direction of the unit vector u, and may be denoted by (D,/f)(x).

If f and x are fixed, but u varies, then (39) shows that (D,/)(x) attains its
maximum when w is a positive scalar multiple of (Vf)(x). [The case (V/)(x) = 0
should be excluded here. ]

If u = Zu,e,, then (39) shows that (D,f)(x) can be expressed in terms of
the partial derivatives of fat x by the formula

(40) (DAI) = ¥ Diu.
Some of these ideas will play a role in the following theorem.
9.19 Theorem Suppose f maps a convex open set E < R" into R", f is differen-
tiable in E, and there is a real number M such that
|f"(x)| <M
for every xe E. Then
| f(b) — f(a)| < M|b —a|
forallacE, bee.
Proof Fixae £,be £. Define
y(t) = (1 — a + th
for all te R’ such that »(t)e E. Since E is convex, y(t)e E if 0 << 1.

Put
a(t) =f0().
Then
g(t) = f'OO)’ =f OO) — a),
so that

le(t)| < If’G@)I||b — a] < M|b — al
for all te [0, 1]. By Theorem 5.19,
|g(1) — g(0)| < M|b — al.
But g(0) = f(a) and g(1) =f(b). This completes the proof.

Corollary Jf, in addition, f'(x) =0 for all x € E, then f is constant.

Proof To prove this, note that the hypotheses of the theorem hold now
with M =0.


--- Page 228 ---

FUNCTIONS OF SEVERAL VARIABLES 219

9.20 Definition A differentiable mapping f of an open set Ec R" into R” is
said to be continuously differentiable in E if f’ is a continuous mapping of E
into L(R", R”).

More explicitly, it is required that to every xe £ and to every e>0
corresponds a 6 > 0 such that

f(y) -f'@Il<e

if ye Eand |x —y|<6.
If this is so, we also say that f is a @’-mapping, or that fe @’(£).

9.21 Theorem Suppose f maps an open set Ec R" into R". Thenfe@(E) if
and only if the partial derivatives Df, exist and are continuous on E fori sism,
lsj<n.

Proof Assume first that fe @’(£). By (27),
(Df) = E'@e,) * uy,
for all i, j, and for allxe £. Hence

(DAY) — DAH = {FY — f'@]e} wy

and since |u,| = |e,| = 1, it follows that
(DANY) — (DjA®| s [ff — f’@) les!
< |If(y) — f’@)I.

Hence D,f; is continuous.

For the converse, it suffices to consider the case m=1. (Why?)
Fix xe E and e>0. Since E is open, there is an open ball Sc E, with
center at x and radius r, and the continuity of the functions D,f shows
that r can be chosen so that

(41 (DN) - DNO|l<= eS, 1s isn).

Suppose h = Lh,e,, |h| <r, put vy = 90, andy, =hye, + + hye,
forl1<k<n. Then

(42) fe-+h) —f) =F +0) fet yd)

Since |v,| <r for 1 <k <nand since S is convex, the segments with end
points x +v,_,; and x +, lie in S. Since v, =v,_,; +A,e,, the mean
value theorem (5.10) shows that the jth summand in (42) is equal to

hy Df \(x + vj-1 + Oy hye)


--- Page 229 ---

220 PRINCIPLES OF MATHEMATICAL ANALYSIS

for some 0, € (0, 1), and this differs from h,(D,f)(x) by less than |h,|e/n,
using (41). By (42), it follows that

n ] n
fx +h) -f(%) — YA(DN@) s- Y lAjles|ble
j=1 n j=

for all h such that |h| <r.

This says that f is differentiable at x and that /’(x) is the linear
function which assigns the number Lh,(D,/)(x) to the vector h = Lh;e,.
The matrix [f’(x)] consists of the row (D, f)(x), ..., (D,f)(x); and since
D,f, ..., D,f are continuous functions on £, the concluding remarks of
Sec. 9.9 show that fe @’(E).

THE CONTRACTION PRINCIPLE

We now interrupt our discussion of differentiation to insert a fixed point
theorem that is valid in arbitrary complete metric spaces. It will be used in the
proof of the inverse function theorem.

9.22 Definition Let X be a metric space, with metric d. If g maps X into XY
and if there is a number c < 1 such that

(43) A(x), e(y)) Sc d(x, y)
for all x, y¢ X, then @ is said to be a contraction of X into X.

9.23 Theorem Jf X is a complete metric space, and if @ is a contraction of X
into X, then there exists one and only one x € X such that p(x) = x.

In other words, g has a unique fixed point. The uniqueness is a triviality,
for if p(x) =x and (y) = y, then (43) gives d(x, y) < c d(x, y), which can only
happen when d(x, y) = 0.

The existence of a fixed point of @ is the essential part of the theorem.
The proof actually furnishes a constructive method for locating the fixed point.

Proof Pick x, € X arbitrarily, and define {x,} recursively, by setting
(44) Xnt1 =Q%,) (1 =0,1,2,...).
Choose c < 1 so that (43) holds. For n = 1 we then have
AXn+ 1s Xn) = APXy)s P%n-1)) S CA Xn» Xn-1)-
Hence induction gives
(45) CXnt1. X_) SC" (x4, Xo) (n =0, 1, 2,...).


--- Page 230 ---

FUNCTIONS OF SEVERAL VARIABLES 221

If n < m, it follows that

(Xn, Xm) s . y 1 A(x;, Xj-1)

i=nt
(C+ oT + 08) dle, X0)
< [(1 — c)7? d(x, Xo) Je”.

Thus {x,} is a Cauchy sequence. Since X is complete, lim x, =x for some
xeXx,

Since @ is a contraction, @ is continuous (in fact, uniformly con-
tinuous) on X. Hence

(x) = lim o(x,) = lim x41 =x.

THE INVERSE FUNCTION THEOREM

The inverse function theorem states, roughly speaking, that a continuously
differentiable mapping f is invertible in a neighborhood of any point x at which
the linear transformation f’(x) is invertible:

9.24 Theorem Suppose f{ is a @'-mapping of an open set E < R" into R", f'(a)
is invertible for some ae E, andb =f(a). Then

(a) there exist open sets U and V in R" such that ae U, be V, f is one-to-
one on U, and f{(U) =V;
(b) if g is the inverse of f [which exists, by (a)], defined in V by

g(f(x))=x  (xeU),
then ge @'(V).

Writing the equation y = f(x) in component form, we arrive at the follow-
ing interpretation of the conclusion of the theorem: The system of n equations

can be solved for x,,..., x, in terms of y,,..., y,, if we restrict x and y to small
enough neighborhoods of a and b; the solutions are unique and continuously
differentiable.

Proof
(a) Put f(a) = A, and choose / so that
(46) 2A\.A~*]| = 1.


--- Page 231 ---

222 PRINCIPLES OF MATHEMATICAL ANALYSIS

(47)

(48)

(49)

(50)

(51)

Since f’ is continuous at a, there is an open ball Uc E, with center at a,
such that

\f’(x) — All <A (xe U).
We associate to each y e R" a function g, defined by
g(x) =x+A(y—f(x)) (xeE£).

Note that £(x) = y if and only if x is a fixed point of o.

Since y’(x) = 1 — A7'f'(x) = A71(A —f'(x)), (46) and (47) imply
that

Ig’'@I<4 (xe).
Hence
| p(X1) — 9(%2)| < $] x1 — x2 | (X;, X, € U),

by Theorem 9.19. It follows that @ has at most one fixed point in U, so

that f(x) = y for at most one xe U.
Thus fis 1 —1 in U.

Next, put V =f(U), and pick yyeV. Then y, =f(x,) for some
X,) & U. Let B be an open ball with center at x9 and radius r > 0, so small
that its closure B liesin U. We will show that y e V whenever |y — yo| < Ar.
This proves, of course, that V is open.

Fix y, |y — yo| < Ar. With 9 as in (48),

- _ r
| (Xo) — Xo| = |A7*(y — Yo)| < Ao" Ar =>"

If x e B, it therefore follows from (50) that

| P(X) — Xo| < | (x) — P(X)| + | P(Xo) — Xo]
1
<5 |x — xo] +557;

hence g(x) ¢ B. Note that (50) holds if x, e B, x, € B.

Thus 9 is a contraction of B into B. Being a closed subset of R”.
B is complete. Theorem 9.23 implies therefore that @ has a fixed point
xéB. For this x, f(x) =y. Thus yef(B) < (UV) = V.

This proves part (a) of the theorem.
(b) Pick ye V, y+keV. Then there exist xe U, x +he U, so that
y =f(x), y+k =f(x +h). With ¢ as in (48),
g(x +h) — g(x) =h+ A7'[f(x) — f(x + bh] =h— 47*k.
By (50), |h — 47'k| <4|h|. Hence |A~'k| > 4/h], and
|h] < 2.4~?]| [k] =47*|k}.


--- Page 232 ---

FUNCTIONS OF SEVERAL VARIABLES 223

By (46), (47), and Theorem 9.8, f’(x) has an inverse, say 7. Since
a(y + k) — gy) — Tk =h—- Tk = —T[f(x + h) — f(x) — fh),
(51) implies
lg(y + k) — gy) — Tk| < 7 | |£(x +h) — f(x) — f’@h|

[kK] A |h|
As k - 0, (51) shows that h > 0. The right side of the last inequality
thus tends to 0. Hence the same is true of the left. We have thus proved
that g’(y) = T. But 7 was chosen to be the inverse of f'(x) = f’(g(y)). Thus

(52) e(y) ={f'(e(y))}* (ye V).

Finally, note that g is a continuous mapping of V onto U (since g
is differentiable), that f’ is a continuous mapping of U into the set Q of
all invertible elements of L(R”), and that inversion is a continuous mapping
of Q onto Q, by Theorem 9.8. If we combine these facts with (52), we see
that ge @(V).

This completes the proof.

Remark. The full force of the assumption that fe @’(E) was only used
in the last paragraph of the preceding proof. Everything else, down to Eq. (52),
was derived from the existence of f'(x) for x € E, the invertibility of f’(a), and
the continuity of f’ at just the point a. In this connection, we refer to the article
by A. Nijenhuis in Amer. Math. Monthly, vol. 81, 1974, pp. 969-980.

The following is an immediate consequence of part (a) of the inverse
function theorem.

9.25 Theorem [ff is a @’-mapping of an open set E< R" into R" and if £'(x)
is invertible for every x € E, then £{(W) is an open subset of R" for every open set
WE.

In other words, f is an open mapping of E into R".

The hypotheses made in this theorem ensure that each point x e E has a
neighborhood in which f is 1-1. This may be expressed by saying that f is
locally one-to-one in E. But f need not be 1-1 in E under these circumstances.
ror an example, see Exercise 17.

THE IMPLICIT FUNCTION THEOREM

If f is a continuously differentiable real function in the plane, then the equation
J (x, y) =0 can be solved for y in terms of x in a neighborhood of any point


--- Page 233 ---

224 PRINCIPLES OF MATHEMATICAL ANALYSIS

(a, b) at which f(a, b) = 0 and éf/éy # 0. Likewise, one can solve for x in terms
of y near (a, ) if df/ax #0 at (a, b). For a simple example which illustrates
the need for assuming @f/0y # 0, consider f(x, y) =x? + y? — 1.

The preceding very informal statement is the simplest case (the case
m=n=1 of Theorem 9.28) of the so-called “implicit function theorem.” Its
proof makes stronguse of the fact that continuously differentiable transformations
behave locally very much like their derivatives. Accordingly, we first prove
Theorem 9.27, the linear version of Theorem 9.28.

9.26 Notation If x =(x,,...,x,)¢R" and y =()1,...,; ¥n) € R”, let us write
(x, y) for the point (or vector)

(X15 0003 Xo Viv eees Vm E R™

In what follows, the first entry in (x, y) or in a similar symbol will always be a
vector in R", the second will be a vector in R”.

Every 4 e L(R"*™, R") can be split into two linear transformations 4, and
A,, defined by

(53) A,h=A(h,0), -A,k = A(0, k)
for any he R", ke R”. Then A, € L(R"), A, € L(R”, R"), and
(54) A(h, k) = A,h + A,k.

The linear version of the implicit function theorem is now almost obvious.

9.27 Theorem Jf A € L(R"*", R") and if A, is invertible, then there corresponds
to every k € R™ qa unique he R" such that A(h, k) = 0.
This h can be computed from k by the formula

(55) h = —(4,)"'A,k.
Proof By (54), A(h, k) = 0 if and only if
A,h+ 4,k=0,
which is the same as (55) when A, is invertible.
The conclusion of Theorem 9.27 is, in other words, that the equation
A(h, k) = 0 can be solved (uniquely) for h if k is given, and that the solution h

is a linear function of k. Those who have some acquaintance with linear algebra
will recognize this as a very familiar statement about systems of linear equations.

9.28 Theorem Let f be a @'-mapping of an open set Ec R"*™ into R", such
that f(a, b) = 0 for some point (a, b) € E.
Put A =f'(a, b) and assume that A, is invertible.


--- Page 234 ---

FUNCTIONS OF SEVERAL VARIABLES 225

Then there exist open sets Uc R"*™ and Wc R", with (a,b)e U and
be W, having the following property:
To every y € W corresponds a unique x such that

(56) (xyy)eU and f(x,y) =0.
If this x is defined to be g(y), then g is a €'-mapping of W into R", g(b) =a,
(57) f(g(y),y)=0 (ye W),
and
(58) g'(b) = -(A,)"14,.

The function g is “implicitly” defined by (57). Hence the name of the

theorem.
The equation f(x, y) =0 can be written as a system of n equations in
n+ m variables:

(59) rarer rer ar rer ee ee aD
Sel 19 0069 Xno Vis ees Pm) = 9.

The assumption that A, is invertible means that the n by n matrix

f= aa a

Dif, °** Duta

evaluated at (a, b) defines an invertible linear operator in R”; in other words,
its column vectors should be independent, or, equivalently, its determinant
should be +0. (See Theorem 9.36.) If, furthermore, (59) holds when x = a and
y = b, then the conclusion of the theorem is that (59) can be solved for x,,..., X,
in terms of y,,...; Ym» for every y near b, and that these solutions are continu-
ously differentiable functions of y.

Proof Define F by
(60) F(x, y) =(f(x, y),y) (x y) € £).
Then F is a @’-mapping of E into R"*". We claim that F(a, b) is an
invertible element of L(R"*”):
Since f(a, b) = 0, we have
f(a +h, b +k) = A(h,k) + r(h, k),
where r is the remainder that occurs in the definition of f’(a, b). Since

F(a + h, b + k) ~ F(a, b) = (f(a + h, b +k), k)
= (A(h, k), k) + (r(h, k), 0)


--- Page 235 ---

226 PRINCIPLES OF MATHEMATICAL ANALYSIS

(61)

(62)

(63)

(64)

(65)

it follows that F’(a, b) is the linear operator on R"*” that maps (h, k) to
(A(h, k), k). If this image vector is 0, then A(h, k) = 0 and k =0, hence
A(h, 0) = 0, and Theorem 9.27 implies that h = 0. It follows that F’(a, b)
is 1-1; hence it is invertible (Theorem 9.5).

The inverse function theorem can therefore be applied to F. It shows
that there exist open sets U and V in R"*”, with (a, b) € U, (0, b) € V, such
that F is a 1-1 mapping of U onto V.

We let W be the set of all ye R” such that (0, y)eV. Note that
be W.

It is clear that W is open since V is open.

If y € W, then (0, y) = F(x, y) for some (x, y) € U. By (60), f(x, y) =0
for this x.

Suppose, with the same y, that (x’, y)e U and f(x’, y) =0. Then

F(x’, y) = (f(x’, y), y) = (f(x, y), y) = F(, y).

Since F is 1-1 in U, it follows that x’ = x.
This proves the first part of the theorem.

For the second part, define g(y), for ye W, so that (g(y), y) e U and
(57) holds. Then

F(g(y),y)=@,y) (ye W).

If G is the mapping of V onto U that inverts F, then G e @’, by the inverse
function theorem, and (61) gives

(g(y),y)=G0,y) (ye W).

Since G € @’, (62) shows that ge @’.
Finally, to compute g’(b), put (g(y), y) = ®(y). Then

O'(y)k =(g'(y)k,k) (ye W, ke R”).

By (57), {(®(y)) =0 in W. The chain rule shows therefore that

f(@(y))®'(y) = 0.
When y = b, then ®(y) = (a, b), and f’(®(y)) = A. Thus

A®'(b) = 0.
It now follows from (64), (63), and (54), that
A,g'(b)k + A,yk = A(g’(b)k, k) = AD’(b)k = 0

for every ke R”. Thus

A,g'(b) + Ay = 0.


--- Page 236 ---

FUNCTIONS OF SEVERAL VARIABLES 227

This is equivalent to (58), and completes the proof.

Note. In terms of the components of f and g, (65) becomes

EPA, W.9)O) = -OrefIl0. 0)

Ss (sey) - - Ge)
j=1 \OX,] \OY, OV,
where 1 s<i<n,1<k<m.
For each k, this is a system of n linear equations in which the derivatives

0g ;/0y, (1 <j <n) are the unknowns.

or

9.29 Example Take n = 2, m =3, and consider the mapping f = (f,, /,) of
R> into R? given by
Si (1, X25 Vis V2» V3) = 20 + X21 — Ay. +3
F2(%15 X25 Vas Yo» V3) = Xz COS Xy— Ox, + 2V, — V3.
If a = (0, 1) and b = (3, 2, 7), then f(a, b) = 0.
With respect to the standard bases, the matrix of the transformation
A =f'(a, b) is

2 3 1-4 «0
4i~|_§ 1 2 2 el

(4d =|_§ i]: =|, 9-4]:

We see that the column vectors of [A,] are independent. Hence A, is invertible

and the implicit function theorem asserts the existence of a @’-mapping g, defined

in a neighborhood of (3, 2, 7), such that g(3, 2,7) = (0, 1) and f(g(y), y) = 0.
We can use (58) to compute g’(3, 2, 7): Since

Hence

(4)"I=14l =35 [5 73]

(58) gives
32 D1=-35|6 “alle 0 -il-[-} § 2]:


--- Page 237 ---

228 PRINCIPLES OF MATHEMATICAL ANALYSIS

In terms of partial derivatives, the conclusion is that

Dyg, =4 | Dg, =4 D39, = —-z
Dyg2. = —4 D,9, = D392 =15
at the point (3, 2, 7).

THE RANK THEOREM

Although this theorem is not as important as the inverse function theorem or
the implicit function theorem, we include it as another interesting illustration
of the general principle that the local behavior of a continuously differentiable
mapping F near a point x is similar to that of the linear transformation F’(x).

Before stating it, we need a few more facts about linear transformations.

9.30 Definitions Suppose X and Y are vector spaces, and A € L(X, Y), as in
Definition 9.6. The null space of A, WA), is the set of all x € X at which Ax = 0.
It is clear that (A) is a vector space in X.

Likewise, the range of A, &(A), is a vector space in Y.

The rank of A is defined to be the dimension of @(A).

For example, the invertible elements of L(R”) are precisely those whose
rank is n. This follows from Theorem 9.5.

If A € LCX, Y) and A has rank 0, then Ax = 0 forall xe 4, hence. (A) = YX.
In this connection, see Exercise 25.

9.31 Projections Let X be a vector space. An operator P € L(X) is said to be
a projection in X if P? = P.

More explicitly, the requirement is that P(Px) = Px for every xe X. In
other words, P fixes every vector in its range A(P).

Here are some elementary properties of projections:

(a) IfP is a projection in X, then every x € X has a unique representation
of the form

X=X; +X,

where x, € &(P), x, € V(P).

To obtain the representation, put x, = Px, x, =x —x,. Then
Px, = Px — Px, = Px — P’x =0. As regards the uniqueness, apply P to
the equation x = x, +x,. Since x, ¢ A(P), Px, = x,; since Px, = 0, it
follows that x, = Px.
(b) If X is a finite-dimensional vector space and if X, is a vector space in
X, then there is a projection P in X with A(P) = X,.


--- Page 238 ---

FUNCTIONS OF SEVERAL VARIABLES 229

If X, contains only 0, this is trivial: put Px = 0 for all x e X.
Assume dim X¥, =k >0. By Theorem 9.3, X has then a basis
{u,,..., u,} such that {u,,..., u,} is a basis of X,. Define

P(eyuy, +++ ¢,U,) = CU, te + GU,

for arbitrary scalars c,,..., Cy.

Then Px =x for every xe X,, and X, = AP).

Note that {u,,1,..., u,} is a basis of Y/(P). Note also that there are
infinitely many projections in X, with range X,, if 0 <dim X, <dim X.

9.32 Theorem Suppose m, n, r are nonnegative integers, m>r,n>r, F isa
@'-mapping of an open set E < R® into R™, and ¥'(x) has rank r for every x é E.
Fix ae E, put A =F (a), let Y, be the range of A, and let P be a projection
in R™ whose range is Y,. Let Y, be the null space of P.
Then there are open sets U and V in R", withae U, UC E, and there is a
1-1 @'-mapping H of V onto U (whose inverse is also of class @') such that

(66) F(H(x)) = Ax + (Ax) (xe V)
where @ is a @'-mapping of the open set A(V) < Y, into Y,.

After the proof we shall give a more geometric description of the informa-
tion that (66) contains.

Proof If r= 0, Theorem 9.19 shows that F(x) is constant in a neighbor-
hood U of a, and (66) holds trivially, with V = U, H(x) = x, @(0) = F(a).

From now on we assume r > 0. Since dim Y, =r, Y, has a basis
{y1,---5 Y,}. Choose z, € R" so that 4z; =y; (1 <i <r), and define a linear
mapping S of Y, into R” by setting

(67) Sey, °° +6, y,) = CZ, + + GZ,
for all scalars c,,...,¢,.
Then ASy; = Az; =y;for1 <i<r. Thus
(68) ASy=y (ye).
Define a mapping G of E into R” by setting
(69) G(x) =x + SP[F(x) — Ax] (xe E).

Since F’(a) = A, differentiation of (69) shows that G’(a) = /, the identity
operator on R”. By the inverse function theorem, there are open sets U
and V in R", with ae U, such that G is a 1-1 mapping of U onto V whose
inverse H is also of class ’. Moreover, by shrinking U and JV, if necessary,
we can arrange it so that V is convex and H’(x) is invertible for every x € V.


--- Page 239 ---

230 PRINCIPLES OF MATHEMATICAL ANALYSIS

(70)

(71)

(72)

(73)

(74)

(75)

(76)

(77)

(78)

Note that ASPA = A, since PA = A and (68) holds. Therefore (69)
gives
AG(x) = PF(x) (xe EL).
In particular, (70) holds for xe U. If we replace x by H(x), we obtain
PF(H(x)) = Ax (xe V).
Define
W(x) = F(x) — Ax (xe VV),
Since PA = A, (71) implies that Py(x) =0 for all xeV. Thus p is a
@'-mapping of V into Y,.
Since V is open, it is clear that A(V) is an open subset of its range
RA) = Yj.
To complete the proof, i.e., to go from (72) to (66), we have to show
that there is a @’-mapping g of A(V) into Y, which satisfies
p(Ax) =x) (xe V).
As a step toward (73), we will first prove that

(1) = W(X)

if x, EV, x, 6 V, Ax, = AX).
Put ®(x) = F(H(x)), for xe V. Since H’(x) has rank n for every
x € V, and F’(x) has rank r for every x € U, it follows that

rank ®’(x) = rank F’(H(x))H’(x) =r (xe V).

Fix xe V. Let M be the range of ®'(x). Then Mc R”, dim M =r.

By (71),

PO'(x) = A.
Thus P maps M onto &(A) = Y,. Since M and Y, have the same di-
mension, it follows that P (restricted to M) is 1-1.

Suppose now that 4h=0. Then P®’(x)h=0, by (76). But
®’(x)h € M, and P is 1-1 on M. Hence ®’(x)h =0. A look at (72) shows
now that we have proved the following:

Ifxe V and Ah = 0, then w’(x)h = 0.

We can now prove (74). Suppose x, € V, x, eV, Ax, = Ax,. Put
h = x, — x, and define

at)=W(x,;+th) (Ost).
The convexity of V shows that x, + the V for these t. Hence

e@=Wx%,+thh=0 (O<t<1),


--- Page 240 ---

FUNCTIONS OF SEVERAL VARIABLES 231

so that g(1) = g(0). But g(1) = W(x,) and g(0) = W(x,). This proves (74).
By (74), W(x) depends only on Ax, for xe V. Hence (73) defines p
unambiguously in A(V). It only remains to be proved that ge @’.
Fix yo € A(V), fix x9 € V so that Axy =yy. Since Vis open, yo has
a neighborhood W in Y, such that the vector

(79) X =Xo + S(y — Yo)
lies in V for all ye W. By (68),
Ax = AXy) + Y — Yo =.
Thus (73) and (79) give
(80) ly) = WK — Syo + Sy) (ye W).

This formula shows that o € @’ in W, hence in A(V), since yp was chosen
arbitrarily in A(V).
The proof is now complete.

Here is what the theorem tells us about the geometry of the mapping F.
If y € F(U) then y = F(H(x)) for some x € V, and (66) shows that Py = Ax.
Therefore

(81) y=Py+o(Py) (ye F(U)).

This shows that y is determined by its projection Py, and that P, restricted
to F(U), is a 1-1 mapping of F(U) onto A(V). Thus F(U) is an “r-dimensional
surface” with precisely one point ‘“‘over’ each point of A(V). We may also
regard F(U) as the graph of 9.

If ®(x) = F(H(x)), as in the proof, then (66) shows that the level sets of ®
(these are the sets on which ® attains a given value) are precisely the level sets of
Ain V. These are “‘flat’’ since they are intersections with V of translates of the
vector space (A). Note that dim (A) =n — r (Exercise 25).

The level sets of F in U are the images under H of the flat level sets of ®
in V. They are thus “‘(m — r)-dimensional surfaces” in U.

DETERMINANTS

Determinants are numbers associated to square matrices, and hence to the
Operators represented by such matrices. They are 0 if and only if the corre-
sponding operator fails to be invertible. They can therefore be used to decide
whether the hypotheses of some of the preceding theorems are satisfied. They
will play an even more important role in Chap. 10.


--- Page 241 ---

232 PRINCIPLES OF MATHEMATICAL ANALYSIS

9.33 Definition If (j;,...,/,) is an ordered n-tuple of integers, define

p<q
where sgnx=1 if x>0, sgnx=—1 if x<0, sgnx=0 if x =0. Then
S(t, +++sJn) =1, —1, or 0, and it changes sign if any two of the /’s are inter-

changed.

Let [A] be the matrix of a linear operator 4 on R”, relative to the standard
basis {e,,..., ,}, with entries a(/,/) in the th row and jth column. The deter-
minant of [A] is defined to be the number
(83) det [A] = }) s(j1, -.- jal, f1)a(2, jn) +++ a”, jy).

The sum in (83) extends over all ordered n-tuples of integers (j,,...,j,) with

1l<j,<n.
The column vectors x, of [A] are
(84) x= ade (I <isn.
It will be convenient to think of det [4] as a function of the column vectors
of [A]. If we write

det (x,,..., X,) = det [4],

det is now a real function on the set of all ordered n-tuples of vectors in R”.

9.34 Theorem
(a) If Tis the identity operator on R", then
det [7] = det (e,,...,e,) =1.

(b) det is a linear function of each of the column vectors x; , if the others are
held fixed.

(c) If [A]; is obtained from {A] by interchanging two columns, then
det [A], = —det [4].

(d) If [A] has two equal columns, then det [A] = 0.

Proof If A =/, then a(i, i) =1 and a(i,j) =0 for i #7. Hence
det [7] = s(1, 2,...,”) =1,

which proves (a). By (82), s(/j1,...,j,) = 0 if any two of the j’s are equal.
Each of the remaining n! products in (83) contains exactly one factor
from each column. This proves (6). Part (c) is an immediate consequence
of the fact that s(j,,...,j,) changes sign if any two of the /’s are inter-
changed, and (d) is a corollary of (c).


--- Page 242 ---

9.35

(85)

(86)

(87)

(88)

(89)

9.36

(90)

FUNCTIONS OF SEVERAL VARIABLES 233

Theorem Jf [A] and [B] are n by n matrices, then
det ({B][A]) = det [B] det [A].
Proof Ifx,,..., x, are the columns of [A], define
Ag(X1, +++, Xn) = As[A] = det ([B][A)).
The columns of [B][A] are the vectors Bx,,..., Bx,. Thus
Ap(X1,.-., X,) = det (Bx,,..., Bx,).
By (86) and Theorem 9.34, Az also has properties 9.34 (5) to (@). By (6)
and (84),
A,[A] = Ag (2 a(i, 1)e;, X2,..-, %n) = 2 ati 1) Ag(e;, X25 --+5 Xq)=
Repeating this process with x,,..., x,, we obtain
A,[A] = »y (i, l)a(iz , 2) +++ ai, 1) Ag(e;,, -.-, &:,),
the sum being extended over all ordered n-tuples (i,,..., i,) with
1<i,<n. By (c) and (@),
Ap(Oj,s ++ +5 ©i,) = Clas. +5 tn) AplOr, «+ +s Cn),
where t = 1, 0, or —1, and since [B][7] = [B], (85) shows that
A,(e;, ..-, &,) = det [B].
Substituting (89) and (88) into (87), we obtain
det ([BIA) ={¥. ais, 1) +++ ai, nti, ..., i} det (BI,
for all n by n matrices [A] and [B]. Taking B = J, we see that the above
sum in braces is det [A]. This proves the theorem.
Theorem A /inear operator A on R" is invertible if and only if det [A] #9.
Proof If A is invertible, Theorem 9.35 shows that
det [A] det [A~!] = det [4A71] = det [7] = 1,

so that det [A] 40.

If A is not invertible, the columns x,,..., x, of [A] are dependent
(Theorem 9.5); hence there is one, say, x,, such that

x, + ¥c;x; =0
J#k

for certain scalars c;. By 9.34 (b) and (d), x, can be replaced by x, + c,x;
without altering the determinant, if j 4k. Repeating, we see that x, can


--- Page 243 ---

234 PRINCIPLES OF MATHEMATICAL ANALYSIS

be replaced by the left side of (90), i-e., by 0, without altering the deter-
minant. But a matrix which has 0 for one column has determinant 0.
Hence det [A] =0.

9.37 Remark Suppose {e,,...,e,} and {u,,...,u,} are bases in R".
Every linear operator A on R" determines matrices [A] and [A],, with entries
a;; and «;;, given by

u

If u, = Be; = Xd,,e;, then Au, is equal to
Y o%; Be, = Yj Din ei = Dy (2 Bin) e;,
k k i i\k

and also to
ABe, =A py by; &% = » (2 ain Ors) e;.

Thus 25;,%; = 2a;,b,;, or
(91) [B][A]y = [A][B}.

Since B is invertible, det [B] #0. Hence (91), combined with Theorem 9.35,
shows that
(92) det [A]y = det [A].

The determinant of the matrix of a linear operator does therefore not
depend on the basis which is used to construct the matrix. It is thus meaningful
to speak of the determinant of a linear operator, without having any basis in mind.

9.38 Jacobians If fmaps an open set Ec R" into R", and if f is differen-
tiable at a point xe E, the determinant of the linear operator f’(x) is called
the Jacobian of f at x. In symbols,

(93) J,(x) = det f’(x).
We shall also use the notation

O01; sees Vn)
OX 15 +++ 5 Xn)

for J (x), if 1 ane) Vn) = f(, seep ns
In terms of Jacobians, the crucial hypothesis in the inverse function

theorem is that J,(a) #0 (compare Theorem 9.36). If the implicit function
theorem is stated in terms of the functions (59), the assumption made there on
A amounts to

(94)

A(X, +665 Xq) #0.


--- Page 244 ---

FUNCTIONS OF SEVERAL VARIABLES 235

DERIVATIVES OF HIGHER ORDER

9,39 Definition Suppose fis a real function defined in an open set Ec R’,

with partial derivatives D,f,..., D,f- If the functions D,f are themselves

differentiable, then the second-order partial derivatives of f are defined by
Dijf=D;,D,f Wj=l,...,n).

If all these functions D,,f are continuous in E, we say that fis of class @” in E,

or that fe @"(E).

A mapping f of E into R” is said to be of class @” if each component of f
is of class @”.

It can happen that D;,f # D,,f at some point, although both derivatives
exist (see Exercise 27). However, we shall see below that D,,f = D,,f whenever
these derivatives are continuous.

For simplicity (and without loss of generality) we state our next two
theorems for real functions of two variables. The first one is a mean value
theorem.

9.40 Theorem Suppose f is defined in an open set Ec R*, and D,f and D,,f
exist at every point of E. Suppose Q < E is a closed rectangle with sides parallel
to the coordinate axes, having (a,b) and (a+h,b+k) as opposite vertices
(A #40, k #0). Put
A(f, Q) =fath, b+k)—flath, b)-f@b+k)+f(a, d).

Then there is a point (x, y) in the interior of Q such that
(95) A(f, Q) = hk(Dai f(x, y).

Note the analogy between (95) and Theorem 5.10; the area of Q is Ak.

Proof Put u(t) =f(t,6 +k) —f(t, 6). Two applications of Theorem 5.10
show that there is an x between a and a + A, and that there is a y between
b and b + k, such that
AG, Q) = u(a + A) — u(a)
= hu'(x)
= A[(Dif)(x, b + k) — (Dif), 6)]
= Ak(D2sf)(x, y)-
9.41 Theorem Suppose f is defined in an open set E< R*, suppose that Dyf,

D,,f, and D,f exist at every point of E, and Df is continuous at some point
(a, bE E.


--- Page 245 ---

236 PRINCIPLES OF MATHEMATICAL ANALYSIS

Then D,f exists at (a, b) and
(96) (Dy 2f)(@, 6) = (Dai f)(a, 6).

Corollary D.,f = D,2f if fe @'(E).

Proof Put A =(D2;:f)(a,b). Choose e>0. If Q is a rectangle as in
Theorem 9.40, and if 4 and k are sufficiently small, we have

|A — (Dai f\(x, y)| <e
for all (x, y)eQ. Thus

3

ACE 9)
| LO 4) <

by (95). Fix h, and let kK0. Since D,/f exists in E, the last inequality
implies that

(97) Or Ya + h, 6) - (Dafa, b) _
h

<6.

Since ¢ was arbitrary, and since (97) holds for all sufficiently small
h #0, it follows that (D,,/f)(a, 6) = A. This gives (96).

DIFFERENTIATION OF INTEGRALS

Suppose g is a function of two variables which can be integrated with respect
to one and which can be differentiated with respect to the other. Under what
conditions will the result be the same if these two limit processes are carried out
in the opposite order? To state the question more precisely: Under what
conditions on g can one prove that the equation

d pt bg
(98) 5 [ oc, t) dx = I. a (x, t) ax

is true? (A counter example is furnished by Exercise 28.)
It will be convenient to use the notation

(99) (x) = ox, t).

Thus ¢’ is, for each t, a function of one variable.

9.42 Theorem Suppose

(a) (x, t) is defined fora<x<b,c<t<d;
(b) « is an increasing function on [a, b];


--- Page 246 ---

FUNCTIONS OF SEVERAL VARIABLES 237

(c) oe R@) for every te [c, a];
(d) ¢<s<d, and to every ¢ > 0 corresponds a 6 > 0 such that

|(D2 p)(x, t) — (D2 p)(x, 8)| <e
for ali x € (a, b] and for all te(s — 6, s + 9).

Define

(100) f(t) = [96s thda(x) (c<t<d).
Then (D, 9)* € R(a), f'(s) exists, and

(101) £6) = [ Drees s) deca,

Note that (c) simply asserts the existence of the integrals (100) for all
te[c, d]. Note also that (d) certainly holds whenever D, ¢ is continuous on the
rectangle on which @ is defined.

Proof Consider the difference quotients

_ 9(x, t) — 9x, 5)
~ t—s

W(x, t)

for 0< |t—s| <6. By Theorem 5.10 there corresponds to each (x, t) a
number u between s and ¢ such that

W(x, t) = (D2 p(x, w).
Hence (d) implies that
(102) | W(x, t)-(D, gx, s)|<e (asx<b, 0<|t—s| <6).
Note that
f@ -f(O)

(103) —

= i) "ye, 1) d(x).

By (102), y'—+(D,)*, uniformly on [a, 5], as ts. Since each
Wt € Ra), the desired conclusion follows from (103) and Theorem 7.16.

9.43 Example One can of course prove analogues of Theorem 9.42 with
(— 0, 00) in place of [a,b]. Instead of doing this, let us simply look at an
example. Define

(104) fit) = ["e-** cos (xt) dx


--- Page 247 ---

238 PRINCIPLES OF MATHEMATICAL ANALYSIS

and
* —y2

(105) g(t) = — f xe~* sin (xt) dx,
~D

for —co <t< oo. Both integrals exist (they converge absolutely) since the
absolute values of the integrands are at most exp (— x”) and |x| exp (—x’),
respectively.

Note that g is obtained from f by differentiating the integrand with respect
to ¢. We claim that fis differentiable and that

(106) S@=g9t) (-o<t<o).

To prove this, let us first examine the difference quotients of the cosine:
if B > 0, then
cos(a+B)—cosa . 1 ptt .
Serene: sin == (sin « — sin f) dt.
a

Since |sin « — sin t| < |t — a|, the right side of (107) is at most B/2 in absolute
value; the case 8B <0 is handled similarly. Thus

(107)

cos (% + B) — cos «
B

for all f (if the left side is interpreted to be 0 when f = 0).
Now fix ¢, and fix # #0. Apply (108) with « = xt, B = xh; it follows from
(104) and (105) that

ft+W-fO)_
h

(108) + sin

< |B

< |h| f xe"? dx.

g(t)

When 4 > 0, we thus obtain (106).
Let us go a step further: An integration by parts, applied to (104), shows
that

(109) fi) =2[” xe

Thus f(t) = — 2g(t), and (106) implies now that / satisfies the differential
equation

(110) 2f'(t) + f(t) =0.

If we solve this differential equation and use the fact that f(0) = Jn (see Sec.
8.21), we find that

(111) ft) =J/nexp (- )

The integral (104) is thus explicitly determined.

_,2 Sin &) dx.


--- Page 248 ---

FUNCTIONS OF SEVERAL VARIABLES 239

EXERCISES
1.

3

If S is a nonempty subset of a vector space X, prove (as asserted in Sec. 9.1) that
the span of S is a vector space.

. Prove (as asserted in Sec. 9.6) that BA is linear if A and Bare linear transformations.

.

Prove also that A-? is linear and invertible.
Assume A € L(X, Y) and Ax = 0 only when x = 0. Prove that A is then 1-1.

- Prove (as asserted in Sec. 9.30) that null spaces and ranges of linear transforma-

tions are vector spaces.

. Prove that to every A € L(R", R') corresponds a unique y € R" such that Ax = x-vy.

Prove also that ||A||= ly].
Hint: Under certain conditions, equality holds in the Schwarz inequality.

- If f(0, 0) = 0 and

[@N=Zy  #&N#OO,

prove that (D, f)(x, y) and (D:f)(x, y) exist at every point of R?, although / is
not continuous at (0, 0).

. Suppose that fis a real-valued function defined in an open set E < R", and that

the partial derivatives D, f,..., D,f are bounded in E. Prove that fis continuous
in E,
Hint: Proceed as in the proof of Theorem 9.21.

. Suppose that fis a differentiable real function in an open set E < R", and that f

has a local maximum at a point x € E. Prove that f’(x) = 0.

. If f is a differentiable mapping of a connected open set E< R" into R”, and if

10.

11,

12.

f(x) = 0 for every x € E, prove that f is constant in E.
If fis a real function defined in a convex open set E < R", such that (Di /)(x) = 0
for every x € E, prove that f(x) depends only on x2,..., Xn.

Show that the convexity of E can be replaced by a weaker condition, but
that some condition is required. For example, if n= 2 and E is shaped like a
horseshoe, the statement may be false.
If fand g are differentiable real functions in R", prove that

VU9) =f Vo +9 Vh

and that V(1/f) = — f-2Vf wherever f 4 0.
Fix two real numbers a and b,0<a<b. Define a mapping f= (fi, f2, fs) of R?
into R? by

fils, t) = (b + acos s) cos ¢

F.(s, t) = (6+ acoss) sin t

Ja(s, t) =a sins.


--- Page 249 ---

240 PRINCIPLES OF MATHEMATICAL ANALYSIS

13.

14,

15.

Describe the range K of f. (It is a certain compact subset of R°.)
(a) Show that there are exactly 4 points p € K such that

(VA)(E-"(p)) = 0.

Find these points.
(6) Determine the set of all q €¢ K such that

(Vfs)(£-*(q)) = 0.

(c) Show that one of the points p found in part (a) corresponds to a local maxi-
mum of f,, one corresponds to a local minimum, and that the other two are
neither (they are so-called “‘saddle points”’).

Which of the points q found in part (6) correspond to maxima or minima?
(d) Let A be an irrational real number, and define g(r) = f(r, Ar). Prove that g is a
1-1 mapping of R' onto a dense subset of K. Prove that

|g’(t)|? = a? + A2(b + acos t)?.

Suppose f is a differentiable mapping of R! into R? such that |f(t)|= 1 for every +.
Prove that f’(t) f(t) = 0.
Interpret this result geometrically.

Define /(0, 0) = 0 and

x3 .

S(x,y) = vay if (x, y) A (0, 0).
(a) Prove that Difand D,f are bounded functions in R?. (Hence / is continuous.)
(b) Let u be any unit vector in R?. Show that the directional derivative (Dy f)(0, 0)
exists, and that its absolute value is at most 1.
(c) Let y be a differentiable mapping of R' into R? (in other words, y is a differ-
entiable curve in R?), with (0) = (0, 0) and |y’(0)|>0. Put g(t) =f((t)) and
prove that g is differentiable for every t € R’.

If y € @, prove that g € ©”.
(da) In spite of this, prove that fis not differentiable at (0, 0).

Hint: Formula (40) fails.
Define £(0, 0) = 0, and put
4x®y?
= y2 2 Dy2y a
I(x, Y) = x? + y? — 2x?y (x* + y?)2
if (x, y) # (0, 0).
(a) Prove, for all (x, y) € R?, that

4xty? < (x+ + y?)?,

Conclude that fis continuous.


--- Page 250 ---

16.

17.

18.

19

20.

21,

FUNCTIONS OF SEVERAL VARIABLES 241

(6) For 0<@<27, —w <1 < 0, define
gt) = f(t cos 6, ¢ sin 9).

Show that ge(0) = 0, g3(0) = 0, gg(0) = 2. Each gp has therefore a strict local

minimum at ¢ = 0.

In other words, the restriction of f to each line through (0, 0) has a strict
local minimum at (0, 0).
(c) Show that (0, 0) is nevertheless not a local minimum for f; since f(x, x”) = —x*.
Show that the continuity of f’ at the point a is needed in the inverse function
theorem, even in the casen=1: If

f(t) =t + 22? sin (2)

for 40, and f()=0, then /’(0)=1, f’ is bounded in (—1, 1), but f is not
one-to-one in any neighborhood of 0.
Let f = (/1, f2) be the mapping of R? into R? given by

Silx, y)=e*% cosy, — fa(x, y) = e* sin y.
(a) What is the range of f?
(6) Show that the Jacobian of f is not zero at any point of R?. Thus every point
of R? has a neighborhood in which fis one-to-one. Nevertheless, fis not one-to-

one on R?,

(c) Put a = (0, 7/3), b= f(a), let g be the continuous inverse of f, defined in a
neighborhood of b, such that g(b) =a. Find an explicit formula for g, compute
f(a) and g’(b), and verify the formula (52).

(d) What are the images under f of lines parallel to the coordinate axes?

Answer analogous questions for the mapping defined by

u=x?—y?, v= 2xy.
Show that the system of equations
3x+y—z+u?=0
x—y+2z+u=0
2x + 2y—3z+ 2u=0
can be solved for x, y, u in terms of z; for x, z, u in terms of y; for y, z, vin terms

of x; but not for x, y, z in terms of u.
Take n= m= 1 in the implicit function theorem, and interpret the theorem (as

well as its proof) graphically.
Define fin R? by
F(X, Y) = 2x? — 3x? + dy? + 3y?,
(a) Find the four points in R? at which the gradient of fis zero. Show that f has
exactly one local maximum and one local minimum in R?.


--- Page 251 ---

242 PRINCIPLES OF MATHEMATICAL ANALYSIS

22.

24.

25.

26.

27.

28,

(6) Let S be the set of all (x, y) €¢ R? at which f(x, y) =0. Find those points of
S that have no neighborhoods in which the equation f(x, y) = 0 can be solved for
y in terms of x (or for x in terms of y). Describe S$ as precisely as you can.
Give a similar discussion for

S (x, y) = 2x3 + 6xy? — 3x? + 3y?.

. Define f in R* by

S(% Vi Yd) HX ter + yr.

Show that f(0, 1, —1) =0, (D,f)(0, 1, —1) #0, and that there exists therefore a
differentiable function g in some neighborhood of (1, —1) in R?, such that
gl, —1)=0 and

Find (D,g)(1, —1) and (D2g)(1, —1).

For (x, y) #(0, 0), define f = (A, f2) by
_ x?—y? _
AGW=aTR Ty? F2(x, y) iy

Compute the rank of f’(x, y), and find the range of f.

Suppose A € L(R", R”), let r be the rank of A.

(a) Define S as in the proof of Theorem 9.32. Show that SA is a projection in R"
whose null space is (A) and whose range is A(S). Hint: By (68), SASA = S A.
(b) Use (a) to show that

dim (A) + dim &(A) = n.

Show that the existence (and even the continuity) of D,.f does not imply the
existence of D, f. For example, let f(x, y) = g(x), where g is nowhere differentiable.
Put f(0, 0) = 0, and

xy(x? — y?)

[Y= Ly

if (x, y) # (0, 0). Prove that
(a) f, Di f, D2f are continuous in R?;

(b) Di2fand D2, f exist at every point of R?, and are continuous except at (0, 0);
(c) (Di2f)(0, 0) = 1, and (Dai f)(0, 0) = —1.

For t >0, put
x — O<x<vi)_
Ax HN=f—-xt2Vt (Wt<x<2v>1)
0 (otherwise),

and put 9x, t) = —¢(x, |t|) if t<0.


--- Page 252 ---

29.

30.

FUNCTIONS OF SEVERAL VARIABLES 243

Show that ¢ is continuous on R?, and
(D2 p(x, 0) = 0

for all x. Define
f= {oD ae.
Show that f(t) = ¢ if |t| <4. Hence
£)#[ (Dighlx,0) de.

Let E be an open set in R". The classes @’(E) and @”(E) are defined in the text.
By induction, @“(£) can be defined as follows, for all positive integers k: To say
that f e @(E) means that the partial derivatives D, f, ..., D,f belong to @*- P(E).

Assume f¢ @(E), and show (by repeated application of Theorem 9.41)
that the kth-order derivative

Dues vee uf= Du Dey ery Du f

is unchanged if the subscripts /,,..., # are permuted.
For instance, if n > 3, then

Diaisf= Dsir2f

for every fe 6,

Let fe GE), where E is an open subset of R". Fix a ¢ E, and suppose x € R"
is so close to 0 that the points

p(t) =a+ tx
lie in E whenever 0<t<1. Define
A(t) = f(p(t))

for all t € R' for which p(t) € E.
(a) For 1 <k <™m, show (by repeated application of the chain rule) that

A(t) = (Dir + FPO) X01 0 Xe

The sum extends over all ordered k-tuples (1, ..., i) in which each 7, is one of the
integers 1,..., 7.
(6) By Taylor’s theorem (5.15),

m-1 Jk) m)

k

for some ¢ € (0, 1). Use this to prove Taylor’s theorem in n variables by showing
that the formula


--- Page 253 ---

244 PRINCIPLES OF MATHEMATICAL ANALYSIS

31

m-1 1
fat+x)= > pe (Dig oo tf Maer ++ Xe + 10K)
represents f(a -- x) as the sum of its so-called “Taylor polynomial of degree
m— 1,” plus a remainder that satisfies
tim L& =o,
xo |x|"

Each of the inner sums extends over all ordered X-tuples (i,,..., i), aS in
part (a); as usual, the zero-order derivative of f is simply f, so that the constant
term of the Taylor polynomial of f at a is f(a).

(c) Exercise 29 shows that repetition occurs in the Taylor polynomial as written in
part (b). For instance, D,,3 occurs three times, as Dii3, D131, Dai1. The sum of
the corresponding three terms can be written in the form

3(Di Ds f\a)xj xs.

Prove (by calculating how often each derivative occurs) that the Taylor polynomial
in (6) can be written in the form

Diy +++ Di" f(a) tn
x! al et a ot Xn
Here the summation extends over all ordered n-tuples (s,,..., 5.) such that each
s, is a nonnegative integer, and s,+-:'+s5,<m—1.
Suppose fe 4 in some neighborhood of a point a e R?, the gradient of f is 0
at a, but not all second-order derivatives of fare 0 at a. Show how one can then
determine from the Taylor polynomial of fat a (of degree 2) whether f has a local
maximum, or a local minimum, or neither, at the point a.

Extend this to R" in place of R?.


--- Page 254 ---

10

INTEGRATION OF DIFFERENTIAL FORMS

Integration can be studied on many levels. In Chap. 6, the theory was developed
for reasonably well-behaved functions on subintervals of the real line. In
Chap. 11 we shall encounter a very highly developed theory of integration that
can be applied to much larger classes of functions, whose domains are more
or less arbitrary sets, not necessarily subsets of R’. The present chapter is
devoted to those aspects of integration theory that are closely related to the
geometry of euclidean spaces, such as the change of variables formula, line
integrals, and the machinery of differential forms that is used in the statement
and proof of the n-dimensional analogue of the fundamental theorem of calculus,
namely Stokes’ theorem.

INTEGRATION

10.1 Definition Suppose /* is a k-cell in R*, consisting of all
X= (X41, ..-, Xx)

such that

(1) a,sx;, <5, (G=1,...,),


--- Page 255 ---

246 PRINCIPLES OF MATHEMATICAL ANALYSIS

I! is the j-cell in R/ defined by the first j inequalities (1), and f is a real con-
tinuous function on I*.
Put f=/,, and define f,_, on J*~* by

by
Fe i(% 1, 006s Xe-y) = f F(X 15 vey Xp—ty Xu) AX,
a

The uniform continuity of f, on J* shows that f,-, is continuous on J*7!,
Hence we can repeat this process and obtain functions f;, continuous on I/, such
that f;_, is the integral of f;, with respect to x;, over [a;, b,]. After k steps we
arrive at a number fy, which we call the integral of f over I*; we write it in the
form

Q) [fod oo ff

A priori, this definition of the integral depends on the order in which the
k integrations are carried out. However, this dependence is only apparent. To
prove this, let us introduce the temporary notation L(f) for the integral (2)
and L’(f) for the result obtained by carrying out the & integrations in some
other order.

10.2 Theorem For every fe G(I"), L(f) = L'(f).
Proof If h(x) = h,(x,) +++ A,(x,), where h; € @({a;, 5,}), then

kK Ab
L(t) =|] [hie dx, = L'0).

If sf is the set of all finite sums of such functions A, it follows that L(g) =
L(g) for all g € . Also, sf is an algebra of functions on J* to which the
Stone-Weierstrass theorem applies.

k

Put V=[](6;—a,). If fe €(7*) and ¢ > 0, there exists g € such
1

that ||f—g\| < e/V, where ||f|| is defined as max [f(x)| (xeZ). Then
IL(f — 9)| <8, |L'(f—g)| < ¢, and since

Lf) - Lf) =LF-9)+L(9-S),

we conclude that |LZ(/) — L'(f)| < 2e.
In this connection, Exercise 2 is relevant.

10.3. Definition The support of a (real or complex) function f on R* is the
closure of the set of all points x e R* at which f(x) #0. If fis a continuous


--- Page 256 ---

INTEGRATION OF DIFFERENTIAL FORMS 247

function with compact support, let J* be any k-cell which contains the support
of f, and define

(3) [f= ms

The integral so defined is evidently independent of the choice of I*, provided
only that J* contains the support of f.

It is now tempting to extend the definition of the integral over R* to
functions which are limits (in some sense) of continuous functions with compact
support. We do not want to discuss the conditions under which this can be
done; the proper setting for this question is the Lebesgue integral. We shall
merely describe one very simple example which will be used in the proof of
Stokes’ theorem.

10.4 Example Let Q* be the k-simplex which consists of all points x=
(x1, +++, %,) in R* for which x, +°'+ +x%,<1 and x,20 foi i=1,...,k. If
k = 3, for example, Q* is a tetrahedron, with vertices at 0,e,,e,,e,. If fe ¢(Q"),
extend f to a function on J* by setting f(x) = 0 off Q*, and define

(4) { f=f Fr
Qk Tk
Here I* is the “unit cube”’ defined by
O<x,<1 (<i<h.

Since f may be discontinuous on J*, the existence of the integral on the
right of (4) needs proof. We also wish to show that this integral is independent
of the order in which the k single integrations are carried out.

To do this, suppose 0 < 6 < 1, put

1 (t<1—34)
(5) o(t) = ase (l-6<t<1)

0 (ai <9),
and define
(6) F(x) = (x, +1 +x) S(K) (xe),
Then Fe ¢(I*).

Put y= (x,,..., Xe-1), X = (y, x). For each ye J*~!, the set of all x,
such that Fy, x,) #f(y; x,) is either empty or is a segment whose length does
not exceed 6. Since 0 < g < 1, it follows that

(7) |Fr-1(¥) —fa-s)| SSI (ye r*),


--- Page 257 ---

248 PRINCIPLES OF MATHEMATICAL ANALYSIS

where ||f|| has the same meaning as in the proof of Theorem 10.2, and F,_,,
Jy-1 are as in Definition 10.1.
As 6 0, (7) exhibits f,., as a uniform limit of a sequence of continuous
functions. Thus f,_, € @(/*~'), and the further integrations present no problem.
This proves the existence of the integral (4). Moreover, (7) shows that

(8)

[ Foodx— f/x) dx| < dif]
Ik Ik

Note that (8) is true, regardless of the order in which the & single integrations
are carried out. Since Fe ¢(I"), JF is unaffected by any change in this order.
Hence (8) shows that the same is true of [f.

This completes the proof.

Our next goal is the change of variables formula stated in Theorem 10.9.
To facilitate its proof, we first discuss so-called primitive mappings, and parti-
tions of unity. Primitive mappings will enable us to get a clearer picture of the
local action of a @’-mapping with invertible derivative, and partitions of unity
are a very useful device that makes it possible to use local information in a
global setting.

PRIMITIVE MAPPINGS

10.5 Definition If G maps an open set Ec R" into R", and if there is an
integer m and a real function g with domain £ such that

(9) Gx) =D mertg@®en («Ee E),

then we call G primitive. A primitive mapping is thus one that changes at most
one coordinate. Note that (9) can also be written in the form

(10) G(x) = x + [9(K) — Xnlem-

If g is differentiable at some point ae E, so is G. The matrix [a,;] of the
operator G'(a) has

as its mth row. For j # m, we have a,,;=1 and a,,=0 if i#j. The Jacobian
of G at ais thus given by

(12) J¢(a) = det[G’(a)] = (Dn 9)(a),
and we see (by Theorem 9.36) that G’(a) is invertible if and only if (Dm g)(a) # 9.


--- Page 258 ---

INTEGRATION OF DIFFERENTIAL FORMS 249

10.6 Definition A linear operator B on R" that interchanges some pair of
members of the standard basis and leaves the others fixed will be called a flip.
For example, the flip B on R* that interchanges e, and e, has the form

(13) B(x, €, + X2€2 + X3€3 + X4e4) =X, ey + XZ 04 + X33 + XZ C2
or, equivalently,
(14) B(x, €; + X22 + 303 + X44) =X, Oy + X4Og + .X3€3 + XQ Ey.

Hence B can also be thought of as interchanging two of the coordinates, rather
than two basis vectors.

In the proof that follows, we shall use the projections Py, ..., P, in R’,
defined by Py x = 0 and
(15) PiyX = Xe, +t + Xmen

for 1<m<n. Thus P,, is the projection whose range and null space are
spanned by {e,,..., e,,} and {e,,41, -.-5 @,}, respectively,

10.7 Theorem Suppose F is a '-mapping of an open set E < R" into R", Ve E,
F(0) = 0, and F’(0) is invertible.
Then there is a neighborhood of 0 in R" in which a representation

(16) F(x) = B, +++ B,-1G, ° +++ ° G(x)

is valid.
In (16), each G, is a primitive @'-mapping in some neighborhood of 0;
G0) = 0, G(0) is invertible, and each B; is either a flip or the identity operator.

Briefly, (16) represents F locally as a composition of primitive mappings
and flips.

Proof Put F=F,. Assume 1<m<n-—1, and make the following
induction hypothesis (which evidently holds for m = 1):

V,, is a neighborhood of 0, F,, € @'(V,,) .F ,(0) = 0, F/,(0) is invertible,
and

(17) Pm —1F m(X) = Pu=1 x (x € Vin)e
By (17), we have

n
(18) F(X) = Pix +) a(x)e;,
mm
where «,,,..., &, are real @’-functions in V,,. Hence

(19) Fr (O)en = 5: (Dua) er.


--- Page 259 ---

250 PRINCIPLES OF MATHEMATICAL ANALYSIS

Since F/,(0) is invertible, the left side of (19) is not 0, and therefore there
is a k such that m<k <n and (D,,%,)(0) # 0.
Let B,, be the flip that interchanges m and this k (ifk = m, B,, is the
identity) and define
(20) G,,(x) = x + [o4(K) — Xmen (KE Vin)

Then G,,€ @'(V,,), G,, is primitive, and G/,(0) is invertible, since
(Dn %)(0) # 0.
The inverse function theorem shows therefore that there is an open
set U,,, with Oc U,, < V,,, such that G,, is a 1-1 mapping of U,, onto a
neighborhood V,,,, of 0, in which GZ! is continuously differentiable.
Define F,,., by
(21) Fn+i(¥) = BnFn 2 Guy) (y¥ € Vne1):
Then F,,4; €@’Vn+1)> Fn+1(0) = 0, and Fj,,,(0) is invertible (by
the chain rule). Also, for x¢ U,,,
= PlPm-1X + Oy (XO + ‘]
= Pig 1X + 4 (K) Om
= Py Ga(x)
so that

Our induction hypothesis holds therefore with m + 1 in place of m.
[In (22), we first used (21), then (18) and the definition of B,,, then
the definition of P,,, and finally (20).]
Since B,, B,, = 1, (21), with y = G,,(x), is equivalent to
If we apply this with m = 1, ..., 2 — 1, we successively obtain
F=F, = BF, °G,
= B,B, F;° G,°G, = °°:
= B, +) By-iF, ° G,-1 ort oG,

in some neighborhood of 0. By (17), F, is primitive. This completes the
proof,


--- Page 260 ---

INTEGRATION OF DIFFERENTIAL FORMS 251

PARTITIONS OF UNITY
10.8 Theorem Suppose K is a compact subset of R", and {V,} is an open cover
of K. Then there exist functions ,,..., ¥,€ @(R") such that

(2) 0<y¥,<lforlsi<s;
(b) each W, has its support in some V,, and
(c) W(x) + °° + W(x) = 1 for every x EK.

Because of (c), {y;} is called a partition of unity, and (b) is sometimes
expressed by saying that {y,} is subordinate to the cover {V,}.
Corollary If fe (R") and the support of f lies in K, then
25) f= LW
Each wf has its support in some V,.

The point of (25) is that it furnishes a representation of f as a sum of
continuous functions y,f with ‘‘small’ supports.

Proof Associate with each x € K an index a(x) so that xe Vay. Then
there are open balls B(x) and W(x), centered at x, with

(26) B(x) < W(x) < W(x) < Vag:
Since K is compact, there are points x,,..., x, in K such that
(27) Kc Bx,) U'++ U B(x).
By (26), there are functions ¢,, ..., 9,€ @(R"), such that g{x) =1 on
B(x;), 9 {x) = 0 outside W(x,), and 0 < 9,(x) <1 on R”. Define pW, = 9,
and
(28) Wisi = (1 — G1) °° — PD i41
fori=1,...,5—1.
Properties (a) and (5) are clear. The relation
(29) Wt +H, =1-(L-g)° A -

is trivial for i=1. If (29) holds for some i <s, addition of (28) and (29)
yields (29) with i+ 1 in place of i, It follows that

30) Lv) =1~T]H- 90] eR.

If x eK, then x € B(x,) for some i, hence ¢,(x) = 1, and the product in
(30) is 0. This proves (c).


--- Page 261 ---

252 PRINCIPLES OF MATHEMATICAL ANALYSIS

CHANGE OF VARIABLES

We can now describe the effect of a change of variables on a multiple integral.
For simplicity, we confine ourselves here to continuous functions with compact
support, although this is too restrictive for many applications. This is illustrated
by Exercises 9 to 13.

10.9 Theorem Suppose T is a 1-1 @'-mapping of an open set Ec R* into R*
such that J;(x) # 0 for allxé E. If fis a continuous function on R* whose support
is compact and lies in T(E), then

(31) [_f0) dy =f fT) |Je(0)| a.

We recall that J; is the Jacobian of T. The assumption J;(x) # 0 implies,
by the inverse function theorem, that T~' is continuous on T(E), and this
ensures that the integrand on the right of (31) has compact support in E
(Theorem 4.14).

The appearance of the absolute value of J;(x) in (31) may call for a com-
ment. Take the case k = 1, and suppose T is a 1-1 @’-mepping of R! onto R’.
Then J;(x) = T'(x); and if T is increasing, we have

(32) [ fora = J f@r'@) ax,

by Theorems 6.19 and 6.17, for all continuous f with compact support. But if
T decreases, then T'(x) <0; and if fis positive in the interior of its support,
the left side of (32) is positive and the right side is negative. A correct equation
is obtained if T’ is replaced by |7’| in (32).

The point is that the integrals we are now considering are integrals of
functions over subsets of R*, and we associate no direction or orientation with
these subsets. We shall adopt a different point of view when we come to inte-
gration of differential forms over surfaces.

Proof It follows from the remarks just made that (31) is true if T is a
primitive @’-mapping (see Definition 10.5), and Theorem 10.2 shows
that (31) is true if T is a linear mapping which merely interchanges two
coordinates.

If the theorem is true for transformations P, Q, and if S(x) = P(Q(x)),
then

[7@ de = | FPO) IO)| ay
= | £(P(O™%)|Fe(QC@)| |Jo0| ax
= | A(SC)|Is(%)| ax,


--- Page 262 ---

INTEGRATION OF DIFFERENTIAL FORMS 253

since
Jp(Q(x))Jo(x) = det P’(Q(x)) det O'(x)
= det P’(Q(x))Q’(x) = det S’(x) = Js(x),

by the multiplication theorem for determinants and the chain.rule. Thus
the theorem is also true for S.
Each point a é £ has a neighborhood U c E in which

(33) T(x) = T(a) + B, +++ By-1G, ° Gy_1 0 +++ ° Gy(x—a),

where G; and B; are as in Theorem 10.7. Setting V = T(U), it follows
that (31) holds if the support of flies in V. Thus:

Each point y € T(E) lies in an open set V, < T(E) such that (31) holds
for all continuous functions whose support lies in Vy.

Now let f be a continuous function with compact support K < T(E).
Since {V,} covers K, the Corollary to Theorem 10.8 shews that f= 2y,f,
where each w; is continuous, and each yw; has its support in some Vy.
Thus (31) holds for each wf, and hence also for their sum f-

DIFFERENTIAL FORMS

We shall now develop some of the machinery that is needed for the n-dimen-
sional version of the fundamental theorem of calculus which is usually called
Stokes’ theorem. The original form of Stokes’ theorem arose in applications of
vector analysis to electromagnetism and was stated in terms of the curl of a
vector field. Green’s theorem and the divergence theorem are other special
cases. These topics are briefly discussed at the end of the chapter.

It is a curious feature of Stokes’ theorem that the only thing that is difficult
about it is the elaborate structure of definitions that are needed for its statement.
These definitions concern differential forms, their derivatives, boundaries, and
orientation. Once these concepts are understood, the statement of the theorem
is very brief and succinct, and its proof presents little difficulty.

Up to now we have considered derivatives of functions of several variables
only for functions defined in open sets. This was done to avoid difficulties that
can occur at boundary points. It will now be convenient, however, to discuss
differentiable functions on compact sets. We therefore adopt the following
convention:

To say that f is a @’-mapping (or a @’-mapping) of a compact set
Dc R* into R" means that there is a ¢’-mapping (or a ¢’-mapping) g of
an open set Wc R* into R" such that D < W and such that g(x) = f(x) for
allxe D.


--- Page 263 ---

254 PRINCIPLES OF MATHEMATICAL ANALYSIS

10.10 Definition Suppose £ is an open set in R". A k-surface in E is a '-
mapping ® from a compact set D < R* into E.

D is called the parameter domain of ®. Points of D will be denoted by
u= (uy, ..., Ux).

We shali confine ourselves to the simple situation in which D is either a
k-cell or the k-simplex Q* described in Example 10.4. The reason for this is
that we shall have to integrate over D, and we have not yet discussed integration
over more complicated subsets of R*. It will be seen that this restriction on D
(which will be tacitly made from now on) entails no significant loss of generality
in the resulting theory of differential forms.

We stress that k-surfaces in E are defined to be mappings into E, not
subsets of E. This agrees with our earlier definition of curves (Definition 6.26).
In fact, 1-surfaces are precisely the same as continuously differentiable curves.

10.11 Definition Suppose £ is an open set in R". A differential form of order
k 21 in E (briefly, a k-form in E) is a function w, symbolically represented by
the sum

(34) o= > ai, eee i,(X) dx;, AtttaA ax,
(the indices i,, ..., i, range independently from 1 to n), which assigns to each
k-surface ® in E a number w(®) = Jo «, according to the rule
_ OX is 0+ +s Xi)
(35) le = [zr a;,°** ,({P(u)) Flim)

where D is the parameter domain of ®.

The functions a;,... ;, are assumed to be real and continuous in E. If
g,, ..-, &, are the components of ®, the Jacobian in (35) is the one determined
by the mapping

(uy, «.., Uk) > (6;,(0), ---, O;,()).

Note that the right side of (35) is an integral over D, as defined in Defini-
tion 10.1 (or Example 10.4) and that (35) is the definition of the symbol fg .

A k-form is said to be of class @’ or @” if the functions a;, ... ;, in (34)

are all of class @’ or ¢”.
A 0-form in E is defined to be a continuous function in E.

10.12 Examples
(a) Let y be a |-surface (a curve of class ¢’) in R°, with parameter
domain [0, 1].
Write (x, y, z) in place of (x,, x2, x3), and put

o=xdy+ydx.


--- Page 264 ---

(36)

INTEGRATION OF DIFFERENTIAL FORMS 255

Then
1
[o=[ mOnO +rOniOl a =1On® - 1Or0.

Note that in this example |, @ depends only on the initial point (0)
and on the end point y(1) of y. In particular, f, @ =0 for every closed
curve y. (As we shall see later, this is true for every 1-form @ which is
exact.)

Integrals of 1-forms are often called line integrals.

(b) Fixa>0,b>0, and define

y(t)=(acost,bsint) (0<t<2n),

so that y is a closed curve in R*. (Its range is an ellipse.) Then
2n
[xdy= [ab cos? tdt = nab,
y 0
whereas
2n
[ yax= -f ab sin? ¢ dt = — nab.
y 0

Note that J, x dy is the area of the region bounded by ». This is a
special case of Green’s theorem.
(c) Let D be the 3-cell defined by

0<r<il, 0<4<n, O0<o<2rz.
Define ®(r, 0, g) = (x, y, 2), where

x=rsin @ cos @
y=rsin @ sing

z=rcos@.
Then
_ 0%, Y, Zz) 26
Jo(r, 8, @) = 3,8, 0) r? sin 0.
Hence

[axa dy A a=foy =.

Note that ® maps D onto the closed unit ball of R°, that the mapping
is 1-1 in the interior of D (but certain boundary points are identified by
®), and that the integral (36) is equal to the volume of ®(D).


--- Page 265 ---

256 PRINCIPLES OF MATHEMATICAL ANALYSIS

10.13 Elementary properties Let w, w,, w, be k-forms in E. We write w, = ,
if and only if @,(®) = w,(®) for every k-surface ® in E. In particular, @ = 0
means that w(®) = 0 for every k-surface ® in E. If c¢ is a real number, then
cw is the k-form defined by

(37) [, cw =c f, Q,
and @ = w, + 2 means that
(38) [jo= fo + fe:

for every k-surface ® in E. As a special case of (37), note that —w is defined so
that

(39) [cos J, do.

Consider a k-form
(40) w = a(x) dx;, A ++: A dx;,

and let @ be the k-form obtained by interchanging some pair of subscripts in
(40). If (35) and (39) are combined with the fact that a determinant changes
sign if two of its rows are interchanged, we see that

(41) © = -o.
As a special case of this, note that the anticommutative relation
(42) dx, A dx; = —dx; A dx;
holds for all i and j. In particular,
(43) dx; A dx; =0 (=1,..., 7).

More generally, Jet us return to (40), and assume that i, =i, for some
r#s. If these two subscripts are interchanged, then @ = w, hence w =0, by
(41).

In other words, if w is given by (40), then w =0 unless the subscripts
ty, ..., i are all distinct.

If w is as in (34), the summands with repeated subscripts can therefore
be omitted without changing w.

It follows that 0 is the only k-form in any open subset of R", if k >.

The anticommutativity expressed by (42) is the reason for the inordinate
amount of attention that has to be paid to minus signs when studying differential
forms.


--- Page 266 ---

INTEGRATION OF DIFFERENTIAL FORMS 257

10.14 Basic k-forms If i,, ..., i, are integers such that 1 <i, <i, < °°:
<i, <n, and if is the ordered k-tuple {i,, ..., i,}, then we call J an increasing
k-index, and we use the brief notation

(44) dx, = dx; \°** A aX,,.

These forms dx, are the so-called basic k-forms in R".

It is not hard to verify that there are precisely n!/k!(n — k)! basic k-forms
in R"; we shall make no use of this, however.

Much more important is the fact that every k-form can be represented in
terms of basic k-forms. To see this, note that every k-tuple {j,, ..., j,} of distinct
integers can be converted to an increasing k-index J by a finite number of inter-
changes of pairs; each of these amounts to a multiplication by —1, as we saw
in Sec. 10.13; hence

(45) dx;, A wre A AX), = Efi,» ++ du) AXy
where é(j,,..., 4) is 1 or —1, depending on the number of interchanges that
are needed. In fact, it is easy to see that

where s is as in Definition 9.33.
For example,

dx, A dx5 \ dx4 \ dx, = —dx, A dx, AN dx, A dxs
and
dx, A dx, A dx, = dx, A dx, A dx,.

If every k-tuple in (34) is converted to an increasing k-index, then we
obtain the so-called standard presentation of ow:

(47) o= » b,(x) dx,.

The summation in (47) extends over all increasing k-indices J. [Of course, every

increasing k-index arises from many (from k!, to be precise) k-tuples. Each

5; in (47) may thus be a sum of several of the coefficients that occur in (34).]
For example,

X1 dx A dx, — Xz dx3 A dx, +%3 dx, A dx; +dx, a dx,
is a 2-form in R? whose standard presentation is
(1 — x1) dx, A dxz + (x2 + x3) dx, A dx;.

The following uniqueness theorem is one of the main reasons for the
introduction of the standard presentation of a k-form.


--- Page 267 ---

258 PRINCIPLES OF MATHEMATICAL ANALYSIS

10.15 Theorem Suppose
(48) wo = > b,(x) dx;
I

is the standard presentation of a k-form w in an open set E< R". If a =0 in E,
then b,(x) = 0 for every increasing k-index I and for every x € E.

Note that the analogous statement would be false for sums such as (34),
since, for example,

dx, \ dx, + dx, A dx, =0,

Proof Assume, to reach a contradiction, that b,(v) >0 for some ve E
and for some increasing k-index J = {j,,..., j,}. Since b, is continuous,
there exists 4 >0O such that b,(x) >0 for all x € R" whose coordinates
satisfy |x,;—v,| <A. Let D be the k-cell in R* such that ue D if and
only if |uv,| <A forr=1,...,k. Define

(49) @O(u) =v+ y u,@;, (ue D).

Then ® is a k-surface in E, with parameter domain D, and b,(®(u)) > 0
for every ue D.
We claim that

(50) {0 = i b,(®(u)) du.

Since the right side of (50) is positive, it follows that w(®) #0. Hence
(50) gives our contradiction.

To prove (50), apply (35) to the presentation (48). More specifically,
compute the Jacobians that occur in (35). By (49),

AXj,5 sees Xj,) _ 1
Au, wees My)

For any other increasing k-index 7 4 J, the Jacobian is 0, since it is the
determinant of a matrix with at least one row of zeros.

10.16 Products of basic k-forms Suppose

(51) T= {i,,..., ip}, J={ji,- +s Jah

where 1 <i, < ++: <i,<nmand1<j,<:++' <j,<n. The product of the cor-
responding basic forms dx, and dx, in R” is a (p+q)-form in R", denoted by
the symbol dx, A dx,, and defined by

(52) dx, \ dx; = dx;, \ *** A dx;, Adxj, A+" A dXx;,.


--- Page 268 ---

INTEGRATION OF DIFFERENTIAL FORMS 259

If J and J have an element in common, then the discussion in Sec. 10.13
shows that dx, a dx; = 0.

If I and J have no element in common, let us write [J, J] for the increasing
(p + g)-index which is obtained by arranging the members of J U J in increasing
order. Then dx;; jis a basic (p + q)-form. We claim that

(53) dx, A dx, = (- 1)* ax¢r, 9

where « is the number of differences j, — i, that are negative. (The number of
positive differences is thus pq — a.)
To prove (53), perform the following operations on the numbers

(54) LESS nee Pet

Move i, to the right, step by step, until its right neighbor is larger than i,.
The number of steps is the number of subscripts ¢ such that i,<j,. (Note that
0 steps are a distinct possibility.) Then do the same for i,_,,..., i. The total
number of steps taken is «. The final arrangement reached is [J, J]. Each step,
when applied to the right side of (52), multiplies dx, A dx; by —1. Hence (53)
holds.

Note that the right side of (53) is the standard presentation of dx, A dx,.

Next, let K = (k,, ..., k,) be an increasing r-index in {1,...,}. We shall
use (53) to prove that
(55) (dx; A dx;) A dxx = dx, A (dx A dxx).

If any two of the sets J, J, K have an element in common, then each side
of (55) is 0, hence they are equal.

So let us assume that J, J, K are pairwise disjoint. Let [/, J, K] denote
the increasing (p + q + r)-index obtained from their union. Associate B with
the ordered pair (J, K) and y with the ordered pair (Z, K) in the way that « was
associated with (J, J) in (53). The left side of (55) is then

(—1)* dxer, yy AGXx = (-1)%(- 1f*? Axe, 1, Kx)
by two applications of (53), and the right side of (55) is

(—1)? dx, a axt5, Ky =(- 1)*(-1)**? €X¢1, 3, Ky):
Hence (55) is correct.

10.17 Miuitiplication Suppose w and 4 are p- and q-forms, respectively, in
some open set E c R", with standard presentations

(56) O= Pb) de, A= Fox) dry

where J and J range over all increasing p-indices and over all increasing g-indices
taken from the set {1, ..., n}.


--- Page 269 ---

260 PRINCIPLES OF MATHEMATICAL ANALYSIS

Their product, denoted by the symbol w A A, is defined to be
(57) wo AA=¥ bj(x)c,(x) dx, A dxy.
fa
In this sum, /and J range independently over their possible values, and dx, A dx,
is as in Sec. 10.16. Thus w A / is a(p+q)-form in E.

It is quite easy to see (we leave the details as an exercise) that the distribu-
tive laws

(@, + @2) AA =(@, AA) + (@2 AA)
and
@A (A, +42) =(@AA)+(@AA,)

hold, with respect to the addition defined in Sec. 10.13. If these distributive
laws are combined with (55), we obtain the associative law

(58) (MOAA)AGT=OA(AAB)

for arbitrary forms @, A, o in E.
In this discussion it was tacitly assumed that p > 1 andg > 1. The product
of a 0-form f with the p-form @ given by (56) is simply defined to be the p-form

fo = of = Lf (x)b,(x) dx;.

It is customary to write fw, rather than fA w, when fis a 0-form.

10.18 Differentiation We shall now define a differentiation operator d which
associates a (k + 1)-form dw to each k-form @ of class $’ in some open set
Ec R’.

A 0-form of class @’ in E is just a real function fe @’(£), and we define

(59) i= ¥ DiN® de.

If @ = Xb,(x) dx; is the standard presentation of a k-form w, and b, € @’(E)
for each increasing k-index J, then we define

(60) don = 5 (db) A dx.

10.19 Example Suppose £ is open in R", fe ¢'(E), and y is a continuously
differentiable curve in E, with domain [0, 1]. By (59) and (35),

(61) f =f. S Dinner ae


--- Page 270 ---

INTEGRATION OF DIFFERENTIAL FORMS 261

By the chain rule, the last integrand is (fe y)’(t). Hence

(62)

J df = f(y) —f),

and we see that J, dfis the same for all y with the same initial point and the same
end point, as in (a) of Example 10.12.

Comparison with Example 10.12(b) shows therefore that the 1-form x dy

is not the derivative of any 0-form f. This could also be deduced from part (b)
of the following theorem, since

d(x dy) = dx a dy #9.

10.20 Theorem

(63)

(64)

(a) If w and A are k- and m-forms, respectively, of class @' in E, then
d(w A A) = (dw) ANA +(-lfFoa da.
(b) If w is of class " in E, then d?w = 0.
Here d*w means, of course, d(dw).

Proof Because of (57) and (60), (a) follows if (63) is proved for the
special case

where f, g € @(E), dx, is a basic k-form, and dx, is a basic m-form. [If
k or m or both are 0, simply omit dx ; or dx, in (64); the proof that follows
is unaffected by this.] Then

wonrnA=fgdx;,A dx;.

Let us assume that J and J have no element in common. [In the other
case each of the three terms in (63) is 0.] Then, using (53),

d(wm A A) = d(fg dx;  dxj) =(—1)* d(fg axzz, 1).
By (59), dig) = fdg +9 df. Hence (60) gives

dw a a= (—1"" (fdg + g df) A ax, 7
= (gdf+fdg) a dx; A dx;.
Since dg is a 1-form and dx, is a k-form, we have

dg n dx; =(—1) dx, a dg,


--- Page 271 ---

262 PRINCIPLES OF MATHEMATICAL ANALYSIS

by (42). Hence
d(w 0 A) = df a dxy) A (g dx) + (—1)f dx) A (dg A dxy)
= (dw) a A+(—1)'o a dd,
which proves (a).

Note that the associative law (58) was used freely.
Let us prove (6) first for a 0-form fe @”:

af = a( ¥ (Df \(x) dx y
jmi
= LaDy) 1 ay

= & (Duf) dx,» dx,.

Since D,,f= D,,f (Theorem 9.41) and dx, a dx, = —dx, a dx,, we see
that d?f=0.

If o =fdx,, as in (64), then dw = (df) a dx;. By (60), d(dx,) =0.
Hence (63) shows that

d?w = (df) a dx, =0.

10.21 Change of variables Suppose £ is an open set in R’, Tis a @’-mapping
of £ into an open set V < R”, and @ is a k-form in V, whose standard presenta-

tion is
(65) o= 6x9) dy;.

(We use y for points of V, x for points of £.)
Let ¢,,..., 4, be the components of 7: If

y=(, ses Ym) = T(x)
then y, = ¢,(x). As in (59),
(66) dt; =, t)(x)dx, (lsism).

Thus each df, is a 1-form in E.
The mapping 7 transforms w into a k-form w, in £, whose definition is

(67) Or = ) OAT (x) dt, A+++ A dt,,.
I
In each summand of (67), J = {i,, ..., i,} is an increasing k-index.

Our next theorem shows that addition, multiplication, and differentiation
of forms are defined in such a way that they commute with changes of variables.


--- Page 272 ---

INTEGRATION OF DIFFERENTIAL FORMS 263

10.22 Theorem With E and T as in Sec. 10.21, let w and A be k- and m-forms
in V, respectively. Then

(68)

(69)

(70)

(a) (o+Ap=ortApifk=m;
(b) (@ AA) =O7 A Az;
(c) d(wyz) = (dw)z if w is of class @' and T is of class @".

Proof Part (a) follows immediately from the definitions. Part (5) is
almost as obvious, once we realize that
(dy, Act: A dy;,)p = dt; Av A at,

regardless of whether {i,,..., i,} is increasing or not; (68) holds because
the same number of minus signs are needed on each side of (68) to produce
increasing rearrangements.

We turn to the proof of (c). If fis a 0-form of class @’ in V, then

Srx)=f(T@), = df= Dif My) dy;
By the chain rule, it follows that
d(fr) = 2 Dif) dx;
= 2, 2, (DfT ()(D, tI) 4x;
= Los (T(x) dt;

= (qf)r.
If dy; =dy,, A ++: A dy;,, then (dy;)7 =dt;, A ‘+: Adt,,, and Theorem
10.20 shows that
d((dy ;)r) = 9.

(This is where the assumption T € @” is used.)
Assume now that a =fdy,;. Then

Or = fr(X) (dy )r
and the preceding calculations lead to
A(z) = A fz) A @ pr = (H)r A @dr
= (df) 0 dy;)r = (da).
The first equality holds by (63) and (70), the second by (69), the third by
part (5), and the last by the definition of dw.

The general case of (c) follows from the special case just proved, if
we apply (a). This completes the proof.


--- Page 273 ---

264 PRINCIPLES OF MATHEMATICAL ANALYSIS

Our next objective is Theorem 10.25. This will follow directly from two

other important transformation properties of differential forms, which we state

first.

10.23 Theorem Suppose T is a @'-mapping of an open set E — R" into an open
set Vc R", S is a @'-mapping of V into an open set W — R?, and is a k-form
in W, so that wy is a k-form in V and both (ws)z and Wsr are k-forms in E, where
ST is defined by (ST)(x) = S(T(x)). Then

(71)

(@s)r = sr.
Proof If and / are forms in W, Theorem 10.22 shows that
((@ A A)s)r = @s A As)r = (s)z A (As) r
and
(WA A)sp = Wsz A Asp.

Thus if (71) holds for w and for A, it follows that (71) also holds for w a 2.
Since every form can be built up from 0-forms and 1-forms by addition
and multiplication, and since (71) is trivial for 0-forms, it is enough to
prove (71) in the case w =dz,,q=1, ..., p. (We denote the points of
E, V, W by x, y, Z, respectively.)

Let t;, ..., 4, be the components of 7, let s;,..., 8, be the compo-
nents of S, and let r;, ..., 7, be the components of ST. If w = dz,, then

J
so that the chain rule implies

(@s)r = » (D,5,)(T (x)) dt;

= PY (Dir) dx, = dr, = sr.
i

10.24 Theorem Suppose w is a k-form in an open set Ec R", ® is a k-surface
in E, with parameter domain D < R*, and A is the k-surface in R*, with parameter
domain D, defined by A(u) = u(ueé D). Then

Proof We need only consider the case

w = a(x) dx;, A+** A dx;,.


--- Page 274 ---

INTEGRATION OF DIFFERENTIAL FORMS 265

If ¢;, ..., @, are the components of ®, then
Wg = a(P(u)) dj, A+: A dg,,.
The theorem will follow if we can show that
(72) do; A ++: A dob, =J(u) du, A+++ A du,
where

Oiyy +4 Xi)

J(u) = Aus, «6.5%?

since (72) implies
[ o=f a@mye) du
® D
=f a@wys(u) du Ao A diy = ae.
“ A

Let [A] be the k by & matrix with entries
a(p,q)=(D,¢:,(u) (Bp, q=1,...,).

Then
do;, = 2, al, q) du,
so that
do; A+++ A di, = ¥ a1, 41) +++ (kK, 94) dig, A vt* A dug,
In this last sum, q;, ..., q, range independently over 1, ..., kK. The anti-

commutative relation (42) implies that
dug, A *°' A dg, = S(Gs, +59) My Av A dy,
where s is as in Definition 9.33; applying this definition, we see that
dp;, A+++ A db,, = det [A] du, A+++ A dy;
and since J(u) = det [A], (72) is proved.
The final result of this section combines the two preceding theorems.

10.25 Theorem Suppose T is a €’-mapping of an open set E < R" into an open
set V < R", © is a k-surface in E, and w is a k-form in V.

Then
Sra” ~ J, Or:


--- Page 275 ---

266 PRINCIPLES OF MATHEMATICAL ANALYSIS

Proof Let D be the parameter domain of ® (hence also of 7®) and
define A as in Theorem 10.24.
Then

f° = I, Ore = I. (Or) = I, Or.

The first of these equalities is Theorem 10.24, applied to T® in place of ®.
The second follows from Theorem 10.23. The third is Theorem 10.24,
with wy in place of a.

SIMPLEXES AND CHAINS

10.26 Affine simplexes A mapping f that carries a vector space X into a
vector space Y is said to be affine if f — f(0) is linear. In other words, the require-
ment is that

(73) f(x) = {(0) + Ax

for some A € L(X, Y).
An affine mapping of R* into R" is thus determined if we know f(0) and

f(e,) for 1 < i<k; as usual, {e,,..., e,} is the standard basis of R*.
We define the standard simplex Q* to be the set of all ue R* of the form
k
(74) u= )' ae;
i=1
such that «; > 0 fori=1,..., k and Za; <1.
Assume now that po, Pi, .--, Py are points of R". The oriented affine
k-simplex

is defined to be the k-surface in R” with parameter domain Q* which is given
by the affine mapping

k
(76) o(aye; + °° + a, €,) = Po + & o(Pi — Po)-
Note that o is characterized by
(77) a(0)=po, of) =p, (for! <i<h),
and that
(78) o(u)=po+Au (ue Q*)

where A € L(R*, R") and Ae; = p; — po for 1 <i<k.


--- Page 276 ---

INTEGRATION OF DIFFERENTIAL FORMS 267

We call o oriented to emphasize that the ordering of the vertices po, ..., Dx
is taken into account. If

(79) G =[Digs Piss +++» Di,ds

where {i9, i;,..., 4} is a permutation of the ordered set {0, 1, ..., k}, we adopt
the notation

(80) = S(ig hh, aeey io,

where s is the function defined in Definition 9.33. Thus ¢ = -to, depending on
whether s=1 or s= —1, Strictly speaking, having adopted (75) and (76) as
the definition of ¢, we should not write ¢ =o unless ip = 0, ..., i, =k, even
if s(ig, ..., i.) = 1; what we have here is an equivalence relation, not an equality.
However, for our purposes the notation is justified by Theorem 10.27.

If & = eo (using the above convention) and if ¢ = 1, we say that & and o
have the same orientation; if = —1, & and a are said to have opposite orienta-
tions. Note that we have not defined what we mean by the “orientation of a
simplex.” What we have defined is a relation between pairs of simplexes having
the same set of vertices, the relation being that of “having the same orientation.”’

There is, however, one situation where the orientation of a simplex can
be defined in a natural way. This happens when n =k and when the vectors
P; — Po (1 <i <k) are independent. In that case, the linear transformation A
that appears in (78) is invertible, and its determinant (which is the same as the
Jacobian of ¢) is not 0. Then a is said to be positively (or negatively) oriented if
det A is positive (or negative). In particular, the simplex [0,e,,..., e,] in R%
given by the identity mapping, has positive orientation.

So far we have assumed that k > 1. An oriented 0-simplex is defined to
be a point with a sign attached. We write ¢ = +p) or c= — po. If o = Epo
(e = +1) and if fis a 0-form (i.e., a real function), we define

[ f= (v0).

10.27 Theorem Jf is an oriented rectilinear k-simplex in an open set E< R"
and if 6 = so then

(81) fo=efo

for every k-form w in E.

Proof For k=0, (81) follows from the preceding definition. So we
assume & > 1 and assume that a is given by (75).


--- Page 277 ---

268 PRINCIPLES OF MATHEMATICAL ANALYSIS

Suppose 1 <j<k, and suppose ¢@ is obtained from o by inter-
changing py and p,. Then e= —1, and

G(u) = p; + Bu (ue O4),

where B is the linear mapping of R* into R" defined by Be; = po — p,,
Be; =p; —p, if i#j. If we write Ae; =x; (1 <i<k), where A is given
by (78), the column vectors of B (that is, the vectors Be,) are

X; — Xj,..-, Kj-1 — X, Xj, X41 — Kj, +, Xe Ky.

If we subtract the jth column from each of the others, none of the deter-
minants in (35) are affected, and we obtain columns x,,...,X;-1, —X,,
Xj+1, +++, X%- These differ from those of A only in the sign of the jth
column. Hence (81) holds for this case.

Suppose next that 0<i<j<k and that 6 is obtained from a by
interchanging p; and p;. Then G(u) = po + Cu, where C has the same
columns as A, except that the ith and jth columns have been inter-
changed. This again implies that (81) holds, since e = —1.

The general case follows, since every permutation of {0, 1, ..., k} is
a composition of the special cases we have just dealt with.

10.28 Affine chains An affine k-chain T in an open set E <R" is a collection
of finitely many oriented affine k-simplexes o,,..., ¢, in E. These need not be
distinct; a simplex may thus occur in I with a certain multiplicity.

If I is as above, and if w is a k-form in E, we define

(82) I. o= py I o.

We may view a k-surface ® in E as a function whose domain is the collec-
tion of all k-forms in E and which assigns the number { @ to w. Since real-
valued functions can be added (as in Definition 4.3), this suggests the use of the
notation

(83) T=o,+''' +0,
or, more compactly,
(84) T= Ya,

i=1

to state the fact that (82) holds for every k-form w in E.

To avoid misunderstanding, we point out explicitly that the notations
introduced by (83) and (80) have to be handled with care. The point is that
every oriented affine k-simplex o in R” is a function in two ways, with different
domains and different ranges, and that therefore two entirely different operations


--- Page 278 ---

INTEGRATION OF DIFFERENTIAL FORMS 269

of addition are possible. Originally, « was defined as an R"-valued function
with domain Q*; accordingly, o, + 0, could be interpreted to be the function
o that assigns the vector o,(u) + ,(u) to every ue Q*; note that o is then again
an oriented affine k-simplex in R"! This is not what is meant by (83).

For example, if ¢, = —o, as in (80) (that is to say, if o, and o, have the
same set of vertices but are oppositely oriented) and if [ =o, + o,, then
J, @ =0 for all w, and we may express this by writing T =0 or o, + 6, =0.
This does not mean that ¢,(u) + ¢,(u) is the null vector of R’.

10.29 Boundaries For k > 1, the boundary of the oriented affine k-simplex

o= [Po; Pi very Del
is defined to be the affine (A — 1)-chain

k
(85) do = b (—1)'Bo» +++) Py-~1) Dj+a sey Dale
j=
For example, if ¢ = [po, P1, Po], then
do = [py, P2] — [Po P2] + [Po. Pi] = [Po Pil + [P1, P2} + [P2; Pol,

which coincides with the usual notion of the oriented boundary of a triangle.
For 1 <j<k, observe that the simplex o, = [Po, ..-, Pj-15 Py+is ++ +> Pxl
which occurs in (85) has Q*~' as its parameter domain and that it is defined by

(86) o,(u)=Po+ Bu (ue Q*~*),
where B is the linear mapping from R*~! to R" determined by
Be; = p; — Po (if l<i<j-1),
Be;=Pi+1—-Po (if jsisk—1).
The simplex
Oo = (Py, Pa, +++» Pal
which also occurs in (85), is given by the mapping
oo(u) = p, + Bu,

10.30 Differentiable simplexes and chains Let T be a ¢’-mapping of an open
set E < R" into an open set V c R"; T need not be one-to-one. If @ is an oriented
affine k-simplex in E, then the composite mapping ® = T° o (which we shall
sometimes write in the simpler form Ta) is a k-surface in V, with parameter
domain Q*. We call ® an oriented k-simplex of class @”.


--- Page 279 ---

270 PRINCIPLES OF MATHEMATICAL ANALYSIS

A finite collection of oriented k-simplexes ®,,..., ®, of class ” in V
is called a k-chain of class @" in V. If w is a k-form in V, we define

r

(87) [2 = 2 i”

and use the corresponding notation ¥ = 29,.
If = Xo, is an affine chain and if ®; = To o;, we also write ¥ = ToT,
or

(88) TX o) = ¥ To;.

The boundary 6@ of the oriented k-simplex ® = T » a is defined to be the
(k — 1) chain

(89) a® = T(Go).

In justification of (89), observe that if T is affine, then ® = Too is an
oriented affine k-simplex, in which case (89) is not a matter of definition, but is
seen to be a consequence of (85). Thus (89) generalizes this special case.

It is immediate that @® is of class ¢” if this is true of ®.

Finally, we define the boundary éY¥ of the k-chain 'Y = L@, to be the
(kK — 1) chain

(90) av = ¥ 60,.

10.31 Positively oriented boundaries So far we have associated boundaries to
chains, not to subsets of R". This notion of boundary is exactly the one that is
most suitable for the statement and proof of Stokes’ theorem. However, in
applications, especially in R? or R®, it is customary and convenient to talk
about ‘“‘oriented boundaries” of certain sets as well. We shall now describe
this briefly.

Let Q" be the standard simplex in R", let o) be the identity mapping with
domain Q". As we saw in Sec. 10.26, o) may be regarded as a positively oriented
n-simplex in R”. Its boundary éo9 is an affine (m — 1)-chain. This chain is
called the positively oriented boundary of the set Q".

For example, the positively oriented boundary of Q? is

fer, €2; e3] — [0, e2, e3] + [0, C1; es] ~ [0, 1, e2].

Now let T be a 1-1 mapping of Q" into R", of class @’, whose Jacobian is
positive (at least in the interior of Q”). Let E = T(Q"). By the inverse function
theorem, E is the closure of an open subset of R". We define the positively
oriented boundary of the set E to be the (” — 1)-chain

and we may denote this (” — 1)-chain by GZ.


--- Page 280 ---

INTEGRATION OF DIFFERENTIAL FORMS 271

An obvious question occurs here: If E = 7,(Q") = T,(Q"), and if both
T, and T, have positive Jacobians, is it true that 07, = @T,? That is to say,
does the equality

[ o=f o
oT; 6T2

hold for every (x — 1)-form w? The answer is yes, but we shall omit the proof.
(To see an example, compare the end of this section with Exercise 17.)
One can go further. Let

Q=E, Uv’ VE,,

where E,; = T,(Q"), each T; has the properties that T had above, and the interiors
of the sets E; are pairwise disjoint. Then the (n — 1)-chain

is called the positively oriented boundary of Q.
For example, the unit square J? in R? is the union of o,(Q”) and o,(Q7),
where

o,(u) = u, o,(u) =e, +e, —u.
Both o, and a, have Jacobian 1 > 0. Since
0, = [0, e,, e2], a, = [e, +e, €2, e]

we have

do, = [e;, e2] — [0, e2] + [0, ex],

do, = [e2, e;] — [e; + ez, €,] + [e; + e2, €2];
The sum of these two boundaries is

aI? = [0, e,] + [e:, e: + 2] + fe; + 2, €2] + [e2, 0},

the positively oriented boundary of J”, Note that [e,, e,] canceled [e,, e,].

If ® is a 2-surface in R™, with parameter domain J’, then ® (regarded as
a function on 2-forms) is the same as the 2-chain

Moo, +@oa,,
Thus
0® = AM 0 6,) + A(®- a.)
= 0(60,) + ®(é0,) = O(4/’).
In other words, if the parameter domain of ® is the square J”, we need

not refer back to the simplex Q?, but can obtain d@ directly from a/’.
Other examples may be found in Exercises 17 to 19.


--- Page 281 ---

272 PRINCIPLES OF MATHEMATICAL ANALYSIS

10.32 Example For0<u<7,0<v < 2z, define
X(u, v) = (sin u cos v, sin u sin v, COs u).
Then = is a 2-surface in R?, whose parameter domain is a rectangle D < R’,
and whose range is the unit sphere in R*. Its boundary is
6X = LGD) = 1, + 2 + V3 + Ya
where
y,(u) = X(u, 0) = (sin w, 0, cos u),
y3(u) = X(x — u, 27) = (sin u, 0, —cos u),
with [0, 2] and [0, 27] as parameter intervals for w and v, respectively.
Since y, and y, are constant, their derivatives are 0, hence the integral of

any 1-form over y, or y, is 0. [See Example 1.12(a).]
Since y3(u) = y,(a — u), direct application of (35) shows that

[o=-fo
V3 v1

for every 1-form w. Thus J; @ = 0, and we conclude that dd = 0.

(In geographic terminology, 62 starts at the north pole N, runs to the
south pole S along a meridian, pauses at S, returns to NV along the same meridian,
and finally pauses at N. The two passages along the meridian are in opposite
directions. The corresponding two line integrals therefore cancel each other.
In Exercise 32 there is also one curve which occurs twice in the boundary, but
without cancellation.)

STOKES’ THEOREM

10.33 Theorem If ¥ is a k-chain of class $" in an open set V < R" and if w
is a (k — 1)-form of class @’ in V, then

(91) [do = a”

The case k =m = 1 is nothing but the fundamental! theorem of calculus
(with an additional differentiability assumption). The case kK = m = 2 is Green’s
theorem, and k = m= 3 gives the so-called ‘‘divergence theorem” of Gauss.
The case k = 2, m =3 is the one originally discovered by Stokes. (Spivak’s


--- Page 282 ---

INTEGRATION OF DIFFERENTIAL FORMS 273

book describes some of the historical background.) These special cases will be
discussed further at the end of the present chapter.

(92)

(93)

(94)

(95)

(96)

Proof It is enough to prove that

I, do = Jo °

for every oriented k-simplex ® of class @” in V. For if (92) is proved and
if Y = XO,, then (87) and (89) imply (91).
Fix such a ® and put
o = [0,e,,..., &].

Thus a is the oriented affine k-simplex with parameter domain Q* which
is defined by the identity mapping. Since ® is also defined on Q* (see
Definition 10.30) and ® e @”, there is an open set Ec R* which contains
O*, and there is a @’-mapping T of E into V such that D=Too. By
Theorems 10.25 and 10.22(c), the left side of (92) is equal to

[. do = I (dw) = I d(wr).

Another application of Theorem 10.25 shows, by (89), that the right side
of (92) is

{ o=f of or.
(Ta) T(ée) 6a

Since wz is a (k — 1)-form in E, we see that in order to prove (92)
we merely have to show that
fa=[
a ée

for the special simplex (93) and for every (k — 1)-form 4 of class @’ in E.
If k = 1, the definition of an oriented 0-simplex shows that (94)
merely asserts that
1
[, £@ du =F0) - £0)
for every continuously differentiable function f on [0, 1], which is true
by the fundamental theorem of calculus.

From now on we assume that k > 1, fix an integer r (1 <r <h),
and choose fe @’(£). It is then enough to prove (94) for the case

A= f(x) dx, A+++ A dx, 1 A X44 A111 A AX,

since every (k — 1)-form is a sum of these special ones, for r=1,..., k.


--- Page 283 ---

274 PRINCIPLES OF MATHEMATICAL ANALYSIS

By (85), the boundary of the simplex (93) is
Kk
do = [e,,...,&] + 9 (-L)'t;
i=1
where
T; = [0, Qe, ean Cj-1> Ci41> ry ex]
fori=1,...,k. Put

To = [€., C15 «+ +5 Opts Opts s+ +s Cyl

Note that to is obtained from [e,, ..., e,] by r — 1 successive interchanges
of e, and its left neighbors. Thus

(97) do =(—-1)""'t) + y(=1!ty.
i=1

Each 1; has Q*~! as parameter domain.
If x = to(u) and ue O*~!, then

Uu; (1 sj<r),
(98) xy = Poteet G=r),
Uj-1 (r<j<k).

If1<i<k,ue Q*"), and x = 7,(u), then

d <j<i),

(99) x;= 0 G=4),

Uj-1 (i<j<k).
For 0<i<k, let J; be the Jacobian of the mapping
(100) (Uy, oe ey Ung) > (Xq5 0005 Xpm ts Xpa ty oes Xb)

induced by t;. When i = 0 and when i = r, (98) and (99) show that (100)
is the identity mapping. Thus J) = 1, J, =1. For other i, the fact that
x; = 0 in (99) shows that J; has a row of zeros, hence J; = 0. Thus

(101) [2 =0 (40,14),
by (35) and (96). Consequently, (97) gives
(102) [2acony secur 2
=(-1'f (cow) —Az,(u)] du.


--- Page 284 ---

INTEGRATION OF DIFFERENTIAL FORMS 275

On the other hand,
dd = (D,f)(x)dx, A dx, A ++ A AX,-4 A AX 41 A A aX,
= (— 1) "(DS )(x) dy Ao A dx
so that

(103) f da =(-1)"! J PAO dx.

We evaluate (103) by first integrating with respect to x,, over the interval
[0,1 — (xp to +X M4 bo + DL

PUt (Xp, 069 Xpaa Xp ys ee ey Xe) = (Uy, «+5 Up), and see with the aid of
(98) that the integral over Q* in (103) is equal to the integral over or}
in (102). Thus (94) holds, and the proof is complete.

CLOSED FORMS AND EXACT FORMS

10.34 Definition Let w be a k-form in an open set E c R". If thereis a(k — 1)-
form A in E such that w = dd, then w is said to be exact in E.

If w is of class ¢’ and dw = 0, then w is said to be closed.

Theorem 10.20(5) shows that every exact form of class @’ is closed.

In certain sets £, for example in convex ones, the converse is true; this
is the content of Theorem 10.39 (usually known as Poincaré’s lemma) and
Theorem 10.40. However, Examples 10.36 and 10.37 will exhibit closed forms
that are not exact.

10.35 Remarks

(a) Whether a given k-form @ is or is not closed can be verified by
simply differentiating the coefficients in the standard presentation of w.
For example, a 1-form

n
(104) w= > f(x) dx;,
i=1
with f;« @(E) for some open set E < R", is closed if and only if the
equations
(105) (DJ) = (DAM)

hold for all i, jin {1,..., x} and for all xe E.


--- Page 285 ---

276 PRINCIPLES OF MATHEMATICAL ANALYSIS

Note that (105) is a ‘‘pointwise”’ condition; it does not involve any
global properties that depend on the shape of E.

On the other hand, to show that @ is exact in EZ, one has to prove
the existence of a form /, defined in E, such that dA = w. This amounts
to solving a system of partial differential equations, not just locally, but
in all of E. For example, to show that (104) is exact in a set E, one has
to find a function (or 0-form) g € @'(E) such that

(106) (D,9)(x) = f(x) (xe F,1<i<n).
Of course, (105) is a necessary condition for the solvability of (106).

(b) Let w be an exact k-form in E. Then there is a (kK — 1)-form 2 in E
with dj = @, and Stokes’ theorem asserts that

(107) { = i d= |i

for every k-chain ¥ of class @” in E.
If ¥, and ¥, are such chains, and if they have the same boundaries,

it follows that
{. w= [2

In particular, the integral of an exact k-form in E is 0 over every
k-chain in E whose boundary is 0.

As an important special case of this, note that integrals of exact
1-forms in Z are 0 over closed (differentiable) curves in E.

(c) Let w be a closed k-form in E. Then dw = 0, and Stokes’ theorem
asserts that

(108) f° = {deo =0

for every (k + 1)-chain ¥ of class @” in E.
In other words, integrals of closed k-forms in E are 0 over k-chains
that are boundaries of (k + 1)-chains in E.

(d) Let ¥ be a (kK + 1)-chain in E and let / be a (k — 1)-form in E£, both
of class @”. Since d?A = 0, two applications of Stokes’ theorem show that

(109) Low? = [a = [a =0.

We conclude that 6?” =0. In other words, the boundary of a

boundary is 0.
See Exercise 16 for a more direct proof of this.


--- Page 286 ---

INTEGRATION OF DIFFERENTIAL FORMS 277

10.36 Example Let E = R? — {0}, the plane with the origin removed. The
1-form

x dy — yax
110 =
( ) x? + y?
is closed in R? — {0}. This is easily verified by differentiation. Fix r>0, and
define

(111) yt)=(rceost,rsint) (O<t< 2z).

Then y is a curve (an “‘oriented 1-simplex”) in R? — {0}. Since (0) = »(2z),
we have

(112) dy =0.

Direct computation shows that
(113) {n=2n #0.
?

The discussion in Remarks 10.35(6) and (c) shows that we can draw two
conclusions from (113):

First, is not exact in R? — {0}, for otherwise (112) would force the integral
(113) to be 0.

Secondly, y is not the boundary of any 2-chain in R? — {0} (of class $”),
for otherwise the fact that 7 is closed would force the integral (113) to be 0.

10.37 Example Let E = R° — {0}, 3-space with the origin removed. Define

_xdyndz+ydzndx+zdx a dy

(114) 4 (x? +y? + 27)3/2

where we have written (x, y, z) in place of (x,, x2, x3). Differentiation shows
that d€ = 0, so that ¢ is a closed 2-form in R* — {0}.

Let £ be the 2-chain in R* — {0} that was constructed in Example 10.32;
recall that © is a parametrization of the unit sphere in R*. Using the rectangle
D of Example 10.32 as parameter domain, it is easy to compute that

(115) [= J) sim udu do = 4n 3 0.

As in the preceding example, we can now conclude that ¢ is not exact in
R? — {0} (since 8 = 0, as was shown in Example 10.32) and that the sphere =
is not the boundary of any 3-chain in R* — {0} (of class @”), although d = 0.
The following result will be used in the proof of Theorem 10.39.


--- Page 287 ---

278 PRINCIPLES OF MATHEMATICAL ANALYSIS

10.38 Theorem Suppose E is a convex open set in R", fe $'(E), p is an integer,
l<p<n, and
(116) (DAW=0 (p<jsn,xeE£).
Then there exists an Fe @'(E) such that
(117) (D,F\x) =f), (DF) =0  (p<jsn,xeE£).
Proof Write x = (x’, x,, x”), where
X= (4, 0-0) Xpat), X” = (Xpg ay oes Xp)
(When p=1, x’ is absent; when p=x, x” is absent.) Let V be the
set of all (x’, x,)¢R? such that (x’, x,,x")eE for some x”. Being a
projection of E, V is a convex open set in R?. Since E is convex and (116)
holds, f(x) does not depend on x”. Hence there is a function ¢, with
domain V, such that
F(X) = 9%, Xp)
for allxe E.
If p=1, V is a segment in R! (possibly unbounded). Pick ce V
and define

F(x) = f g(t)dt (xe£).
If p > 1, let U be the set of all x" R’~' such that (x’, x,) € V for
some x,. Then U is a convex open set in R?~', and there is a function

aée¢(U) such that (x’, a(x’) e V for every x’ € U; in other words, the
graph of « lies in V (Exercise 29). Define

F(x) = i) ” (x', t)dt = (x eB).
a(x’)
In either case, F satisfies (117).
(Note: Recall the usual convention that {? means — {f if b <a.)

10.39 Theorem If E < R" is convex and open, if k= 1, if w is a k-form of
class @' in E, and if dw = 0, then there is a (k — 1)-form d in E such that w = di.
Briefly, closed forms are exact in convex sets.

Proof For p=1,...,2, let Y, denote the set of all k-forms a, of class
@’ in E, whose standard presentation

(118) o= fix) dey

does not involve dx,41,..., dXx,. In other words, Jc {1,..., p}if f(x) 4 9
for some x ¢ E.


--- Page 288 ---

INTEGRATION OF DIFFERENTIAL FORMS 279

We shall proceed by induction on p.

Assume first that mae Y,. Then w=/(x)dx,. Since dw =0,
(D, f(x) = 0 for 1 <j<n,xe£. By Theorem 10.38 there is an F € @'(E)
such that D,\F = fand D,F=0 for 1<j<n. Thus

dF = (D,F)(x) dx, = f(x) dx, =o.

Now we take p > 1 and make the following induction hypothesis:
Every closed k-form that belongs to Y,_, is exact in E.
Choose we Y, so that dw = 0. By (118),

(119) PAC F(x) dx; A dx, = do = 0.

Consider a fixed j, with p<j<n. Each J that occurs in (118) lies in
{l,...,p}. If 1, J, are two of these k-indices, and if J, #J,, then the
(k + 1)-indices (J,,7), (Zz, /) are distinct. Thus there is no cancellation,
and we conclude from (119) that every coefficient in (118) satisfies

(120) (D)fox%)=0 (xe E,p<j<n).
We now gather those terms in (118) that contain dx, and rewrite w
in the form
(121) o=a+ >) f(x) dx,, A dx,,
Io
where ae Y,_,, each Jy is an increasing (k — 1)-index in {1,..., p — 1},
and I= (Jo, p). By (120), Theorem 10.38 furnishes functions F; € @'(E)
such that
Put

and define y = w — (—1)*"' dB. Since B is a (k — 1)-form, it follows that
Pp

p-1

which is clearly in Y,-,. Since d» =0 and d7B =0, we have dy = 0.
Our induction hypothesis shows therefore that y=du for some
(kK — 1)-form win E. If A= + (—1)*~'£, we conclude that w = di.

By induction, this completes the proof.


--- Page 289 ---

280 PRINCIPLES OF MATHEMATICAL ANALYSIS

10.40 Theorem Fix k,1<k<n. Let Ec R" be an open set in which every
closed k-form is exact. Let T bea 1-1 @"-mapping of E onto an open set Uc R"
whose inverse S is also of class ¢".

Then every closed k-form in U is exact in U.

Note that every convex open set E satisfies the present hypothesis, by
Theorem 10.39, The relation between & and U may be expressed by saying
that they are @"-equivalent.

Thus every closed form is exact in any set which is @"-equivalent to a convex
open set.

Proof Let w be a k-form in U, with do =0. By Theorem 10.22(c),
@, is a k-form in E for which d(w7)=0. Hence w;=d/ for some
(k — 1)-form 4 in E. By Theorem 10.23, and another application of
Theorem 10.22(c),

@ = (@7)s = (dA)s = d(As).

Since As is a (k — 1)-form in U, w is exact in U.

10.41 Remark In applications, cells (see Definition 2.17) are often more con-
venient parameter domains than simplexes. If our whole development had
been based on cells rather than simplexes, the computation that occurs in the
proof of Stokes’ theorem would be even simpler. (It is done that way in Spivak’s
book.) The reason for preferring simplexes is that the definition of the boundary
of an oriented simplex seems easier and more natural than is the case for a cell.
(See Exercise 19.) Also, the partitioning of sets into simplexes (called ‘‘triangu-
lation’) plays an important role in topology, and there are strong connections
between certain aspects of topology, on the one hand, and differential forms,
on the other. These are hinted at in Sec. 10.35. The book by Singer and Thorpe
contains a good introduction to this topic.

Since every cell can be triangulated, we may regard it as a chain. For
dimension 2, this was done in Example 10.32; for dimension 3, see Exercise 18.

Poincaré’s lemma (Theorem 10.39) can be proved in several ways. See,
for example, page 94 in Spivak’s book, or page 280 in Fleming’s. Two simple
proofs for certain special cases are indicated in Exercises 24 and 27.

VECTOR ANALYSIS

We conclude this chapter with a few applications of the preceding material to
theorems concerning vector analysis in R°. These are special cases of theorems
about differential forms, but are usually stated in different terminology. We
are thus faced with the job of translating from one language to another.


--- Page 290 ---

INTEGRATION OF DIFFERENTIAL FORMS 281

10.42 Vector fields Let F = F,e, + F,e, + F3e; be a continuous mapping of
an open set E < R® into R°®, Since F associates a vector to each point of E, F
is sometimes called a vector field, especially in physics. With every such F is
associated a 1-form

(124) Ay =F, dx + F, dy + F; dz
and a 2-form
(125) @, = F, dy a dz + F, dz a dx + Fydx A dy.

Here, and in the rest of this chapter, we use the customary notation (x, y, z)
in place of (x1, x2, X3).

It is clear, conversely, that every 1-form / in E is A, for some vector field
F in E, and that every 2-form @ is wy for some F, In R°, the study of 1-forms
and 2-forms is thus coextensive with the study of vector fields.

If we @(E) is a real function, then its gradient

Vu = (Dyuje, + (Dz, ue, + (D3 u)e;

is an example of a vector field in E.
Suppose now that F is a vector field in E, of class ¢’. Its curl V x F is the
vector field defined in E by

V x F=(D,F, ~— D;F,)e, + (D3 F, — D,F3)e, + (DF, — D2 F,)e3
and its divergence is the real function V - F defined in FE by

These quantities have various physical interpretations. We refer to the
book by O. D. Kellogg for more details.
Here are some relations between gradients, curls, and divergences.

10.43 Theorem Suppose E is an open set in R®, ue @"(E), and G is a vector
field in E, of class C".

(a) [fF =Vu, thnV x F=0.
(6) IfF=VxG, then V:F=0.

Furthermore, if E is @"-equivalent to a convex set, then (a) and (b) have
converses, in which we assume that F is a vector field in E, of class €':

(a’) IfV x F =0, then F = Vu for some ue @"(E).
(6) IfV-¥F =0, then F =V x G for some vector field G in E, of class $"

Proof If we compare the definitions of Vu, V x F, and VF with the
differential forms A, and wy, given by (124) and (125), we obtain the
following four statements:


--- Page 291 ---

282 PRINCIPLES OF MATHEMATICAL ANALYSIS

F = Vu ifand onlyif 2p = du.
VxF=0 if and only if dj, =0.

F=VxG _— ifand onlyif wy =dig.
V:F=0 if and only if dw, =0.

Now if F = Vu, then Ay = du, hence diy = d?u = 0 (Theorem 10.20),
which means that V x F=0. Thus (a) is proved.

As regards (a’), the hypothesis amounts to saying that diy = Oin E.
By Theorem 10.40, A, = du for some 0-form u. Hence F = Vu.

The proofs of (6) and (b’) follow exactly the same pattern.

10.44 Volume elements The k-form
dx, Att ta dx,

is called the volume element in R*. It is often denoted by dV (or by dV, if it
seems desirable to indicate the dimension explicitly), and the notation

(126) [fo dx, A Ady = I, fav

is used when ® is a positively oriented k-surface in R* and f is a continuous
function on the range of ©.

The reason for using this terminology is very simple: If D is a parameter
domain in R*, and if ® is a 1-1 ¢’-mapping of D into R*, with positive Jacobian
Jo, then the left side of (126) is

| F@@)e(u)du=[ f(x) dx,
D @(D)

by (35) and Theorem 10.9.

In particular, when f= 1, (126) defines the volume of ®. We already saw
a special case of this in (36).
The usual notation for dV, is dA.

10.45 Green’s theorem Suppose E is an open set in R*, 2€ @'(E), BE @'(E);
and Q is a closed subset of E, with positively oriented boundary 0Q, as described
in Sec. 10.31. Then

8B Ou

(127) [.@ dx + B dy) = I, (F - | dA.


--- Page 292 ---

INTEGRATION OF DIFFERENTIAL FORMS 283

Proof PutA=adx+ Ady. Then
di = (Da) dy a dx + (D,B) dx a dy
= (DB — D2«) dA,
and (127) is the same as
A=| di,
Sin J,

which is true by Theorem 10.33.
With a(x, y) = —y and B(x, y) = x, (127) becomes
(128) s[ @dy—ydr) = AQ),
an

the area of Q.
With « = 0, B = x, a similar formula is obtained. Example 10.12(b) con-
tains a special case of this.

10.46 Area elements in R° Let ® be a 2-surface in R’°, of class @’, with pa-
rameter domain D c R?. Associate with each point (u, v) € D the vector

ay, z) a(z, x) ax, y)
a(u, v) 1 + O(u, v) * (u, v) *s-

The Jacobians in (129) correspond to the equation
(130) (x, y, z) = Oty, v).

If f is a continuous function on ®(D), the area integral of f over ® is
defined to be

(131) I, fdA= [ F(®(u, v)|N(u, v)| du do.

(129) N(u, v) =

In particular, when f= 1 we obtain the area of ®, namely,
(132) A(®) = i) [N(u, v)| du dv.
D

The following discussion will show that (131) and its special case (132)
are reasonable definitions. It will also describe the geometric features of the
vector N.

Write © = g,e; + G2e, + 93e3, fix a point po=(up, v)ED, put
N =N(Po), put

(133) a; =(Di9)@o), 8: =(D29)Po) (i=1, 2, 3)


--- Page 293 ---

284 PRINCIPLES OF MATHEMATICAL ANALYSIS

and let T € L(R?, R*) be the linear transformation given by

(134) T(u, v) = Sew + B,v)e;.

Note that T = ©’(pg), in accordance with Definition 9.11.

Let us now assume that the rank of Tis 2. (If it is 1 or 0, then N = 0, and
the tangent plane mentioned below degenerates to a line or to a point.) The
range of the affine mapping

(u, v) + (Po) + T(u, »)

is then a plane I], called the tangent plane to ® at po. [One would like to call
TI the tangent plane at ®(p,), rather than at py ; if ® is not one-to-one, this runs
into difficulties. ]

If we use (133) in (129), we obtain

(135) N = (a B3 — %3 Bae; + (3B, — 1B 3)e2 + (@B2 — &2 B,)es,
and (134) shows that

3 3
t=1 i=1

A straightforward computation now leads to

(137) N:(Te,;) =0=N°: (Te,).

Hence N is perpendicular to IT. It is therefore called the normal to ® at po.
A second property of N, also verified by a direct computation based on

(135) and (136), is that the determinant of the linear transformation of R® that
takes {e,, e,, e3} to {Te,, Te,, N} is |N|{? > 0 (Exercise 30). The 3-simplex

(138) [0, Te,, Te, , N]

is thus positively oriented.

The third property of N that we shall use is a consequence of the first two:
The above-mentioned determinant, whose value is |N|?, is the volume of the
parallelepiped with edges [0, Te,], [0, Te,], [0, N]. By (137), [0, N] is perpen-
dicular to the other two edges. The area of the parallelogram with vertices

(139) 0, Te,, Te,, T(e, + 2)

is therefore |N|.

This parallelogram is the image under T of the unit square in R?. If E
is any rectangle in R?, it follows (by the linearity of 7) that the area of the
parallelogram T(£) is

(140) A(T(E)) = |N| ACE) = [| Nto, ¥o)| di


--- Page 294 ---

INTEGRATION OF DIFFERENTIAL FORMS 285

We conclude that (132) is correct when © is affine. To justify the definition
(132) in the general case, divide D into small rectangles, pick a point (ug, v9)
in each, and replace ® in each rectangle by the corresponding tangent plane.
The sum of the areas of the resulting parallelograms, obtained via (140), is then
an approximation to A(®). Finally, one can justify (131) from (132) by approxi-
mating f by step functions.

10.47 Example Let 0<a<b be fixed. Let K be the 3-cell determined by
O<t<a, O<u<2z, O<sv<2n.
The equations

x =tcosu
(141) y =(b + tsin u) cos v
z=(b4+ tsinu)sinv

describe a mapping V of R® into R? which is 1-1 in the interior of K, such that
Y(K) is a solid torus. Its Jacobian is

_ O(x, y, Z)

y= a(t, u, 0) =(6+ ¢tsinu)

which is positive on K, except on the face r= 0. If we integrate Jy over K, we
obtain

vol (Y(K)) = 277a7b

as the volume of our solid torus.

Now consider the 2-chain ® = OY. (See Exercise 19.) ‘¥ maps the faces
u = QO and u = 2z of K onto the same cylindrical strip, but with opposite orienta-
tions. ‘Y maps the faces v = 0 and v = 2x onto the same circular disc, but with
opposite orientations. ‘Y maps the face t = 0 onto a circle, which contributes 0
to the 2-chain OW. (The relevant Jacobians are 0.) Thus ® is simply the 2-surface
obtained by setting t = a in (141), with parameter domain D the square defined
by 0<u<22,0<v<2zn.

According to (129) and (141), the normal to ® at (u, v)¢ D is thus the
vector

N(u, v) = a(b + a sin u)n(u, v)
where

n(u, v) = (cos u)e, + (sin u cos v)e, + (sin uw sin ve; .


--- Page 295 ---

286 PRINCIPLES OF MATHEMATICAL ANALYSIS

Since |n(u, v)| = 1, we have |N(u, v)| = a(b + asin u), and if we integrate this
over D, (131) gives

A(®) = 472ab

as the surface area of our torus.

If we think of N= N(u,v) as a directed line segment, pointing from
P(u, v) to Ou, v) + N(u, v), then N points outward, that is to say, away from
V(K). This is so because Jy > 0 when r= a.

For example, take u = v = 1/2, t= a. This gives the largest value of z on
‘P(K), and N = a(b + a)e; points ‘‘upward”’ for this choice of (u, v).

10.48 Integrals of 1-forms in R® Let y be a @’-curve in an open set Ec R?,
with parameter interval [0, 1], let F be a vector field in E, as in Sec. 10.42, and
define A, by (124). The integral of A, over y can be rewritten in a certain way
which we now describe.

For any ue [0, 1},

yu) = vier + y2(Wez + y3(Wes

is called the tangent vector to y at u. We define t = t(u) to be the unit vector in
the direction of y’(u). Thus

y'(u) = | y(u)| tu).

[If y’(u) = 0 for some u, put t(v) = e,; any other choice would do just as well.]
By (35),

3 1
fae=d f FO@)i@ du
y i=1°0
1
(142) = J FOW) «1 du
1
= J FO) ta) |y'@)| du.

Theorem 6.27 makes it reasonable to call | y’(u)| du the element of arc
length along y. A customary notation for it is ds, and (142) is rewritten in the
form

143 Ap= | (F°t) ds.
(143) [a= [@-o

Since t is a unit tangent vector to y, F + t is called the tangential component
of F along .


--- Page 296 ---

INTEGRATION OF DIFFERENTIAL FORMS 287

The right side of (143) should be regarded as just an abbreviation for the
last integral in (142). The point is that F is defined on the range of y, but t is
defined on [0, 1]; thus F : t has to be properly interpreted. Of course, when y
is one-to-one, then t(uv) can be replaced by t(y(u)), and this difficulty disappears.

10.49 Integrals of 2-forms in R? Let ® be a 2-surface in an open set Ec R’,
of class ¢’, with parameter domain D < R?. Let F be a vector field in £, and
define wy by (125). As in the preceding section, we shall obtain a different
representation of the integral of wy over ®.

By (35) and (129),

[ or=f (F, dy a dz + F, dz a dx + F; dx a dy)
® ®

_ ay, Z) o(z, x) a(x, y)
= i (f Ose t Fe O57 + (Fe ®) 57 I du dv

= i) F(®(u, v)) - N(u, v) du do.
D
Now let n=n(u, v) be the unit vector in the direction of N(u, v). [If
N(u, v) = 0 for some (u, v) € D, take n(u, v) = e,.] Then N = |N|n, and there-
fore the last integral becomes
) F(@(u, v)) - n(u, v)| N(u, v)| du dv.
D
By (131), we can finally write this in the form
144 @y=| (Fen) dA.
(144) [or= [em
With regard to the meaning of F+n, the remark made at the end of Sec. 10.48

applies here as well.
We can now state the original form of Stokes’ theorem.

10.50 Stokes’ formula Jf F is a vector field of class @' in an open set Ec R°,
and if ® is a 2-surface of class @" in E, then

(145) [Wx -na4=f (F « t) ds.
® oD

Proof Put H=V x F. Then, as in the proof of Theorem 10.43, we have


--- Page 297 ---

288 PRINCIPLES OF MATHEMATICAL ANALYSIS

Hence
[7 x F):ndd= [a9 dA = [jon

= ja ~ Js?" ~ Jo "Ods.

Here we used the definition of H, then (144) with H in place of F,
then (146), then—the main step—Theorem 10.33, and finally (143),
extended in the obvious way from curves to 1-chains.

10.51 The divergence theorem Jf F is a vector field of class G’ in an open set
Ec R’°, and if Q is a closed subset of E with positively oriented boundary 0Q
(as described in Sec. 10.31) then

(147) [7 ‘F)dV = ff +n) dA.

Proof By (125),
doy = (VF) dx Ady A dz=(V'F) dv.
Hence

[,@-Pav=[ dop=| or=] mad,

by Theorem 10.33, applied to the 2-form w,, and (144).

EXERCISES

1. Let H be a compact convex set in R*, with nonempty interior. Let fe @(H), put
f(x) = 0 in the complement of H, and define {fas in Definition 10.3.
Prove that J f is independent of the order in which the & integrations are

carried out.
Hint: Approximate f by functions that are continuous on R* and whose

supports are in H, as was done in Example 10.4.
2. For i= 1, 2,3,..., let »: € G(R’) have support in (2~', 2?~'), such that for= 1.
Put
f(x,y) = [pi(x) — o +(x) p(y)

Then f has compact support in R?, f is continuous except at (0, 0), and
far [rey ax =0 but [ae free, ») dy = 1.

Observe that f is unbounded in every neighborhood of (0, 0).


--- Page 298 ---

3.

INTEGRATION OF DIFFERENTIAL FORMS 289

(a) If F is as in Theorem 10.7, put A = F’(0), Fi(x) = A~‘F(x). Then Fi(0) = J.
Show that

F,(x) = Ge Gi-1 orto G,(x)

in some neighborhood of 0, for certain primitive mappings G,,...,G,. This
gives another version of Theorem 10.7:

F(x) = F'(0)G, © G,-10 +++ © G(x).

(6) Prove that the mapping (x, y) > (y, x) of R? onto R? is not the composition
of any two primitive mappings, in any neighborhood of the origin. (This shows
that the flips B, cannot be omitted from the statement of Theorem 10.7.)

For (x, y) € R?, define

F(x, y) = (e* cos y — 1, e* sin y).
Prove that F = G, o G,, where
Gi(x, y) = (e* cos y — 1, y)
G.(u, v) = (u, (1 + #) tan v)

are primitive in some neighborhood of (0, 0).
Compute the Jacobians of G,, G2, F at (0,0). Define

H,(x, y) = (x, e* sin y)
and find
Hitu, v) = (AG, v), v)

so that F = H, o Hz is some neighborhood of (0, 0).

. Formulate and prove an analogue of Theorem 10.8, in which K is a compact

subset of an arbitrary metric space. (Replace the functions ¢; that occur in the
proof of Theorem 10.8 by functions of the type constructed in Exercise 22 of
Chap. 4.)

. Strengthen the conclusion of Theorem 10.8 by showing that the functions ys, can

be made differentiable, and even infinitely differentiable. (Use Exercise 1 of
Chap. 8 in the construction of the auxiliary functions ¢;.)

. (a) Show that the simplex Q* is the smallest convex subset of R* that contains

0, 1, ..., &.
(6) Show that affine mappings take convex sets to convex sets.

. Let H be the parallelogram in R? whose vertices are (1, 1), (3, 2), (4, 5), (2, 4).

Find the affine map T which sends (0, 0) to (1, 1), (1, 0) to (3, 2), (0, 1) to (2, 4).
Show that Jz = 5. Use T to convert the integral

a= fer dx dy

to an integral over J? and thus compute «.


--- Page 299 ---

290 PRINCIPLES OF MATHEMATICAL ANALYSIS

9. Define (x, y) = T(r, 6) on the rectangle

10.

11.

12,

O<r<a 0<6<20
by the equations
x=rcos6é, y=rsiné.
Show that J maps this rectangle onto the closed disc D with center at (0, 0) and

radius a, that T is one-to-one in the interior of the rectangle, and that Jr(r, 6) = r.
If f € @(D), prove the formula for integration in polar coordinates:

f _ flee, 9) di dy = f : i_ ACT(r, 8))r dr dd.

Hint: Let Do be the interior of D, minus the interval from (0, 0) to (0, a).
As it stands, Theorem 10.9 applies to continuous functions f whose support lies in
Do. To remove this restriction, proceed as in Example 10.4.
Let a> in Exercise 9 and prove that

) f(y) de dy = f /, f - fCT(r, 9))r dr dO,

for continuous functions f that decrease sufficiently rapidly as|x| + |y| > 2.
(Find a more precise formulation.) Apply this to

f(x, ¥) = exp (—x? — y?)
to derive formula (101) of Chap. 8.
Define (u, v) = T(s, t) on the strip

0O<s<o, 0<t<1

by setting u = s — st, v= st. Show that T is a 1-1 mapping of the strip onto the
positive quadrant Q in R?. Show that Jr(s, t)=s.
For x > 0, y > 0, integrate
u®—le-"yy-1e-7"
over Q, use Theorem 10.9 to convert the integral to one over the strip, and derive
formula (96) of Chap. 8 in this way.
(For this application, Theorem 10.9 has to be extended so as to cover certain
improper integrals. Provide this extension.)
Let J* be the set of all u= (a1, ..., &) € R* with 0 <u, <1 for all i; let Q* be the
set of all x =(x1,...,%,) € R* with x, >0,2x,<1. (/* is the unit cube; Q* is
the standard simplex in R‘.) Define x = T(u) by
Xi— ly
x2>= ad _ Us)u2

cmc c erro ese tara severestenese

xa = (i — U1) eed — Uy—1)Uy.


--- Page 300 ---

13.

14.
15.

16.

17.

18

INTEGRATION OF DIFFERENTIAL FORMS 291

Show that
k 1 k 1
Show that T maps I* onto Q*, that T is 1-1 in the interior of J‘, and that its
inverse S is defined in the interior of Q* by wu, = x, and

x;

4, =>.
l—x- tt Xo

for i=2,...,k. Show that
Jr(w) = (1 — ur) 1 — a) 7 te),
and
Js(x) = [1 — x1)(1 — x1 — x2) 00° (1 — ty — xe).
Let r1,..., 7, be nonnegative integers, and prove that

rilesrry!

k+nitetr)!

Hint: Use Exercise 12, Theorems 10.9 and 8.20.

Note that the special case r: = *** =r, =0 shows that the volume of Q*
is 1/k!.
Prove formula (46).
If w and 4 are k- and m-forms, respectively, prove that

f xe xk dx=
qk

wANA=(—1)”A Aw.

If k >2ando = [po, pi, ..., Px] is an oriented affine k-simplex, prove that 70 = 0,
directly from the definition of the boundary operator @. Deduce from this that
o?" = 0 for every chain ¥.

Hint: For orientation, do it first for k = 2, k = 3. In general, if i<j, let o.;
be the (k — 2)-simplex obtained by deleting p; and p, from ¢. Show that each a1,
occurs twice in 67o, with opposite sign.

Put J? = 7, + 72, where

71=[0,e1,,e:+e2], 72=—[0,e2.,e2 +e].

Explain why it is reasonable to call J? the positively oriented unit square in R?.
Show that @J? is the sum of 4 oriented affine 1-simplexes. Find these. What is
Ar, — 72)?

Consider the oriented affine 3-simplex

o, = (0, e1,e: + e2,e: + e2+ es]

in R*. Show that o, (regarded as a linear transformation) has determinant 1.
Thus o; is positively oriented.


--- Page 301 ---

292 PRINCIPLES OF MATHEMATICAL ANALYSIS

19.

Let o2,...,06 be five other oriented 3-simplexes, obtained as follows:
There are five permutations (i1, 2, is) of (1, 2, 3), distinct from (1, 2, 3). Associate
with each (1, i2, is) the simplex

sii, iz, is)[0, Cry, Cry + Cra, Cay + Cn + e153]

where s is the sign that occurs in the definition of the determinant. (This is how 72
was obtained from 7, in Exercise 17.)

Show that o2,..., o¢ are positively oriented.

Put J? = 0, +++++ 0.6. Then J? may be called the positively oriented unit
cube in R?,

Show that 2/3 is the sum of 12 oriented affine 2-simplexes. (These 12 tri-
angles cover the surface of the unit cube J+.)

Show that x = (141, ¥2, Xs) is in the range of o; if and only if O<x+3<-x2
<m<l.

Show that the ranges of o1,..., 06 have disjoint interiors, and that their
union covers 7*, (Compare with Exercise 13; note that 3! = 6.)
Let J? and J* be as in Exercise 17 and 18. Define

Boi(u, v) = (0, 4, v), B,.(u, v) = (1, u, v),
Bo2(u, v) = (u, 0, v), — Bra(u, v) = (u, 1, v),
Bos(u, v) = (4, vy, 0), Bislu, v) = (uy, v, 1).

These are affine, and map R? into R°.
Put £,.= B,(J?), for r=0,1,i=1,2,3. Each §,, is an affine-oriented
2-chain. (See Sec. 10.30.) Verify that
3
ay = 2 (- 1)'(Bor _ Bia);

in agreement with Exercise 18.

. State conditions under which the formula

[fae = [fe- [a Aw

is valid, and show that it generalizes the formula for integration by parts.
Hint: d( fw) = (df) \w+fdu.,

. As in Example 10.36, consider the 1-form

xdy—ydx
1= aye
in R? — {0}.
(a) Carry out the computation that leads to formula (113), and prove that dy = 0.

(b) Let y(t) = (r cos t, r sin t), for some r > 0, and let T be a @’-curve in R? — {0},


--- Page 302 ---

INTEGRATION OF DIFFERENTIAL FORMS 293

with parameter interval [0, 27], with T'(0)=T'(27), such that the intervals [y(t),
T(t)] do not contain 0 for any ¢ € [0, 277]. Prove that

[a = 27,

Hint: For 0 <t<27,0<u <1, define
O(1, uy) = (1 — w) T(t) + y(t).

Then © is a 2-surface in R* — {0} whose parameter domain is the indicated rect-
angle. Because of cancellations (as in Example 10.32),

emo =T_—y,

Use Stokes’ theorem to deduce that

a= Ja

because dy = 0.

(c) Take I'(t)=(acost,bsint) where a>0,b>O0 are fixed. Use part (6) to
show that

"= t=?
[ a? cos? t+ b* sin? 1 ~ *™

(d) Show that

= y
= a(are tan *)

in any convex open set in which x 40, and that
x
= d|-— arc tan *)
n= d(— arctan?
in any convex open set in which y 40.

Explain why this justifies the notation 7 = d@, in spite of the fact that 7 is
not exact in R? — {0}.

(e) Show that (6) can be derived from (d).
(f) If Tis any closed @’-curve in R? — {0}, prove that

1
= i) n= Ind(1).
T

(See Exercise 23 of Chap. 8 for the definition of the index of a curve.)


--- Page 303 ---

294 PRINCIPLES OF MATHEMATICAL ANALYSIS

22. As in Example 10.37, define ¢ in R* — {0} by
_ Xd Adz+ydz\dx+zdx \ dy

r3

4
where r = (x? + y? + z?)'/?, let D be the rectangle given by 0 <u <7,0<v <2z,
and let = be the 2-surface in R*, with parameter domain D, given by

xX = sin u COS 2, y = sin usin v, Z=COS UH.

(a) Prove that df = 0 in R*® — {0}.

(b) Let S denote the restriction of £ to a parameter domain E¢ D. Prove that
f c= | sin u du dv = A(S),
s E
where A denotes area, as in Sec. 10.43. Note that this contains (115) as a special

case,

(c) Suppose g, fi, h2, hs, are @’-functions on [0, 1], g >0. Let (x, y, z) = Of, t)
define a 2-surface ®, with parameter domain J?, by

x=g(thils), y=ag(t)A.ls), z= 9(t)hs(s).

Prove that

[s=0

directly from (35).
Note the shape of the range of ®: For fixed s, (s, t) runs over an interval
on a line through 0. The range of ® thus lies in a “‘cone”’ with vertex at the origin.

(d) Let E be a closed rectangle in D, with edges parallel to those of D. Suppose
Se@'(D),f>0. Let 2 be the 2-surface with parameter domain E, defined by

Qu, v) = fu, v) X (y, v).
Define S as in (6) and prove that

[t=[t=a9.

(Since S is the “radial projection” of Q into the unit sphere, this result makes it
reasonable to call [ag the “solid angle” subtended by the range of © at the origin.)
Hint: Consider the 3-surface ‘ given by

W(t, u,v) = [1 —t+ fu, 1) 2, »),
where (u, v) ¢ E,O<+<1. For fixed v, the mapping (¢, v) > ‘Y(t, u, v) is a 2-sur-


--- Page 304 ---

INTEGRATION OF DIFFERENTIAL FORMS 295

face ® to which (c) can be applied to show that [o¢=0. The same thing holds
when u is fixed. By (a) and Stokes’ theorem,

[= [a=

(e) Put A= — (z/r)n, where
_ xdy—ydx
— x? as y?
as in Exercise 21. Then A is a 1-form in the open set V < R? in which x? + y? > 0,
Show that { is exact in V by showing that
C=.

(f) Derive (d) from (e), without using (c).
Hint: To begin with, assume 0 <u <7 on E. By (e),

[c=fa and [t=[

Show that the two integrals of A are equal, by using part (d) of Exercise 21, and by
noting that z/r is the same at X(u, v) as at Q(u, v).

(g) Is £ exact in the complement of every line through the origin?
. Fix n. Define ry = (x? + +++ + x2)? for 1 <k <n, let E, be the set of all x e€ R’
at which r, > 0, and let w, be the (k — 1)-form defined in E, by

k
= (r“* 2 (—1)fo xr dx Ave A dxi-1 A aXi41 Acts A xx.

Note that w2 = 7, w; = ¢, in the terminology of Exercises 21 and 22. Note
also that
E, © E, c++: CE, = R"— {0}.

(a) Prove that dw, = 0 in Ey.
(6) For k =2,...,”, prove that w, is exact in E,-1, by showing that

OL = (fe, -1) = (df) A We-15
where f(x) = (—1)* gx(xi/rx) and

att)= [ (1—s2)#-9/2ds (-1 <2 <1).
-1

Hint: f, satisfies the differential equations

x + (VA)(x) = 0

(— 1)ra-1)*7+
(r,)* ,

and
(Di fix) =


--- Page 305 ---

296 PRINCIPLES OF MATHEMATICAL ANALYSIS

(c) Is w, exact in E,?
(d) Note that (6) is a generalization of part (e) of Exercise 22. Try to extend some
of the other assertions of Exercises 21 and 22 to w,, for arbitrary x.

24, Let w =Za,(x) dx, be a 1-form of class @” in a convex open set E< R". Assume
dw = 0 and prove that w is exact in E, by completing the following outline:
Fix pe E. Define

fo = | w  (xéE).
(p.x]

Apply Stokes’ theorem to affine-oriented 2-simplexes [p, x, y] in E. Deduce that
n 1
FO) ~ $00 = YOr~ x0 f ald ~ Ox + ty) dt

for x ¢ E,y € E. Hence (D.f)(x) = a.(x).
25. Assume that w is a 1-form in an open set E < R" such that

[e=o

for every closed curve y in E, of class @’. Prove that w is exact in E, by imitating
part of the argument sketched in Exercise 24.
26. Assume w is a 1-form in R? — {0}, of class @’ and dw =0. Prove that w is exact in
R* — {0}.
Hint: Every closed continuously differentiable curve in R* — {0} is the
boundary of a 2-surface in R* — {0}. Apply Stokes’ theorem and Exercise 25.

27. Let E be an open 3-cell in R*, with edges parallel to the coordinate axes. Suppose
(a, b, c) € E, fe @(E) for i=1, 2, 3,

w=fidy \dz+f2dz \dx+fsdx A dy,
and assume that dw = 0 in E. Define
A=g,dx+g,dy

where

aie 2)= f Aleys)ds— [fest 0) at

G2(x, Vs Zy= —f filx, ys s) ds,

for (x, y, z) € E. Prove that dA = w in E.
Evaluate these integrals when w = ¢ and thus find the form A that occurs in

part (e) of Exercise 22.


--- Page 306 ---

28.

29,

30.

31,

INTEGRATION OF DIFFERENTIAL FORMS 297

Fix b > a >0, define
D(r, 9) = (r cos 4, rsin 4)

fora<r<b,0<8< 2m. (The range of ® is an annulus in R?.) Put w = x? dy,
and compute both

[ ae and fo
Oo oo

to verify that they are equal.

Prove the existence of a function « with the properties needed in the proof of
Theorem 10.38, and prove that the resulting function F is of class ¢’. (Both
assertions become trivial if E is an open cell or an open ball, since « can then be
taken to be a constant. Refer to Theorem 9.42.)

If N is the vector given by (135), prove that

a Bi a2B3 - a3B2
det a2 B2 asp —~ aBs = |N|?.
a3 3 oP 2 _ a2P1
Also, verify Eq. (137).
Let Ec R* be open, suppose g € @’(E), h € @’(E), and consider the vector field
F=g9VA.
(a) Prove that
V+ F=gV7h + (Vg): (VA)
where V2h = V - (Vh) = 267h/0x? is the so-called “Laplacian” of A.
(6) If Q is a closed subset of E with positively oriented boundary 2 (as in
Theorem 10.51), prove that

ft V+ )- (vaya = f ey
lg 9 oan

where (as is customary) we have written 04/én in place of (VA): n. (Thus @h/én
is the directional derivative of 4 in the direction of the outward normal to @Q, the
so-called normal derivative of h.) Interchange g and fA, subtract the resulting
formula from the first one, to obtain

oh dg
2 2 = — k}—
[ov A nVeg)aV= | (oz i) dA,

These two formulas are usually called Green’s identities.
(c) Assume that A is harmonic in E; this means that V?h = 0. Take g = 1 and con-
clude that

f2)
oh 44 =0,
on On


--- Page 307 ---

298 PRINCIPLES OF MATHEMATICAL ANALYSIS

32.

Take g = A, and conclude that 4 = 0 in 0 if A=0 on @Q.
(d) Show that Green’s identities are also valid in R?.

Fix 6,0 <8 <1. Let D be the set of all (0, t) € R? such thatO0 <8 <7, —8<1r<8,
Let ® be the 2-surface in R*, with parameter domain D, given by

x =(1—tsin 6) cos 26
y =(1—tsin 9) sin 26
z=tcos@

where (x, y, z) = 0(6, t). Note that ®(7, r) = ®(0, —1), and that ® is one-to-one
on the rest of D.

The range M = ®(D) of ® is known as a Mdbius band. It is the simplest
example of a nonorientable surface.

Prove the various assertions made in the following description: Put
p: = (0, —8), p2 = (7, —8), ps = (a, 5), pa = ©, 8), ps = Pi. Put ys = [ps, pros],
i=1,...,4,and put l,=@oy,. Then

éo=7T,4T,4+T3+4T,.
Put a = (1, 0, —8), b= (1, 0, 8). Then
Op.) = O(ps)=a, O(p2)= P(p.) =b,

and @® can be described as follows.

T, spirals up from a to b; its projection into the (x, y)-plane has winding
number +1 around the origin. (See Exercise 23, Chap. 8.)

T, = [b, a].

Ps spirals up from a to b; its projection into the (x, y) plane has winding

number —1 around the origin.
y= [b, a].
Thus 60 =1T,+T3+4 27P,.
If we go from a to b along I, and continue along the ‘‘edge” of M until we

return to a, the curve traced out is
T = T 17 T; ’
which may also be represented on the parameter interval [0, 277] by the equations

x = (1+ 5 sin #) cos 20
y=(i + 8 sin 9) sin 26
z=—6dcos 6,

It should be emphasized that I. 40: Let » be the 1-form discussed in
Exercises 21 and 22. Since dy = 0, Stokes’ theorem shows that

i) 7= 0.
oD


--- Page 308 ---

INTEGRATION OF DIFFERENTIAL FORMS 299

But although T is the “geometric” boundary of M, we have

[an = 4,

In order to avoid this possible source of confusion, Stokes’ formula (Theorem
10.50) is frequently stated only for orientable surfaces ®.


--- Page 309 ---

1]

THE LEBESGUE THEORY

It is the purpose of this chapter to present the fundamental concepts of the
Lebesgue theory of measure and integration and to prove some of the crucial
theorems in a rather general setting, without obscuring the main lines of the
development by a mass of comparatively trivial detail. Therefore proofs are
only sketched in some cases, and some of the easier propositions are stated
without proof. However, the reader who has become familiar with the tech-
niques used in the preceding chapters will certainly find no difficulty in supply-
ing the missing steps.

The theory of the Lebesgue integral can be developed in several distinct
ways. Only one of these methods will be discussed here. For alternative
procedures we refer to the more specialized treatises on integration listed in
the Bibliography.

SET FUNCTIONS

If A and B are any two sets, we write A — B for the set of all elements x such
that x € A, x¢B. The notation A — B does not imply that Bc A. We denote
the empty set by 0, and say that A and B are disjoint if An B=0.


--- Page 310 ---

THE LEBESGUE THEORY 301

11.1 Definition A family & of sets is called a ring if A € & and Be & implies
(1) AUBEA, A-Be&.

Since 4 (1 B= A —(A — B), we also have An Be if Bis a ring.
A ring @ is called a o-ring if

(2) (J4,ER
n=1
whenever A, € & (n = 1, 2, 3,...). Since

we also have

if @ is a o-ring.

11.2 Definition We say that ¢ is a set function defined on & if ¢ assigns to
every A € #a number ¢(A) of the extended real number system. ¢@ is additive
if Ac B =0 implies

(3) p(A U B) = $(A) + (8),
and @ is countably additive if A; 0 A; =0 (i 4 /) implies
(4) 6 (U.4,) =¥ oy.

n=1 n=1

We shall always assume that the range of @ does not contain both +00
and — oo; for if it did, the right side of (3) could become meaningless. Also,
we exclude set functions whose only value is +00 or — 00.

It is interesting to note that the left side of (4) is independent of the order
in which the A,’s are arranged. Hence the rearrangement theorem shows that
the right side of (4) converges absolutely if it converges at all; if it does not
converge, the partial sums tend to +00, or to — oa,

If ¢ is additive, the following properties are easily verified:

(5) (0) = 0.
(6) (A, +++ UA,) = (Ay) $0 + GLA,
if A, A A, =0 whenever i # /.


--- Page 311 ---

302 PRINCIPLES OF MATHEMATICAL ANALYSIS

(7) P(A, U Az) + P(A, 9 Az) = G(Ay) + G(A2).
If (A) = 0 for all A, and A, ¢ A;, then
(8) $(A;) S $(A2).

Because of (8), nonnegative additive set functions are often called
monotonic.

(9) $(A — B) = $(A) — $(B)
if Bc A, and |(@B)| < + ©.

11.3. Theorem Suppose ¢ is countably additive on a ring @. Suppose A, € B
(n = 1, 2, 3,...), Ay © Az CAG, AES, and

A=

C8

A,.
1

Then, asn— co,
$(A,) > P(A).
Proof Put B, = A,, and
B, = Aq — An-1 (n = 2, 3,...).
Then B; 0B; =0 fori #/, A, = By U'': U B,, and A = UB,. Hence

4.) = ¥ 6B)
and

H(A) = ¥ 4B).

CONSTRUCTION OF THE LEBESGUE MEASURE

11.4 Definition Let R’ denote p-dimensional euclidean space. By an interval
in R? we mean the set of points x = (x,,..., x,) such that

or the set of points which is characterized by (10) with any or all of the <
signs replaced by <. The possibility that a; = b; for any value of 7 is not ruled
out; in particular, the empty set is included among the intervals.


--- Page 312 ---

THE LEBESGUE THEORY 303

If A is the union of a finite number of intervals, A is said to be an elemen-
tary set.
If J is an interval, we define

m() = 1] 6, ~ a9,

no matter whether equality is included or excluded in any of the inequalities (10).
If 4=J, U-:: UJ, and if these intervals are pairwise disjoint, we set
(11) m(A) = m(,) + ++ + m(,)-
We let & denote the family of all elementary subsets of R’.
At this point, the following properties should be verified:
(12) @is aring, but not a o-ring.
(13) If Ae @, then A is the union of a finite number of disjoint intervals.
(14) If Ae &, m(A) is well defined by (11); that is, if two different decompo-
sitions of A into disjoint intervals are used, each gives rise to the same

value of m(A).
(15) m is additive on @.

Note that if p = 1, 2,3, then m is length, area, and volume, respectively.

11.5 Definition A nonnegative additive set function ¢ defined on @ is said to
be regular if the following is true: To every Ae & and to every ¢ > 0 there
exist sets Fe &, Ge & such that F is closed, G is open, F c A <G, and

(16) $(G) — 8 < $(A) < P(F) +8.

11.6 Examples

(a) The set function m is regular.
If A is an interval, it is trivial that the requirements of Definition
11.5 are satisfied. The general case follows from (13).
(b) Take R?=R', and let « be a monotonically increasing func-
tion, defined for all real x. Put
H([a, b)) = «(b—) — a(a—),
u(la, Bl) = (6+) - a(a-),
u((a, b]) = a(b +) — a(a+),
u((a, b)) = a(b—) ~ a(a+),

Here [a, 5) is the set a<x <b, etc. Because of the possible discon-
tinuities of a, these cases have to be distinguished. If p is defined for


--- Page 313 ---

304 PRINCIPLES OF MATHEMATICAL ANALYSIS

elementary sets as in (11), w is regular on &. The proof is just like that
of (a).

Our next objective is to show that every regular set function on & can be
extended to a countably additive set function on a o-ring which contains &.

11.7 Definition Let yu be additive, regular, nonnegative, and finite on &.
Consider countable coverings of any set E c R? by open elementary sets A,:

Ec v A,.
n=1
Define
(17) uN) = inf ¥ w(4,),

the inf being taken over all countable coverings of E by open elementary sets.
u*(E) is called the outer measure of E, corresponding to yp.
It is clear that u*(Z) = 0 for all E and that

(18) u*(Ey) Ss w*(E2)

11.8 Theorem
(a) For every A €€, p*(A) = pA).
(b) IfE=UE,, then
1

(19) H*(E) < ye).

Note that (a) asserts that u* is an extension of u from & to the family of
all subsets of R?. The property (19) is called subadditivity.

Proof Choose A €& and ¢ > 0.

The regularity of 4 shows that A is contained in an open elementary
set G such that u(G) < (A) +e. Since u*(A) < n(G) and since é was
arbitrary, we have

(20) H*(A) < u(A).

The definition of u* shows that there is a sequence {A,} of open
elementary sets whose union contains A, such that

YMA) < H(A) +


--- Page 314 ---

THE LEBESGUE THEORY 305

The regularity of » shows that A contains a closed elementary set F such
that u(F) > (A) — «; and since F is compact, we have

FoA,yv “+ Ay

for some N. Hence
N
WA) < WF) + @ < p(A, U's U Ay) +E SY M(A,) + € S HAA) + 22.
1

In conjunction with (20), this proves (a).

Next, suppose E = UJE,, and assume that y*(E,) < + oo for ail x.
Given e>0, there are coverings {A,,},k =1,2,3,..., of E, by open
elementary sets such that

(21) Swan) < p*(E,) +27".
Then
WMEYS YY wd) < Yo whE)+ 6

and (19) follows. In the excluded case, i.e., if u*(E,) = +00 for some n,
(19) is of course trivial.

11.9 Definition For any A c R’, Bc R?, we define
(22) S(A, B) = (A — B)U (B- A),
(23) d(A, B) = p*(S(A, B)).
We write A, > A if
lim d(A, A,) = 0.

If there is a sequence {4,} of elementary sets such that A, A, we say

that A is finitely p-measurable and write A é Dt,(y).
If A is the union of a countable collection of finitely u-measurable sets,

we say that A is u-measurable and write A € Dt().
S(A, B) is the so-called “‘symmetric difference” of A and B. We shall see

that d(A, B) is essentially a distance function.
The following theorem will enable us to obtain the desired extension of y.

11.10 Theorem i(u) is a o-ring, and w* is countably additive on Mt(y).

Before we turn to the proof of this theorem, we develop some of the
properties of S(A, B) and d(A, B). We have


--- Page 315 ---

306 PRINCIPLES OF MATHEMATICAL ANALYSIS

(24) S(A, B) = S(B, A), S(A, A) = 0.
(25) S(A, B) c S(A, C) LU S(C, B).
S(A, U Ay, By U B)
(26) S(A, 0 Az, By 0 B2)} c S(Ay, By) U S(A2, Bo).

S(A; — Az, By — Ba)
(24) is clear, and (25) follows from
(A-—B)c(A-C)U(C-B), (B-A)c(C-A)U(B-C).
The first formula of (26) is obtained from
(A; U Az) — (B, VU B2) < (Ay — By) U (Az — By).
Next, writing E*° for the complement of E, we have
S(A, 7 Az, By 0 B,) = S(AS UL AS, BE U BS)
c S(At, Bi) U S(A5, BS) = S(A;, By) U S(A2, Ba);
and the last formula of (26) is obtained if we note that
A, — A, =A; AS.
By (23), (19), and (18), these properties of S(A, B) imply

(27) d(A, B)=d(B, A), — d(A, A) = 0,
(28) dA, B) < d(A, C) + d(C, B),
d(A, U Ay, B, U By)
(29) d(A, 7 Az, By 0 B2)} S d(Ay, By) + dA, By).

d(A, — A,, B, — Bz)

The relations (27) and (28) show that d(A, B) satisfies the requirements
of Definition 2.15, except that d(A, B) = 0 does not imply A = B. For instance,
if u = m, A is countable, and B is empty, we have

d(A, B) = m*(A) =0;
to see this, cover the nth point of A by an interval J, such that
m(1,) < 27 "6.
But if we define two sets A and B to be equivalent, provided
d(A, B) =0,

we divide the subsets of R? into equivalence classes, and d(A, B) makes the set
of these equivalence classes into a metric space. Mt,(y) is then obtained as the
closure of &. This interpretation is not essential for the proof, but it explains
the underlying idea.


--- Page 316 ---

(30)

THE LEBESGUE THEORY 307

We need one more property of d(A, B), namely,
| u*(A) — u*(B)| < d(A, B),

if at least one of p*(A), w*(B) is finite. For suppose 0 < p*(B) < p*(A),
Then (28) shows that

d(A,0)<d(A, B)+ d(B, 0),

that is,

u*(A) < d(A, B) + u*(B).

Since *(B) is finite, it follows that

(31)
(32)
(33)
(34)

(35)

(36)

u*(A) — u*(B) < dA, B).

Proof of Theorem 11.10 Suppose A €M,(u), Be Diu). Choose {A,},
{B,} such that A,e&. B,é&, A, >A, B, > B. Then (29) and (30) show
that

A,U B, 9 AUB,
A,B, 3 AO B,
A, — B, +A — B,
u*(A,) > u*(A),
and p*(A) < + 0 since d(A,, A) > 0. By (31) and (33), M,-(u) is a ring.
By (7),
HW(A,) + H(B,) = WA, V B,) + H(A, 0 By).
Letting n > 00, we obtain, by (34) and Theorem 11.8(a),
un(A) + w*(B) = wh(A vB) + uh 9 B),

If A m7 B=O, then p*(A mn B)=0.

It follows that y* is additive on M,(y).

Now let A € Mu). Then A can be represented as the union of a
countable collection of disjoint sets of Mt-(u). For if A =|) A; with
A, € Mp(u), write A, = Aj, and

A, =(AjusssUA)—-(Af Us UAL) (n= 2,3,4,...).
Then
A=(JA,
n=1
is the required representation. By (19)

u*(A) < ¥ wry.


--- Page 317 ---

308 PRINCIPLES OF MATHEMATICAL ANALYSIS

(37)

(38)

On the other hand, A> 4, U:::UA,; and by the additivity of
E* on My(u) we obtain

H*(A) = w(A, UU A) = WAY) +0 + BAD).
Equations (36) and (37) imply

u*(A) = 5 ut(A,)

Suppose y*(A) is finite. Put B, = A, U-:+U A,. Then (38) shows
that

(4, B) =n U A)= S wm(Ay) +0

i=at

as n—co. Hence B,- A; and since B, € M,(u), it is easily seen that

Ae M;(u).
We have thus shown that A € Mt,(y) if A © Miu) and p*(A) < + 00.
It is now clear that p* is countably additive on Mt(u). For if

A=\(JA,,

where {A,} is a sequence of disjoint sets of Vii), we have shown that (38)
holds if p*(A,) < + 00 for every n, and in the other case (38) is trivial.

Finally, we have to show that Mu) is a o-ring. If A, € My), 2 = 1,
2, 3,..., it is clear that U A, € Dt(u) (Theorem 2.12). Suppose A € i(y),
Be My), and

A=)4, B=\ B,,
where A,, B, € Dip(u). Then the identity
A, B= U (A, 0 B))
shows that A, A Be Wt(u); and since

u*(A, 2 B) < U*(A,) < + 0,

A, BEM(u). Hence A,—- BeM,(u), and A—BeEM(y) since
A- B= (J24 (4, 3B).

We now replace *(A) by p(A) if A € Di(u). Thus yp, originally only de-

fined on &, is extended to a countably additive set function on the o-ring
Mu). This extended set function is called a measure. The special case p =m
is called the Lebesgue measure on R?,


--- Page 318 ---

THE LEBESGUE THEORY 309

11.11 Remarks

(39)

(40)

(a) If A is open, then A € (wu). For every open set in R? is the union
of a countable collection of open intervals. To see this, it is sufficient to
construct a countable base whose members are open intervals.

By taking complements, it follows that every closed set is in M(y).
(6) If A eM) and ¢ > 0, there exist sets F and G such that

FcAcG,

F is closed, G is open, and
MG-A)<e pwA-F)<ae.

The first inequality holds since u* was defined by means of coverings
by open elementary sets. The second inequality then follows by taking
complements.

(c) We say that £ is a Borel set if E can be obtained by a countable
number of operations, starting from open sets, each operation consisting
in taking unions, intersections, or complements, The collection @ of all
Borel sets in R? is a o-ring; in fact, it is the smallest o-ring which contains
all open sets. By Remark (a), FE € M(y) if Le B.

(d) If A © Mp), there exist Borel sets F and G such that Fc AcG,

and
H(G — A) = (A — F) =0.

This follows from (8) if we take ¢ = 1/n and let n > 00.

Since A = FU (A — F), we see that every A € Mu) is the union of a
Borel set and a set of measure zero.

The Borel sets are y-measurable for every yu. But the sets of measure
zero [that is, the sets £ for which p*(E) = 0] may be different for different
ps.

(e) For every p, the sets of measure zero form a o-ring.

({) In case of the Lebesgue measure, every countable set has measure
zero. But there are uncountable (in fact, perfect) sets of measure zero.
The Cantor set may be taken as an example: Using the notation of Sec.
2.44, it is easily seen that

m(E,) = (4)" (n = 1, 2,3,...);

and since P = () E,, Pc E, for every n, so that m(P) = 0.


--- Page 319 ---

310 PRINCIPLES OF MATHEMATICAL ANALYSIS

MEASURE SPACES

11.12 Definition Suppose YX is a set, not necessarily a subset of a euclidean
space, or indeed of any metric space. X is said to be a measure space if there
exists a a-ring Di of subsets of X (which are called measurable sets) and a non-
negative countably additive set function y (which is called a measure), defined
on Mt.

If, in addition, X eM, then X is said to be a measurable space.

For instance, we can take X = R?, Mi the collection of all Lebesgue-
measurable subsets of R?, and p Lebesgue measure.

Or, let X be the set of all positive integers, Nt the collection of all subsets
of X, and y(£) the number of elements of £.

Another example is provided by probability theory, where events may be
considered as sets, and the probability of the occurrence of events is an additive
(or countably additive) set function.

In the following sections we shall always deal with measurable spaces.
It should be emphasized that the integration theory which we shall soon discuss
would not become simpler in any respect if we sacrificed the generality we have
now attained and restricted ourselves to Lebesgue measure, say, on an interval
of the real line. In fact, the essential] features of the theory are brought out
with much greater clarity in the more general situation, where it is seen that
everything depends only on the countable additivity of » on a o-ring,

It will be convenient to introduce the notation

(41) {x|P}

for the set of all elements x which have the property P.

MEASURABLE FUNCTIONS

11.13 Definition Let / be a function defined on the measurable space “X, with
values in the extended real number system. The function fis said to be measur-
able if the set

(42) {x| f(x) > a}
is measurable for every real a.

11.14 Example If Y= R? and Nt=M(u) as defined in Definition 11.9,
every continuous / is measurable, since then (42) is an open set.


--- Page 320 ---

THE LEBESGUE THEORY 311

11.15 Theorem Each of the following four conditions implies the other three:

(43) {x| f(x) > a} is measurable for every real a.
(44) {x| f(x) = a} is measurable for every real a.
(45) {x| f(x) < a} is measurable for every real a.
(46) {x| f(x) < a} is measurable for every real a.

Proof The relations

(x1ft) >a} = [xis >a- 1},

{x|f(x) < a} = X¥ — {x|f() = a},

{x| f(x) <a} = () {1/0 <a+ ‘;
n=1 n

{x|f(x) > a} = X — {x| f(x) <a}

show successively that (43) implies (44), (44) implies (45), (45) implies
(46), and (46) implies (43).

Hence any of these conditions may be used instead of (42) to define
measurability.
11.16 Theorem Jf /f is measurable, then |f| is measurable.
Proof
{x] |f@)| <a} = {x|f@) <a} 9 {x| f(x) > — ah.

11.17 Theorem Let {f,} be a sequence of measurable functions. For x € X, put
gx) =supf,(%) (”=1,2,3,...),
A(x) = lim sup f(x).

Then g and h are measurable.

The same is of course true of the inf and lim inf.
Proof

(xla(x) > a} = U) 1G) >,
A(x) = inf 9m(x),
where g,,(x) = sup f,(x) (n = m).


--- Page 321 ---

312 PRINCIPLES OF MATHEMATICAL ANALYSIS

Corollaries

(a) Iffand g are measurable, then max (f, g) and min (f, g) are measurable.
If
(47) f* =max(f,0), f" = —min(¥,0),

it follows, in particular, that f* and f~ are measurable.
(b) The limit of a convergent sequence of measurable functions is measurable.

11.18 Theorem Let f and g be measurable real-valued functions defined on X,
let F be real and continuous on R’, and put

A(x) = F(f(x), 9%) (x EX).

Then h is measurable.
In particular, f + g and fg are measurable.

Proof Let
G, = {(u, v)| F(u, v) > a}.

Then G, is an open subset of R?, and we can write

G= Uh,

al
where {J,} is a sequence of open intervals:
I, = {(u, v)|a, <u <b,,¢,<v <d,}.
Since
{x]a, < f(x) < by} = (x|S@) > a} 9 {x| F(X) < by}

is measurable, it follows that the set

{x| (f(x), 9(x)) € Ly} = (x) a, < F(X) <b} 0 {x} ¢, < g(x) < d,}
is measurable. Hence the same is true of

{x|(x) > a} = (1 (FG), 9@)) € G,}
= U &1/@), 909) €

Summing up, we may say that all ordinary operations of analysis, includ-
ing limit operations, when applied to measurable functions, lead to measurable
functions; in other words, all functions that are ordinarily met with are measur-
able.

That this is, however, only a rough statement is shown by the following
example (based on Lebesgue measure, on the real line): If A(x) = f(g(x)), where


--- Page 322 ---

THE LEBESGUE THEORY 313

J is measurable and g is continuous, then / is not necessarily measurable.
(For the details, we refer to McShane, page 241.)

The reader may have noticed that measure has not been mentioned in
our discussion of measurable functions. In fact, the class of measurable func-
tions on X depends only on the o-ring NM (using the notation of Definition 11.12).
For instance, we may speak of Borel-measurable functions on R?, that is, of
function f for which

{x|f(@) > a}

is always a Borel set, without reference to any particular measure.

SIMPLE FUNCTIONS

11.19 Definition Let s be a real-valued function defined on X. If the range
of s is finite, we say that s is a simple function.
Let E < X, and put

_fl (wee),
Kg is called the characteristic function of E.
Suppose the range of s consists of the distinct numbers ¢,,...,¢,. Let

E, = {x|s(x) = ¢;} G=1,...,”).
Then

(49) sS= 2 ciKe,:

that is, every simple function is a finite linear combination of characteristic
functions. It is clear that s is measurable if and only if the sets E,,..., E, are
measurable.

It is of interest that every function can be approximated by simple
functions:

11.20 Theorem Let f be a real function on X. There exists a sequence {s,} of
simple functions such that s,(x) +f (x) asn > 00, for every x € X. If fis measur-
able, {s,} may be chosen to be a sequence of measurable functions. If f = 0, {s,}
may be chosen to be a monotonically increasing sequence.

Proof If f> 0, define

Ex = (s > <f(x) < =) F, = {x| f(x) =n}



--- Page 323 ---

314 PRINCIPLES OF MATHEMATICAL ANALYSIS

form =1,2,3,...,i=1,2,...,"2". Put
ae t—1

(50) 5, = Ya Kz, + nK,y,,-
i=1 2

In the general case, let f= f* —f~, and apply the preceding construction
to f* and to f~.

It may be noted that the sequence {s,} given by (50) converges
uniformly to fif fis bounded.

INTEGRATION

We shall define integration on a measurable space X, in which M is the o-ring
of measurable sets, and yp is the measure. The reader who wishes to visualize
a more concrete situation may think of X as the real line, or an interval, and of
Has the Lebesgue measure m.

11.21 Definition Suppose

(51) 5(x) = y ce, Kg,(x) (x € X, ¢,; > 0)
tet

is measurable, and suppose E € Mt. We define

n
(52) Is) = » ce; HE 4 E)).
If f is measurable and nonnegative, we define
(53) { Su = sup 1(s),
E

where the sup is taken over all measurable simple functions s such thatO <s </f.
The left member of (53) is called the Lebesgue integral of f, with respect
to the measure p, over the set £. It should be noted that the integral may have
the value + 00.
It is easily verified that

(54) [ sau = Is)
E
for every nonnegative simple measurable function s.
11.22 Definition Let / be measurable, and consider the two integrals
55 * du, ~ dp,
(55) [fra fp ae
where f+ and f~ are defined as in (47).


--- Page 324 ---

THE LEBESGUE THEORY 315

If at least one of the integrals (55) is finite, we define
5 du= * du “du.

(56) [ fae=] ft du J fod

If both integrals in (55) are finite, then (56) is finite, and we say that f is
integrable (or summable) on E in the Lebesgue sense, with respect to 4; we write
fe L(u) on E. If yp =m, the usual notation is: fe # on E.

This terminology may be a little confusing: If (56) is +00 or ~—oo, then
the integral of f over E is defined, although f is not integrable in the above
sense of the word; fis integrable on E only if its integral over E is finite.

We shall be mainly interested in integrable functions, although in some
cases it is desirable to deal with the more general situation.

11.23 Remarks The following properties are evident:

(a) If f is measurable and bounded on E, and if HWE) < +00, then
fe LW on E.
(6) Ifa<f(x) <6 for x e E, and p(E) < +00, then
an(E) < f. fdu < bulE).
(c) Iffand g e Y() on E, and if f(x) < g(x) for x € E, then
[ fdusf gdp.
E E
(d) Iffe L(y) on E, then cf e L(y) on E, for every finite constant c, and
i) of du =e { JS du.
E E
(e) If w(E) =0, and fis measurable, then
f fdu =0.
E
(*) Iffe Zu) on E, AeM, and Ac E, then fe L(y) on A.

11.24 Theorem

(a) Suppose f is measurable and nonnegative on X. For A eM, define

(57) HA) =f fdu.


--- Page 325 ---

316 PRINCIPLES OF MATHEMATICAL ANALYSIS

(58)

(59)

(60)

Then @ is countably additive on Mt.
(b) The same conclusion holds if f ¢ L(p) on X.

Proof It is clear that (b) follows from (a) if we write f=/* —f~ and
apply (a) to f* and to f~.
To prove (a), we have to show that

$(A) = oy $(A,)
if A, €M(n = 1, 2, 3,...), 4; 4; =0 for i#/, and A=()P A,.

If f is a characteristic function, then the countable additivity of ¢ is
precisely the same as the countable additivity of p, since

I Ky du = WA a E).
If f is simple, then f is of the form (51), and the conclusion again

holds.
In the general case, we have, for every measurable simple function s

such thatO<s</f,

[sdu=¥ J sdus¥ oy.
A n=1°An n=1
Therefore, by (53),
#4) < ¥ $A)
Now if (A,) = +00 for some a, (58) is trivial, since 6(A) > $(A,).

Suppose $(A,) < +00 for every n.
Given ¢>0, we can choose a measurable function s such that

0<s<f, and such that
d du— 6, d du ~ 8.
fe wes woe fs wel s ad
Hence
HAV A)Z{ —— sdu={ sdu+[ sduz 9A) + $42) — 2,
At Vv A2 At A2

so that
@(A, VU A) = G(Ay) + P(A2).


--- Page 326 ---

THE LEBESGUE THEORY 317

It follows that we have, for every 7,

(61) $(A;, U +++ U Ay) > G(Ay) + *** + G(A,).
Since A > A, U''' U A,, (61) implies
(62) WA) = Y Hy),

and (58) follows from (59) and (62).
Corollary [fAeM, BeM, Bc A, and p(A — B) =0, then
f fdu=f fap.
A B

Since A = Bu (A — B), this follows from Remark 11.23(e).

11.25 Remarks The preceding corollary shows that sets of iaeasure zero are
negligible in integration.
Let us write f~ g on E if the set

{x| f(x) 4 g@)} OE

has measure zero.

Then f~ f; f~ g implies g~f; and f~ g, g~h implies f~ h. That is,
the relation ~ is an equivalence relation,

If f~ g on E, we clearly have

[f dp = J. g dh,

provided the integrals exist, for every measurable subset A of E.

If a property P holds for every x e E — A, and if u(A) = 0, it is customary
to say that P holds for almost all x € Z, or that P holds almost everywhere on
E. (This concept of “‘almost everywhere” depends of course on the particular
measure under consideration. In the literature, unless something is said to the
contrary, it usually refers to Lebesgue measure.)

If fe L(y) on E, it is clear that f(x) must be finite almost everywhere on E.
In most cases we therefore do not lose any generality if we assume the given
functions to be finite-valued from the outset.

11.26 Theorem [ff e€ L(y) on E, then |f| € L(u) on E, and

(63) | ff du sf Isl du


--- Page 327 ---

318 PRINCIPLES OF MATHEMATICAL ANALYSIS

Proof Write E =A B, where f(x)=0 on A and f(x) <0 on B.
By Theorem 11.24,

flldu=f ifldutf Uldum ft dus [ t- du< to,
E A B A B
so that |f| € Z(u). Since f< |f| and —/< |f], we see that
{fds ifid, -f fdusf \fl dy,
E E E E
and (63) follows.
Since the integrability of f implies that of |f|, the Lebesgue integral is
often called an absolutely convergent integral. It is of course possible to define
nonabsolutely convergent integrals, and in the treatment of some problems it is

essential to do so. But these integrals lack some of the most useful properties
of the Lebesgue integral and play a somewhat less important role in analysis.

11.27 Theorem Suppose f is measurable on E, |f| <g, and g € L(y) on E.
Then f € L(y) on E,

Proof We have f* <gandf~ <g.

11.28 Lebesgue’s monotone convergence theorem Suppose Ee M. Let {f,} be
a sequence of measurable functions such that

(64) O<fA@<Ah@)<'' (jee).
Let f be defined by
(65) flx) >f(%) Mek)

asn— oo. Then
(66) [ taur] fap (n > 00).
E E
Proof By (64) it is clear that, as n > 00,
(67) ) Sf, dp > 0
E
for some a; and since [f, < [f, we have

(68) asf fdu.


--- Page 328 ---

(69)

(70)

(71)

(72)

THE LEBESGUE THEORY 319

Choose ¢ such that 0 <c <1, and let s be a simple measurable
function such thatO <s</f. Put

E,=({x\f 2c} (n= 1,2,3,...).
By (64), £, cE, cE, <*::; and by (65),
n=1t
For every 2,
[ paz] frduze| s du.
E En En

We let n — co in (70). Since the integral is a countably additive set function
(Theorem 11.24), (69) shows that we may apply Theorem 11.3 to the last
integral in (70), and we obtain

a>Cc i S du.
Letting c > 1, we see that
“ae if sd,
and (53) implies
“> J, fdu.

The theorem follows from (67), (68), and (72).

11.29 Theorem Suppose f=f,+f,, where f,¢ L(u) on E (i =1,2). Then
fe L(y) on E, and

(73)

[fdu=f faut] fede

Proof First, suppose f, = 0, f, >0. If f, and /, are simple, (73) follows
trivially from (52) and (54). Otherwise, choose monotonically increasing
sequences {s/}, {st} of nonnegative measurable simple functions which
converge to f;,f/,. Theorem 11.20 shows that this is possible. Put
Sq = 5, + 5,. Then

fpoedu= fo sidu+ | se du,

and (73) follows if we let n + 00 and appeal to Theorem 11.28.


--- Page 329 ---

320 PRINCIPLES OF MATHEMATICAL ANALYSIS

Next, suppose /; > 0, /, <0. Put
A={x|f(x) 20}, B= {x| f(x) <0}.
Then f, f,, and —/, are nonnegative on A. Hence

(74) [ fiu=f faut f (fAddu= J fdu- J frau.

Similarly, —f, f,, and —f, are nonnegative on B, so that

[pam [fide t J (Dau,
or
(75) [fidu= | tdu—[ frau,

and (73) follows if we add (74) and (75).

In the general case, E can be decomposed into four sets EZ; on each
of which f, (x) and f,(x) are of constant sign. The two cases we have proved
so far imply

f fdu={ fdu+{ frdu (i=1,2,3,4),
Ei Ei Ei
and (73) follows by adding these four equations.

We are now in a position to reformulate Theorem 11.28 for series.

11.30 Theorem Suppose EE M. If{f,} is a sequence of nonnegative measurable
functions and

(76) f= Kh) eb),
then
[fdu=> | fod

Proof The partial sums of (76) form a monotonically increasing sequence.

11.31 Fatou’s theorem Suppose EeM. If (f,} is a sequence of nonnegative
measurable functions and

Sx) =liminff,~) (jee),
then
(77) I. fd <lim inf f. f, dp.


--- Page 330 ---

THE LEBESGUE THEORY 321

Strict inequality may hold in (77). An example is given in Exercise 5.
Proof Forn=1,2,3,... and xeE, put
9,(X) = inf f(x) (i> 7).

Then g, is measurable on £, and

(78) 0<9i(%) <9.(x) <""',
(79) IX) SS),
(80) I(x) f(x) (n+ 0).

By (78), (80), and Theorem 11.28,
(81) [9 uo [f Ll
so that (77) follows from (79) and (81).

11.32 Lebesgue’s dominated convergence theorem Suppose EeM. Let {f,} be
a sequence of measurable functions such that

(82) SAx) f(x) = € £)

asn— oo. If there exists a function g € L(t) on E, such that
(83) If(x)| Sox) = (w= 1, 2,3, ..., x EE),
then

(84) lim ffedu =f fd.

Because of (83), {f,} is said to be dominated by g, and we talk about
dominated convergence. By Remark 11.25, the conclusion is the same if (82)
holds almost everywhere on E.

Proof First, (83) and Theorem 11.27 imply that f, e Y(u) and fe (yu)
on E.
Since f, + g => 0, Fatou’s theorem shows that

[ U+9) du slim int { (f, +9) di
E aro E
or

(85) I. fdu < lim inf [. f, dp.
n>o


--- Page 331 ---

322 PRINCIPLES OF MATHEMATICAL ANALYSIS

Since g — f, = 0, we see similarly that

| @-/) du slim int | (g -f) du,
E n> E

so that

-f fdu <lim inf |-J fn du},
E n> 0 E

which is the same as

(86) i) fdu > lim sup } fdu.
E n> © E

The existence of the limit in (84) and the equality asserted by (84)
now follow from (85) and (86).

Corollary If u(E) < +00, {f,} is uniformly bounded on E, and f,(x) > f(x) on E,
then (84) holds.

A uniformly bounded convergent sequence is often said to be boundedly
convergent.

COMPARISON WITH THE RIEMANN INTEGRAL

Our next theorem will show that every function which is Riemann-integrable
on an interval is also Lebesgue-integrable, and that Riemann-integrable func-
tions are subject to rather stringent continuity conditions. Quite apart from the
fact that the Lebesgue theory therefore enables us to integrate a much larger
class of functions, its greatest advantage lies perhaps in the ease with which
many limit operations can be handled; from this point of view, Lebesgue’s
convergence theorems may well be regarded as the core of the Lebesgue theory.

One of the difficulties which is encountered in the Riemann theory is
that limits of Riemann-integrable functions (or even continuous functions)
may fail to be Riemann-integrable. This difficulty is now almost eliminated,
since limits of measurable functions are always measurable.

Let the measure space X be the interval [a, b) of the real line, with yp = m
(the Lebesgue measure), and Mt the family of Lebesgue-measurable subsets
of [a, 5]. Instead of

i} fdm
x
it is customary to use the familiar notation

[ fax


--- Page 332 ---

THE LEBESGUE THEORY 323

for the Lebesgue integral of f over [a,b]. To distinguish Riemann integrals
from Lebesgue integrals, we shall now denote the former by

al fax.

11.33 Theorem

(87)

(88)

(89)

(90)

(91)

(92)

(a) Iffe@ on [a, b), then fe L on [a, b), and
b b
[ fax=af fax.
(b) Suppose f is bounded on [a,b]. Then f € & on [a, b] if and only if f is
continuous almost everywhere on [a, 6].

Proof Suppose fis bounded. By Definition 6.1 and Theorem 6.4 there
is a sequence {P,} of partitions of [a, 5], such that P,,, is a refinement
of P,, such that the distance between adjacent points of P, is less than
1/k, and such that

lim L(P,,f) = i) fdx, lim U(P,,f) = #| fax.
k 0 = ko
(In this proof, all integrals are taken over [a, b].)
If P, = {X95 X1,.-., Xp}, With x9 = a, x, = 5, define
U,(a) = L,(a) =f(@);
put U,(x) = M;, and L,(x) =m, for x,-.;<x<x,,1<i<n, using the
notation introduced in Definition 6.1. Then
LP, f) = [Lxdx, UPS) = [Ue dx,
and
L,(x) $ L,(x) s+: Sfx) S°°: S$ UL(x) Ss U()
for all x € [a, 5], since P,,, refines P,. By (90), there exist
L(x) = lim L,@), U(x) = lim U,(x).
ko k7>@

Observe that L and U are bounded measurable functions on [a, b],
that

L(x) sf) <Ux) (@asx<b),


--- Page 333 ---

324 PRINCIPLES OF MATHEMATICAL ANALYSIS

(93)

(94)

(95)

and that

[Lax =a [fax, [udx=af fax,

by (88), (90), and the monotone convergence theorem.

So far, nothing has been assumed about f except that fis a bounded
real function on [a, 5].

To complete the proof, note that fe & if and only if its upper and
lower Riemann integrals are equal, hence if and only if

[idx = [Uds;

since L < U, (94) happens if and only if L(x) = U(x) for almost all
x € [a, b] (Exercise 1).
In that case, (92) implies that

L(x) = f(x) = Ux)

almost everywhere on [a, b], so that f is measurable, and (87) follows
from (93) and (95).

Furthermore, if x belongs to no P,, it is quite easy to see that U(x) =
L(x) if and only iff is continuous at x. Since the union of the sets P, is count-
able, its measure is 0, and we conclude that f is continuous almost every-
where on [a,b] if and only if L(x) = U(x) almost everywhere, hence
(as we saw above) if and only if fe 2.

This completes the proof.

The familiar connection between integration and differentiation is to a

large degree carried over into the Lebesgue theory. If fe ¥ on [a, bj, and

(96)

F(x) = [ fdt (a<x<b),

then F’(x) = f(x) almost everywhere on [a, b].

Conversely, if F is differentiable at every point of [a, b] (‘almost every-

where” is not good enough here!) and if F’ e ¥ on [a, b], then

F(x) — F(a) = f Fit) (a<x<b).

For the proofs of these two theorems, we refer the reader to any of the

works on integration cited in the Bibliography.


--- Page 334 ---

THE LEBESGUE THEORY 325

INTEGRATION OF COMPLEX FUNCTIONS
Suppose f is a complex-valued function defined on a measure space X, and

f=u-+tiv, where wu and v are real. We say that fis measurable if and only if

both w and v are measurable.
It is easy to verify that sums and products of complex measurable functions

are again measurable. Since
\f| = (u? + v?yt/2,

Theorem 11.18 shows that |f| is measurable for every complex measurable f.

Suppose p is a measure on X, E is a measurable subset of X, and fis a
complex function on XY. We say that fe L(y) on E provided that fis measurable
and

(97) ful du < +0,
E
and we define
du = duti d
[f (3 fm if if fe

if (97) holds. Since |u| < |f|, |v| < |f], and |f| < |u| + |o|, it is clear that
(97) holds if and only if ue #(u) and ve L(y) on £.

Theorems 11.23(a), (d), (e), (7), 11.24(6), 11.26, 11.27, 11.29, and 11.32
can now be extended to Lebesgue integrals of complex functions. The proofs
are quite straightforward. That of Theorem 11.26 is the only one that offers

anything of interest:
If f e F(u) on E, there is a complex number c, |c| = 1, such that

cf fdu>0.
E
Put g = cf =u+ iv, uandv real. Then
dul =c du= du=| udu< du.
[fd [fa [9 u i i [il lu

The third of the above equalities holds since the preceding ones show that
fg du is real.

FUNCTIONS OF CLASS #?

As an application of the Lebesgue theory, we shall now extend the Parseval
theorem (which we proved only for Riemann-integrable functions in Chap. 8)
and prove the Riesz-Fischer theorem for orthonormal sets of functions.


--- Page 335 ---

326 PRINCIPLES OF MATHEMATICAL ANALYSIS

11.34 Definition Let X be a measurable space. We say that a complex
function f € £?(u) on X if f is measurable and if

[ WFP du < +o.
x

If «4 is Lebesgue measure, we say fe #*. For fe L*(u) (we shall omit the
phrase “on X” from now on) we define

1/2
isi={f Ai? |
and call ||f|| the £?(u) norm of f.

11.35 Theorem Suppose fe £?(u) and ge (un). Then fg € L(.), and

(98) [Wal us If Il.

This is the Schwarz inequality, which we have already encountered for
series and for Riemann integrals. It follows from the inequality

of (Fl + Algl? du = il? +2af Lal du + lg,
which holds for every real A.

11.36 Theorem If fe ¥*(u) andg € L*(u), thenf+g¢€ L*(u), and

If+ gl < fl + lg!
Proof The Schwarz inequality shows that

If+ all? =f Isl? + [fat [fo+ fol?
Sf I? + 21/1 lgll + gl?
= (IF 1+ lal?

11.37 Remark If we define the distance between two functions f and g in
£7(u) to be || f — gil, we see that the conditions of Definition 2.15 are satisfied,
except for the fact that || f—g|| =0 does not imply that f(x) = g() for all x,
but only for almost all x. Thus, if we identify functions which differ only on a
set of measure zero, #7(1) is a metric space.

We now consider #? on an interval of the real line, with respect to
Lebesgue measure.

11.38 Theorem The continuous functions form a dense subset of ¥? on [a, b}.


--- Page 336 ---

THE LEBESGUE THEORY 327

More explicitly, this means that for any fe £? on [a, bj, and any ¢ > 0,
there is a function g, continuous on [a, 5], such that

val ={fif-al? ax} <e.

Proof We shall say that fis approximated in Y? by a sequence {g,} if
If — Gall +0 as n > a0.

Let A be a closed subset of [a, b], and K, its characteristic function.
Put

(x) =inf|x—y| (ve A)
and

1 ,
= ——_— = 1,2, 3,...)*

Gn) = 7 Tne (n = 1, 2, 3,...)

Then g, is continuous on [a, b], g,(x)=1 on A, and g,(x) 0 on B,

where B = [a, b] — A. Hence

lon Kal=[f gi de} +0

by Theorem 11.32. Thus characteristic functions of closed sets can be
approximated in Y? by continuous functions.

By (39) the same is true for the characteristic function of any
measurable set, and hence also for simple measurable functions.

If f>0 and fe &”, let {s,} be a monotonically increasing sequence
of simple nonnegative measurable functions such that s,(x) >/(x).
Since |f—s,|? <f?, Theorem 11.32 shows that ||f— s,|| 0.

The general case follows.

11.39 Definition We say that a sequence of complex functions {@,} is an
orthonormal set of functions on a measurable space X if

J, ¢nBude= {tom

In particular, we must have ¢, € £?(u). If fe L(y) and if

c= | fb,du (n=1,2,3,...)
xX

we write

fr

1M

CPn °
1

as in Definition 8.10.


--- Page 337 ---

328 PRINCIPLES OF MATHEMATICAL ANALYSIS

The definition of a trigonometric Fourier series is extended in the same
way to ¥? (or even to ¥) on [—2, 7]. Theorems 8.11 and 8.12 (the Bessel
inequality) hold for any fe Y*(u). The proofs are the same, word for word.

We can now prove the Parseval theorem.

11.40 Theorem Suppose

(99) f(s) ~ eye,
where fe £? on [—n, x]. Let s, be the nth partial sum of (99). Then
(100) lim || f— s,|| = 0,
C3) ] 7%
2230 2
(101) Llel@=sef [fl ax.

Proof Let ¢>0 be given. By Theorem 11.38, there is a continuous
function g such that

g

— <-.

If-gl <5
Moreover, it is easy to see that we can arrange it so that g(x) = g(—7z).
Then g can be extended to a periodic continuous function. By Theorem
8.16, there is a trigonometric polynomial 7, of degree N, say, such that

é€
—T| <-.
lg — TI 5

Hence, by Theorem 8.11 (extended to #7), n => N implies
and (100) follows. Equation (101) is deduced from (100) as in the proof of

Theorem 8.16.
Corollary If fe L? on [—n, x], and if
i} Soe ™ dx=0 (n=0, +1, +2,...),
then ||f|| = 0.

Thus if two functions in Y* have the same Fourier series, they differ at
most on a set of measure zero.


--- Page 338 ---

THE LEBESGUE THEORY 329

11.41 Definition Let f and f,¢ £7(u) (n =1, 2,3,...). We say that {f}
converges to fin ¥7(y) if ||f, —/|| +0. We say that {f,} is a Cauchy sequence
in (uy) if for every ¢ > 0 there is an integer N such that n > N, m > N implies

fn —Smll <8.

11.42 Theorem If {f,} is a Cauchy sequence in Y*(p), then there exists a
function f € Y?(u) such that { f,} converges to f in £?(u).

This says, in other words, that #?(u) is a complete metric space.

Proof Since {f,} is a Cauchy sequence, we can find a sequence {n,},
k =1, 2,3,..., such that

1
Choose a function g € ¥7(u). By the Schwarz inequality,
\Igi
X
Hence

(102) Y [19 tee —Sncedl MS Ig.
k=1°X

By Theorem 11.30, we may interchange the summation and integration in
(102). It follows that

(103) laC2)1 Vn) — Saco 2] < + 0
almost everywhere on X. Therefore
(104) S Vnces@) —ful0)| < + 00

almost everywhere on X. For if the series in (104) were divergent on a
set E of positive measure, we could take g(x) to be nonzero on a subset of
E of positive measure, thus obtaining a contradiction to (103).

Since the kth partial sum of the series

2, (Sines s(x) — Sink);
which converges almost everywhere on_X, is

Sn + s(x) —Sail),


--- Page 339 ---

330 PRINCIPLES OF MATHEMATICAL ANALYSIS

we see that the equation
f(x) = lim Sn®)
defines f(x) for almost all x € X, and it does not matter how we define
J (x) at the remaining points of YX.
We shall now show that this function f has the desired properties.

Let ¢>0O be given, and choose WN as indicated in Definition 11.41. If
n, > N, Fatou’s theorem shows that

If —Snll < lim inf || fa, —Snull S &.

Thus f—/f,, € £7(u), and since f = (f—/f,,) +fy,» we see that fe Y?(y).
Also, since ¢ is arbitrary,

lim If —Snyll = 9.
Finally, the inequality

(105) If —Sall Sf —Frell + fine — Fall

shows that {/,} converges to f in Y?(y); for if we take and n, large
enough, each of the two terms on the right of (105) can be made arbi-
trarily small.

11.43 The Riesz-Fischer theorem Let {¢,} be orthonormal on X. Suppose
Z\c,|? converges, and put s,=c,¢, +'** + Cy~,. Then there exists a function
fe L(u) such that {s,} converges to f in L*(u), and such that

[oo]
S~ dV enbn-
n=1
Proof Forn>m,
[5p — Sell? = lemas |? oe + |cn|?,

so that {s,} is a Cauchy sequence in #?(u). By Theorem 11.42, there is
a function f € ¥?(u) such that

lim ||f — s,|| = 0.

Now, for n > k,

[ fO.du-cx=f f.du— J sb du,


--- Page 340 ---

THE LEBESGUE THEORY 331

so that

< NF —Sull - ball + IF — Sal.

I SPx UW —
x
Letting 7 > 00, we see that
=f fide (k=1,2,3,..),
x

and the proof is complete.

11.44 Definition An orthonormal set {¢,} is said to be complete if, for
fe £?(p), the equations

[ f.du=0 (=1,2,3,..)
Xx

imply that |jf|| = 0.

In the Corollary to Theorem 11.40 we deduced the completeness of the
trigonometric system from the Parseval equation (101). Conversely, the Parseval
equation holds for every complete orthonormal set:

11.45 Theorem Let {¢,} be a complete orthonormal set. If f € £?(y) and if

(106) f~¥ ends:
then
(107) fist? du = heal?

Proof By the Bessel inequality, Z|c,|* converges. Putting
5, = C191 tet CnPrn >

the Riesz-Fischer theorem shows that there is a function g €e Y7(u) such
that

(108) g~ > abe.

and such that ||g —s,|| +0. Hence ||s,|| - [gl]. Since
Ilsall? = leg|? +++ + lenl?,
we have

(108) [ lgl? w= leql?.


--- Page 341 ---

332 PRINCIPLES OF MATHEMATICAL ANALYSIS

Now (106), (108), and the completeness of {¢,,} show that || f — gj] = 0,
so that (109) implies (107).

Combining Theorems 11.43 and 11.45, we arrive at the very interesting
conclusion that every complete orthonormal set induces a 1-1 correspondence
between the functions fe Y7(u) (identifying those which are equal almost
everywhere) on the one hand and the sequences {c,} for which Z| c,|? converges,
on the other. The representation

f~ ¥ cubes

together with the Parseval equation, shows that Y(u) may be regarded as an
infinite-dimensional euclidean space (the so-called ‘Hilbert space”), in which
the point f has coordinates c,, and the functions ¢, are the coordinate vectors.

EXERCISES

1. If f>0 and fz fdu = 0, prove that f(x) = 0 almost everywhere on E. Hint: Let E,
be the subset of E on which f(x) > 1/n. Write A = UE,. Then «(A) = 0 if and only
if u(E,) = 0 for every n.

2. If {4 fdu =0 for every measurable subset A of a measurable set £, then f(x) =0
almost everywhere on E.

3. If {f,} is a sequence of measurable functions, prove that the set of points x at
which {/,(x)} converges is measurable.

4, If fe L(y) on E and g is bounded and measurable on E, then fg € Y(u) on E.

5. Put

__ {0 (0<x<}),
a= (k<x<1),
fa(x) = g(x) O<x<1),
farai(x) = g(1 — x) (O<x<1).
Show that
lim inf f,(x) = 0 (<x <)),
but

[, AO) ade=4.

[Compare with (77).]


--- Page 342 ---

6.

10.

11.

12.

13.

THE LEBESGUE THEORY 333

Let

1
0

(|x| >n).

Then f,(x) >0 uniformly on R', but
in fdx=2  (n=1,2,3,..).

(We write {%., in place of fri.) Thus uniform convergence does not imply domi-
nated convergence in the sense of Theorem 11.32. However, on sets of finite
measure, uniformly convergent sequences of bounded functions do satisfy Theo-
rem 11,32.

. Find a necessary and sufficient condition that f¢ A(«) on [a, 6]. Hint: Consider

Example 11.6(6) and Theorem 11.33.
If fe Z on [a, 6] and if F(x) = [3 f(t) dt, prove that F(x) = f(x) almost every-
where on [a, 5].

. Prove that the function F given by (96) is continuous on [a, 5].

If u(X) < +0 and fe F(z) on X, prove that fe L(y) on X. If
HX)= +o,
this is false. For instance, if
f@=——
1+ {x|’

then fe Z? on R', but f¢ F on R'.
If f,g € L(p) on X, define the distance between f and g by

[lf-al du.

Prove that Y() is a complete metric space.
Suppose

(a) |f(x,y| <1ifO<x<1,0<y<],

(b) for fixed x, f(x, y) is a continuous function of y,
(c) for fixed y, f(x, y) is a continuous function of x.
Put

1
ax)=|) fo, dy O<x<1),
Is g continuous ?
Consider the functions

fx) = sin nx (n= 1, 2,3,..., -wxx<n)


--- Page 343 ---

334 PRINCIPLES OF MATHEMATICAL ANALYSIS

14.

15.

16.

17.

18.

as points of Y?. Prove that the set of these points is closed and bounded, but
not compact.

Prove that a complex function f is measurable if and only if /-‘(V) is measurable
for every open set V in the plane.
Let & be the ring of all elementary subsets of (0, 1]. If0 <<a<b<1, define
(La, b]) = ¢([a, b)) = ¢(G, 5) = $((a, b)) = b — a,
but define
((0, b)) = 6((0, BIN =1+5

if 0 <b<1. Show that this gives an additive set function ¢ on &, which is not
regular and which cannot be extended to a countably additive set function on a
o-ring.
Suppose {7,} is an increasing sequence of positive integers and E is the set of all
x €(—7, 7) at which {sin 1.x} converges. Prove that m(Z)=0. Hint: For every
ACE,

[, sin nx dx +0,
and
2] (sin n,.x)? dx=[ — cos 2n,x) dx > m(A) ask—>o,

Suppose E < (—7, 7), m(E) >0,6>0. Use the Bessel inequality to prove that
there are at most finitely many integers n such that sin nx > 6 for all x € E.
Suppose fe ¥7(u),g € L7(u). Prove that

[fre au|? =f isl? ae f lol? du

if and only if there is a constant c such that g(x) = cf(x) almost everywhere.
(Compare Theorem 11.35.)


--- Page 344 ---

BIBLIOGRAPHY

ARTIN, E.: “The Gamma Function,” Holt, Rinehart and Winston, Inc., New York,
1964,

BOAS, R. P.: “A Primer of Real Functions,” Carus Mathematical Monograph No. 13,
John Wiley & Sons, Inc., New York, 1960.

BUCK, R. C. (ed.): “Studies in Modern Analysis,’ Prentice-Hall, Inc., Englewood
Cliffs, N.J., 1962.

: “Advanced Calculus,” 2d ed., McGraw-Hill Book Company, New York,
1965,

BURKILL, J. C.: “The Lebesgue Integral,” Cambridge University Press, New York, 1951.

DIEUDONNE, J.: “Foundations of Modern Analysis,” Academic Press, Inc., New York,
1960,

FLEMING, W. H.: “Functions of Several Variables,’ Addison-Wesley Publishing Com-
pany, Inc., Reading, Mass., 1965.

GRAVES, L. M.: “The Theory of Functions of Real Variables,” 2d ed., McGraw-Hill
Book Company, New York, 1956.

HALMOS, P. R.: “Measure Theory,” D. Van Nostrand Company, Inc., Princeton, N.J.,
1950.



--- Page 345 ---

336 PRINCIPLES OF MATHEMATICAL ANALYSIS

———-: “Finite-dimensional Vector Spaces,” 2d ed., D. Van Nostrand Company, Inc.,
Princeton, N.J., 1958.

HARDY, G. H.: “Pure Mathematics,” 9th ed., Cambridge University Press, New York,
1947,

and ROGOSINSKI, W.: “Fourier Series,” 2d ed., Cambridge University Press,
New York, 1950.

HERSTEIN, I. N.: ““Topics in Algebra,” Blaisdell Publishing Company, New York, 1964.

HEWITT, E., and STROMBERG, K.: “Real and Abstract Analysis,’’ Springer Publishing
Co., Inc., New York, 1965.

KELLOGG, 0. D.: “Foundations of Potential Theory,”’ Frederick Ungar Publishing Co.,
New York, 1940.

KNOPP, K.: “Theory and Application of Infinite Series,’ Blackie & Son, Ltd.,
Glasgow, 1928.

LANDAU, E.G. H.: “Foundations of Analysis,” Chelsea Publishing Company, New York,
1951.

MCSHANE, E. J.: “Integration,” Princeton University Press, Princeton, N.J., 1944.

NIVEN, I. M.: “Irrational Numbers,’ Carus Mathematical Monograph No. 11, John
Wiley & Sons, Inc., New York, 1956.

ROYDEN, H. L.: ‘Real Analysis,’ The Macmillan Company, New York, 1963.

RUDIN, W.: “Real and Complex Analysis,’ 2d ed., McGraw-Hill Book Company,
New York, 1974.

SIMMONS, G. F.: “Topology and Modern Analysis,’”» McGraw-Hill Book Company,
New York, 1963.

SINGER, I. M., and THORPE, J. A.: ““Lecture Notes on Elementary Topology and Geom-
etry,’ Scott, Foresman and Company, Glenview, IIl., 1967,

SMITH, K. T.: “Primer of Modern Analysis,” Bogden and Quigley, Tarrytown-on-
Hudson, N.Y., 1971.

SPIVAK, M.: “Calculus on Manifolds,’’ W. A. Benjamin, Inc., New York, 1965.

THURSTON, H. A.: “‘The Number System,” Blackie & Son, Ltd., London-Glasgow, 1956.



--- Page 346 ---

LIST OF SPECIAL SYMBOLS

The symbols listed below are followed by a brief statement of their meaning and by
the number of the page on which they are defined.

E€ belongs to ........ cece eee eens 3
¢ does not belong to............. 3
©¢,> inclusion signs ............ 3
Q rational field ................ 3
<, <, >, > inequality signs.... 3
sup least upper bound............ 4
inf greatest lower bound ......... 4
R real field ............ cece eee 8
+00, — 0, ooinfinities ........ 11, 27
Z complex conjugate ............. 14
Re (z) real part...............0ee 14
Im (z) imaginary part ............ 14
|z| absolute value............... 14
XS summation sign............ 15, 59
R* euclidean k-space............. 16
O null vector ......... cc cece eee 16
xy inner product .............. 16

|x| norm of vector xX .........045 16

{Xn} SEQUENCE... . cece cee e ee eee 26
UY, Go union... eee cece eee eee 27
(\, © intersection .............6. 27
(a,b) segment............ cece eee 31
[a,b] interval ......... ec ccc ee eae 31
E* complement of E ............. 32
E’ limit points of E.............. 35
E closure of BE ....... cece cece ees 35
lim limit....... 0.0... e cece eee 47
—> CONVEFZES TO... . cece eee eee 47, 98
lim sup upper limit .............. 56
lim inf lower limit............... 56
g°f composition ...........0e eee 86
S(x+) right-hand limit ........... 94
S(x—) left-hand limit ............ 94
St’, f(x) derivatives ........ 103 ,112
U(P,f), UPS, &), LP, f), LPF, &)
Riemann sums ........... 121, 122


--- Page 347 ---

338 PRINCIPLES OF MATHEMATICAL ANALYSIS

R, A«) classes of Riemann (Stieltjes)

integrable functions ....... 121, 122
€(X) space of continuous

functions ............ cece cena 150
|} |] norm .........0. 140, 150, 326
exp exponential function ........ 179
Dy Dirichlet kernel............. 189
I(x) gamma function ........... 192
{e,,...,@,} standard basis ....... 205
LX), L(X, Y) spaces of linear

transformations..............6. 207
[A] matrix... .. eee eee eee 210
D;f partial derivative ........... 215
Vf gradient............c.c eee 217
@’,@’ classes of differentiable

functions ...........00005 219, 235
det [A] determinant............. 232
J(x) Jacobian ........ cee cece ee 234

a1, veey Dn)

(Xi, 00.5 Xn) Jacobian .......... 234

Te kecell occ ccc cece eee 245
Q* k-simplex ..........0ceeeees 247
dx, basick-form ...........6665 257
A multiplication symbol ........ 254
d_ differentiation operator........ 260
wr transform ofw ............. 262
@ boundary operator............ 269
VXF curl oo... ccc eee ee 281
VF divergence ...........005. 281
6 ring of elementary sets ........ 303
m Lebesgue measure ....... 303, 308
fe Measure ........ cece eee 303, 308
Mir, Mt families of measurable sets 305
{x|P} set with property P........ 310
J*,f/7~ positive (negative) part

C0) 312
Kez _ characteristic function ....... 313

L, L(y), L?, £(u) classes of
Lebesgue-integrable
functions ............0065 315, 326


--- Page 348 ---

Abel, N.H., 75, 174
Absolute convergence, 71

of integral, 138
Absolute value, 14
Addition (see Sum)
Addition formula, 178
Additivity, 301
Affine chain, 268
Affine mapping, 266
Affine simplex. 266
Algebra, 161

self-adjoint, 165

uniformly closed, 161
Algebraic numbers, 43
Almost everywhere, 317
Alternating series, 71
Analytic function, 172
Anticommutative law, 256
Arc, 136
Area element, 283
Arithmetic means, 80, 199
Artin, E., 192, 195
Associative law, 5, 28, 259
Axioms, 5

Baire’s theorem, 46, 82

Ball, 31

Base, 45

Basic form, 257
Basis, 205
Bellman, R., 198

Bessel inequality, 188, 328
Beta function, 193

Binomial series, 201
Bohr-Mollerup theorem, 193

Borel-measurable function, 313

Borel set, 309

Boundary, 269

Bounded convergence, 322
Bounded function, 89
Bounded sequence, 48
Bounded set, 32
Brouwer’s theorem, 203
Buck, R.C., 195

Cantor, G., 21, 30, 186
Cantor set, 41, 81, 138, 168, 309
Cardinal number, 25
Cauchy criterion, 54, 59, 147
Cauchy sequence, 21, 52, 82, 329
Cauchy’s condensation test, 61
Cell, 31

"equivalence, 280
Chain, 268

affine, 268

differentiable, 270
Chain mule, 105, 214
Change of variables, 132, 252, 262
Characteristic function, 313
Circle of convergence, 69
Closed curve, 136
Closed form, 275
Closed set, 32
Closure, 35

uniform, 151, 161
Collection, 27
Column matrix, 217
Column vector, 210
Common refinement, 123
Commutative law, 5, 28
Compact metric space, 36
Compact set, 36

INDEX

Comparison test, 60
Complement, 32
Complete metric space, 54, 82,
151, 329
Complete orthonormal set, 331
Completion, 82
Complex field, 12, 184
Complex number, 12
Complex plane, 17
Component of a function, 87, 215
Composition, 86, 105, 127, 207
Condensation point, 45
Conjugate, 14
Connected set, 42
Constant function, 85
Continuity, 85
uniform, 90
Continuous functions, space of,
150
Continuous mapping. 85
Continuously differentiable curve,
136
Continuously differentiable map-
ping, 219
Contraction, 220
Convergence, 47
absolute, 71
bounded, 322
dominated, 321
of integral, 138
pointwise, 144
radius of, 69, 79
of sequences, 47
of series, 59
uniform, 147
Convex function, 101
Convex set, 31


--- Page 349 ---

340 INDEX

Coordinate function, 88
Coordinates, 16, 205
Countable additivity, 301
Countable base, 45
Countable set, 25
Cover, 36
Cunningham, F., 167
Curl, 281
Curve, 136
closed, 136
continuously differentiable, 136
rectifiable, 136
space-filling, 168
Cut, 17

Davis, P,J., 192
Decimals, 11
Dedekind, R., 21
Dense subset, 9, 32
Dependent set, 205
Derivative, 104
directional, 218
of a form, 260
of higher order, 110
of an integral, 133, 236, 324
integration of, 134, 324
partial, 215
of power series, 173
total, 213
of a transformation, 214
of a vector-valued function, 112
Determinant, 232
of an operator, 234
product of, 233
Diagonal process, 30, 157
Diameter, 52
Differentiable function, 104, 212
Differential, 213
Differential equation, 119, 170
Differential form (see Form)
Differentiation (see Derivative)
Dimension, 205
Directional derivative, 218
Dirichlet’s kernel, 189
Discontinuities, 94
Disjoint sets, 27
Distance, 30
Distributive law, 6, 20, 28
Divergence, 281
Divergence theorem, 253, 272,
288
Divergent sequence, 47
Divergent series, 59
Domain, 24
Dominated convergence theorem,
155, 167, 321
Double sequence, 144

e, 63

Eberlein, W. F., 184
Elementary set, 303
Empty set, 3
Equicontinuity, 156

Equivalence relation, 25
Euclidean space, 16, 30

Euler’s constant, 197

Exact form, 275

Existence theorem, 170
Exponential function, 178
Extended real number system, 11
Extension, 99

Family, 27
Fatou’s theorem, 320
Fejér’s kernel, 199
Fejér’s theorem, 199
Field axioms, 5
Fine, N.J., 100
Finite set, 25
Fixed point, 117
theorems, 117, 203, 220
Fleming, W. H., 280
Flip, 249
Form, 254
basic, 257
of class ¢',¢", 254
closed, 275
derivative of, 260
exact, 275
product of, 258, 260
sum of, 256
Fourier, J. B., 186
Fourier coefficients, 186, 187
Fourier series, 186, 187, 328
Function, 24
absolute value, 88
analytic, 172
Borel-measurable, 313
bounded, 89
characteristic, 313
component of, 87
constant, 85
continuous, 85
from left, 97
from right, 97
continuously differentiable, 219
convex, 101
decreasing, 95
differentiable, 104, 212
exponential, 178
harmonic, 297
increasing, 95
inverse, 90
Lebesgue-integrable, 315
limit, 144
linear, 206
logarithmic, 180
measurable, 310
monotonic, 95
nowhere differentiable continu-
ous, 154
one-to-one, 25
orthogonal, 187
periodic, 183
product of, 85
rational, 88
Riemann-integrable, 121

Function:
simple, 313
sum of, 85
summable, 315
trigonometric, 182
uniformly continuous, 90
uniformly differentiable, 115
vector-valued, 85
Fundamental theorem of calculus,
134, 324

Gamma function, 192

Geometric series, 61

Gradient, 217, 281

Graph, 99

Greatest lower bound, 4

Green's identities, 297

Green’s theorem, 253, 255, 272,
282

Half-open interval, 31
Harmonic function, 297
Havin, V.P., 113
Heine-Borel theorem, 39
Helly’s selection theorem, 167
Herstein, I.N., 65

Hewitt, E., 21

Higher-order derivative, 110
Hilbert space, 332

Hélder’s inequality, 139

i, 13
Identity operator, 232
Image, 24
Imaginary part, 14
Implicit function theorem, 224
Improper integral, 139
Increasing index, 257
Increasing sequence, 55
Independent set, 205
Index of a curve, 201
Infimum, 4
Infinite series, 59
Infinite set, 25
Infinity, 11
Initial-value problem, 119, 170
Inner product, 16
Integrable functions, spaces of,
315, 326
Integral:
countable additivity of, 316
differentiation of, 133, 236, 324
Lebesgue, 314
lower, 121, 122
Riemann, [21
Stieltjes, 122
upper, 121, 122
Integral test, 139
Integration:
of derivative, 134, 324
by parts, 134, 139, 141
Interior, 43


--- Page 350 ---

Interior point, 32

Intermediate value, 93, 100, 108
Intersection, 27

Interval, 31, 302

Into, 24

Inverse function, 90

Inverse function theorem, 221
Inverse image, 24

Inverse of linear operator, 207
Inverse mapping, 90

Invertible transformation, 207
Irrational number, 1, 10, 65
Isolated point, 32

Isometry, 82, 170
Isomorphism, 21

Jacobian, 234

Kellogg, O. D., 281
Kestelman, H., 167
Knopp, K., 21, 63

Landau, E.G.H., 21
Laplacian, 297
Least upper bound, 4
property, 4, 18
Lebesgue, H.L., 186
Lebesgue-integrable function, 315
Lebesgue integral, 314
Lebesgue measure, 308
Lebesgue’s theorem, 155, 167,
318, 321
Left-hand limit, 94
Leibnitz, G. W., 71
Length, 136
L’Hospital’s rule, 109, 113
Limit, 47, 83, 144
left-hand, 94
lower, 56
pointwise, 144
right-hand, 94
subsequential, 51
upper, 56
Limit function, 144
Limit point, 32
Line, 17
Line integral, 255
Linear combination, 204
Linear function, 206
Linear mapping, 206
Linear operator, 207
Linear transformation, 206
Local maximum, 107
Localization theorem, 190
Locally one-to-one mapping, 223
Logarithm, 22, 180
Logarithmic function, 180
Lower bound, 3
Lower integral, 121, 122
Lower limit, 56

McShane, E. J., 313

Mapping, 24
affine, 266
continuous, 85
continuously differentiable, 219
linear, 206
open, 100, 223
primitive, 248
uniformly continuous, 90
(See also Function)
Matrix, 210
product, 211
Maximum, 90
Mean square approximation, 187
Mean value theorem, 108, 235
Measurable function, 310
Measurable set, 305, 310
Measurable space, 310
Measure, 308
outer, 304
Measure space, 310
Measure zero, set of, 309, 317
Mertens, F., 74
Metric space, 30
Minimum, 90
Mobius band, 298
Monotone convergence theorem,
318
Monotonic function, 95, 302
Monotonic sequence, 55
Multiplication (see Product)

Negative number, 7
Negative orientation, 267
Neighborhood, 32
Newton’s method, 118
Nijenhuis, A., 223
Niven, L.. 65, 198
Nonnegative number, 60
Norm, 16, 140, 150, 326

of operator, 208
Normal derivative, 297
Normal space, 101
Normal vector, 284
Nowhere differentiable function,

154

Null space, 228
Null vector, 16
Number:

algebraic, 43

cardinal, 25

complex, 12

decimal, 11

finite, 12

irrational, 1, 10, 65

negative, 7

nonnegative, 60

positive, 7, 8

rational, |

real, 8

One-to-one correspondence. 25
Onto, 24
Open cover, 36

INDEX 341

Open mapping, 100, 223
Open set, 32
Order, 3, 17
lexicographic, 22
Ordered field, 7, 20
k-tuple, 16
pair, 12
set, 3, 18, 22
Oriented simplex, 266
Origin, 16
Orthogonal set of functions, 187
Orthonormal set, 187, 327, 331
Outer measure, 304

Parameter domain, 254
Parameter interval, 136
Parseval’s theorem, 191, 198, 328,
331

Partial derivative, 215
Partial sum, 59, 186
Partition, 120

of unity, 251
Perfect set, 32
Periodic function, 183, 190
mr, 183
Plane, 17
Poincaré’s lemma, 275, 280
Pointwise bounded sequence, 155
Pointwise convergence, 144
Polynomial, 88

trigonometric, 185
Positive orientation, 267
Power series, 69, 172
Primes, 197
Primitive mapping, 248
Product, 5

Cauchy, 73

of complex numbers, 12

of determinants, 233

of field elements, 5

of forms, 258, 260

of functions, 85

inner, 16

of matrices, 211

of real numbers, 19, 20

scalar, 16

of series, 73

of transformations, 207
Projection, 228
Proper subset, 3

Radius, 31, 32

of convergence, 69, 79
Range, 24, 207
Rank, 228
Rank theorem, 229
Ratio test, 66
Rational function, 88
Rational number, 1
Real field, 8
Real line, 17
Real number, 8
Real part, 14


--- Page 351 ---

342 INDEX

Rearrangement, 75
Rectifiable curve, 136
Refinement, 123

Reflexive property, 25
Regular set function, 303
Relatively open set, 35
Remainder, 211, 244
Restriction, 99

Riemann, B., 76, 186
Riemann integral, 121
Riemann-Stieltjes integral, 122
Riesz-Fischer theorem, 330
Right-hand limit, 94

Ring. 301

Robison, G. B., 184

Root, 10

Root test, 65

Row matrix, 217

Saddle point, 240
Scalar product, 16
Schoenberg, 1. J., 168
Schwarz inequality, 15, 139, 326
Segment, 31
Self-adjoint algebra, 165
Separable space, 45
Separated sets, 42
Separation of points, 162
Sequence, 26

bounded, 48

Cauchy, 52, 82, 329

convergent, 47

divergent, 47

double, 144

of functions, 143

increasing, 55

monotonic, 55

pointwise bounded, 155

pointwise convergent, 144

uniformly bounded, 155

uniformly convergent, 157
Series, 59

absolutely convergent, 71

alternating, 71

convergent, 59

divergent, 59

geometric, 61

nonabsolutely convergent, 72

power, 69, 172

product of, 73

trigonometric, 186

uniformly convergent, 157
Set, 3

at most countable, 25

Borel, 309

bounded, 32

bounded above, 3

Cantor, 41, 81, 138, 168, 309

closed, 32

compact, 36

complete orthonormal, 331

connected, 42

convex, 31

countable, 25

Set,
dense, 9, 32
elementary, 303
empty, 3
finite, 25
independent, 205
infinite, 25
measurable, 305, 310
nonempty, 3
open, 32
ordered, 3
perfect, 32, 41
relatively open, 35
uncountable, 25, 30, 41
Set function, 301
o-ring, 301
Simple discontinuity, 94
Simple function, 313
Simplex, 247
affine, 266
differentiable, 269
oriented, 266
Singer, I. M., 280
Solid angle, 294
Space:
compact metric, 36
complete metric, 54
connected, 42
of continuous functions, 150
euclidean, 16
Hilbert, 332
of integrable functions, 315, 326
measurable, 310
measure, 310
metric, 30
normal, 101
separable, 45
Span, 204
Sphere, 272, 277, 294
Spivak, M., 272, 280
Square root, 2, 81, 118
Standard basis, 205
Standard presentation, 257
Standard simplex, 266
Stark, E. L., 199
Step function, 129
Stieltjes integral, 122
Stirling’s formula, 194, 200
Stokes’ theorem, 253, 272, 287
Stone-Weierstrass theorem, 162,
190, 246
Stromberg, K., 21
Subadditivity, 304
Subcover, 36
Subfield, 8, 13
Subsequence, 51
Subsequential limit, 51
Subset, 3
dense, 9, 32
proper, 3
Sum, 5
of complex numbers, 12
of field elements, 5
of forms, 256
of functions, 85

Sum,
of linear transformations, 207
of oriented simplexes, 268
of real numbers, 18
of series, 59
of vectors, 16
Summation by parts, 70
Support, 246
Supremum, 4
Supremum norm, 150
Surface, 254
Symmetric difference, 305

Tangent plane, 284

Tangent vector, 286

Tangential component, 286

Taylor polynomial, 244

Taylor’s theorem, 110, 116, 176, 24.

Thorpe, J. A., 280

Thurston, H. A., 21

Torus, 239-240, 285

Total derivative, 213

Transformation (see Function;
Mapping)

Transitivity, 25

Triangle inequality, 14, 16, 30, 140

Trigonometric functions, 182

Trigonometric polynomial, 185

Trigonometric series, 186

Uncountable set, 25, 30, 41
Uniform boundedness, 155
Uniform closure, 151
Uniform continuity, 90
Uniform convergence, 147
Uniformly closed algebra, 161
Uniformly continuous mapping, 90
Union, 27

Uniqueness theorem, 119, 258
Unit cube, 247

Unit vector, 217

Upper bound, 3

Upper integral, 121, 122
Upper limit, 56

Value, 24

Variable of integration, 122

Vector, 16

Vector field, 281

Vector space, 16, 204

Vector-valued function, 85
derivative of, 112

Volume, 255, 282

Weierstrass test, 148
Weierstrass theorem, 40, 159
Winding number, 201

Zero set, 98, 117
Zeta function, 141
